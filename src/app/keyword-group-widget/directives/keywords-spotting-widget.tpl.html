<div class="panel panel-default raml-console-panel keywords-spotting">
  <div class="alert alert-danger" role="alert" ng-if="keywordsSpottingCtrl.errorMessage">
    <button type="button" class="close" ng-click="keywordsSpottingCtrl.errorMessage = ''"><span aria-hidden="true">&times;</span></button>
    {{ keywordsSpottingCtrl.errorMessage }}
  </div>
  <div ng-if="keywordsSpottingCtrl.isLogin">
    <div class="drop-box form-group"
         ngf-drop ngf-select ng-model="keywordsSpottingCtrl.files"
         ngf-drag-over-class="dragover" ngf-allow-dir="false"
         ngf-accept="keywordsSpottingCtrl.validateFormat($file)">

      <div class="drop-box-text">
        <div>
          <i class="drop-box-text__icon fa fa-2x fa-cloud-upload"></i>
          <div class="drop-box-text__label">Drop file here to upload, or browse</div>
        </div>
      </div>

      <div class="drop-box-text">
        <div class="media-preview-container" ng-if="keywordsSpottingCtrl.isAudio()">
          <audio controls class="media-preview"
                 ngf-src="keywordsSpottingCtrl.files[0]"
                 ngf-accept="'audio/*'">

          </audio>
        </div>
        <div class="media-preview-container" ng-if="keywordsSpottingCtrl.isVideo()">
          <video controls class="media-preview"
                 ngf-src="keywordsSpottingCtrl.files[0]"
                 ngf-accept="'video/*'">
          </video>
        </div>
      </div>

    </div>

    <div class="form-group" ng-if="!keywordsSpottingCtrl.createLoading">
      <button type="button" class="btn btn-link add-keyword"
              change-keyword-group
              modal-keyword-group-mode="create"
              change-group-callback="keywordsSpottingCtrl.createGroup">
        <i class="fa fa-plus-circle"></i>
        Add Keyword Spotting Group
      </button>
    </div>
    <div ng-if="keywordsSpottingCtrl.createLoading" class="create-group-loader">
      <css-spinner></css-spinner>
    </div>

    <div ng-if="!keywordsSpottingCtrl.isLoadedGroups" class="form-group">
      <ui-select multiple ng-model="keywordsSpottingCtrl.detectGroups">
        <ui-select-match placeholder="Select groups...">{{ $item.name }}</ui-select-match>
        <ui-select-choices repeat="group in keywordsSpottingCtrl.keywordGroups | filter:$select.search">
          {{ group.name }}
        </ui-select-choices>
      </ui-select>
    </div>
    <div ng-if="keywordsSpottingCtrl.isLoadedGroups" class="groups-loader">
      <css-spinner></css-spinner>
    </div>


    <div ng-if="!keywordsSpottingCtrl.isLoaded && !keywordsSpottingCtrl.pingProcess" class="form-group">
      <button type="button" class="btn btn-success" ng-click="keywordsSpottingCtrl.upload()">Upload</button>
    </div>

    <div ng-if="keywordsSpottingCtrl.isLoaded" class="media-upload-loader">
      <css-spinner></css-spinner>
    </div>

    <div ng-if="keywordsSpottingCtrl.pingProcess"  class="media-processing-loader">
      <css-spinner></css-spinner>
    </div>

    <div ng-if="keywordsSpottingCtrl.finishedUpload">
      <voicebase-media-player
        token="{{ keywordsSpottingCtrl.uploadedData.token }}"
        media-id="{{ keywordsSpottingCtrl.uploadedData.uploadedMedia.mediaId }}"
        media-url="{{ keywordsSpottingCtrl.uploadedData.mediaUrl }}"
        media-type="{{ keywordsSpottingCtrl.uploadedData.mediaType }}">
      </voicebase-media-player>
    </div>

    <div class="panel-group spotting-results row" ng-if="keywordsSpottingCtrl.uploadedData.uploadedMedia">
      <div class="container-fluid form-group">
        <div>Upload finished!</div>
        <div>Media id: {{keywordsSpottingCtrl.uploadedData.uploadedMedia.mediaId}}</div>
      </div>

      <div class="col-md-6" ng-repeat="group in keywordsSpottingCtrl.uploadedData.uploadedMediaGroups">
        <div class="panel panel-default">
          <div class="panel-heading spotting-results__group-title" role="tab">{{ group.name }}</div>
          <div class="panel-body"></div>
          <ul class="list-group" ng-if="group.keywords.length > 0">
            <li class="list-group-item" ng-repeat="keyword in group.keywords">
              {{ keyword.name }}
            </li>
          </ul>
          <ul class="list-group" ng-if="group.keywords.length === 0">
            <li class="list-group-item spotting-results_empty">
              There aren't spotting keywords in group.
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <div ng-if="!keywordsSpottingCtrl.isLogin" class="raml-console-error-message">Please sign in</div>
</div>
