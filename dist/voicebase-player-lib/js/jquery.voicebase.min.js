var voiceBase=function(e){"use strict";var s={instances:[],init:function(e){var t=s.instances.length;s.instances.push(new s.create_instance(t,e)),t++,this.current_instance=t-1},create_instance:function(e,t){this.instance_index=e,this.player=new s.Player(this,t)}};s.default_settings={apiUrl:"https://api.voicebase.com/services",apiKey:null,externalId:null,apiVersion:"1.1",mediaId:null,password:null,token:null,tokenTimeOut:10,example:!1,exampleTokenUrl:"http://demo.voicsebasejwplayer.dev4.sibers.com/extoken.php",helpUrl:"http://www.voicebase.com/developers/",stream:!1,mediaTypeOverride:null,vbsButtons:{share:!0,comment:!0,downloadMedia:!0,downloadTranscript:!0,remove:!0,favorite:!0,help:!0,evernote:!0,edit:!1,print:!0,orderTranscript:!0,prev:!0,next:!0,fullscreen:!0,readermode:!0,pwrdb:!0,unquotes:!0},webHooks:{},addThisButtons:["gmail","facebook","twitter","google_plusone_share","compact"],mediumResponsiveWithSpeakers:600,mediumResponsive:450,minResponsive:400,voicebaseShare:!1,shareTitle:"Checkout this!",showMore:!1,shareParams:{},shareUrl:!1,trackEvents:!1,mediaBlock:"vbs-media",mediaWidth:!1,controlsBlock:"vbs-controls",controlsWidth:!1,searchBarOuter:!0,searchBarBlock:"vbs-searchbar-block",searchBarBlockWidth:!1,tabView:!1,tabViewForMobile:!0,keywordsBlock:"vbs-keywords",keywordsHeight:170,keywordsWidth:!1,keywordsResizable:!1,keywordsGroups:!0,keywordsCounter:!0,showAutoGeneratedKeywords:!0,editKeywords:!1,transcriptBlock:"vbs-transcript",transcriptHeight:148,transcriptWidth:!1,transcriptResizable:!1,transcriptHighlight:10,transcriptCheckTimer:10,turnTimes:!0,lineBreak:!1,commentsBlock:"vbs-comments",humanOnly:!1,animation:!0,localApp:!1,localSearch:!1,localSearchHelperUrl:"js/workers/",colors:["#78c361","#9932cc","#ff69b4","#6495ed","#ffd700","#f6a7a1","#7fb397","#009999"],filterSpeaker:"all",playerType:"youtube",playerId:"ytplayer",keywordsColumns:!1,topicHover:!0,zeroclipboard:"ZeroClipboard.swf",commentsUsername:!1,commentsUserhandle:!1,contextMenu:!0,debug:!0,toggleBlocks:!0,toggleMediaBlock:!0,toggleKeywordsBlock:!0,toggleTranscriptBlock:!0,toggleCommentBlock:!0,hasMediaBlockHeader:!0,hasKeywordsBlockHeader:!0,hasTranscriptBlockHeader:!0,hasCommentsBlockHeader:!0,showControlsBlock:!0,showKeywordsBlock:!0,showTranscriptBlock:!0,showCommentsBlock:!0,expandMediaBlock:!0,expandKeywordsBlock:!0,expandTranscriptBlock:!0,expandCommentsBlock:!1,expandNewsBlock:!1,newsUrl:"https://stage.voicebase.com/bing/search?query=",newsBlock:"vbs-news",newsWidth:!1,showNewsBlock:!1,toggleNewsBlock:!0,hasNewsBlockHeader:!0,predictionsBlock:"vbs-predictions",predictionsWidth:!1,showPredictionsBlock:!1,togglePredictionsBlock:!0,expandPredictionsBlock:!0,hasPredictionsBlockHeader:!0,markersInNativeTimeline:!1,cssPathForPlayerFrame:"css/vbs-kaltura-iframe.css",modalErrors:!1,modalSave:!1,nativePlaylist:!0,restrictions:[],ready:function(){}},s.settings={},s.reSettings=function(r){s.settings=jQuery.extend(!0,{},s.default_settings),s.data=jQuery.extend(!0,{},s.default_data);var n=s.common.keysToLowerCase(r);if(t(n,"apiUrl"),t(n,"apiKey"),t(n,"externalId"),t(n,"apiVersion"),t(n,"mediaId"),t(n,"password"),t(n,"token"),t(n,"tokenTimeOut"),t(n,"example"),t(n,"exampleTokenUrl"),t(n,"stream"),t(n,"debug"),t(n,"toggleBlocks"),t(n,"showControlsBlock"),t(n,"showKeywordsBlock"),t(n,"showTranscriptBlock"),t(n,"showCommentsBlock"),t(n,"showNewsBlock"),t(n,"showPredictionsBlock"),t(n,"newsUrl"),t(n,"modalErrors"),t(n,"mediaTypeOverride"),s.settings.toggleBlocks?(t(n,"toggleMediaBlock"),t(n,"toggleKeywordsBlock"),t(n,"toggleTranscriptBlock"),t(n,"toggleCommentBlock"),t(n,"toggleNewsBlock"),t(n,"togglePredictionsBlock"),t(n,"expandMediaBlock"),t(n,"expandKeywordsBlock"),t(n,"expandTranscriptBlock"),t(n,"expandCommentsBlock"),t(n,"expandNewsBlock"),t(n,"expandPredictionsBlock")):(s.settings.toggleMediaBlock=!1,s.settings.toggleKeywordsBlock=!1,s.settings.toggleTranscriptBlock=!1,s.settings.toggleCommentBlock=!1,s.settings.toggleNewsBlock=!1,s.settings.togglePredictionsBlock=!1,s.settings.expandMediaBlock=!0,s.settings.expandKeywordsBlock=!0,s.settings.expandTranscriptBlock=!0,s.settings.expandCommentsBlock=!0,s.settings.expandNewsBlock=!0,s.settings.expandPredictionsBlock=!0),s.settings.toggleMediaBlock||(s.settings.expandMediaBlock=!0),s.settings.toggleKeywordsBlock||(s.settings.expandKeywordsBlock=!0),s.settings.toggleTranscriptBlock||(s.settings.expandTranscriptBlock=!0),s.settings.toggleCommentBlock||(s.settings.expandCommentsBlock=!0),s.settings.toggleNewsBlock||(s.settings.expandNewsBlock=!0),s.settings.togglePredictionsBlock||(s.settings.expandPredictionsBlock=!0),t(n,"hasMediaBlockHeader"),s.settings.hasMediaBlockHeader||(s.settings.toggleMediaBlock=!1),t(n,"hasKeywordsBlockHeader"),s.settings.hasKeywordsBlockHeader||(s.settings.toggleKeywordsBlock=!1),t(n,"hasTranscriptBlockHeader"),s.settings.hasTranscriptBlockHeader||(s.settings.toggleTranscriptBlock=!1),t(n,"hasCommentsBlockHeader"),s.settings.hasCommentsBlockHeader||(s.settings.toggleCommentBlock=!1),t(n,"hasNewsBlockHeader"),s.settings.hasNewsBlockHeader||(s.settings.toggleNewsBlock=!1),t(n,"hasPredictionsBlockHeader"),s.settings.hasPredictionsBlockHeader||(s.settings.togglePredictionsBlock=!1),"undefined"!=typeof n.actionflag)for(var i in n.actionflag)s.settings.vbsButtons[i]=n.actionflag[i];if(t(n,"webHooks"),t(n,"helpUrl"),s.settings.helpUrl||s.settings.webHooks.help||(s.settings.vbsButtons.help=!1),t(n,"mediumResponsiveWithSpeakers"),t(n,"mediumResponsive"),t(n,"minResponsive"),t(n,"showMore"),t(n,"animation"),t(n,"playerType"),t(n,"playerId"),t(n,"contextMenu"),t(n,"trackEvents"),t(n,"shareParams"),t(n,"shareUrl"),t(n,"shareTitle"),t(n,"addThisButtons"),t(n,"voicebaseShare"),t(n,"zeroclipboard"),t(n,"mediaBlock"),a(n,"mediaWidth"),t(n,"controlsBlock"),a(n,"controlsWidth"),t(n,"tabView"),t(n,"tabViewForMobile"),s.helper.isMobile()&&s.settings.tabViewForMobile&&(s.settings.tabView=!0),s.settings.tabView?(s.settings.searchBarOuter=!0,e("#"+n.keywordsblock).empty()):(t(n,"searchBarOuter"),t(n,"keywordsBlock"),t(n,"keywordsHeight"),a(n,"keywordsWidth")),s.settings.searchBarOuter&&(t(n,"searchBarBlock"),a(n,"searchBarBlockWidth")),t(n,"keywordsColumns"),t(n,"keywordsResizable"),t(n,"editKeywords"),t(n,"localApp"),t(n,"localSearch"),s.settings.localApp&&"undefined"!=typeof Fuse&&(s.settings.localSearch=!0,s.settings.showCommentsBlock=!1,s.settings.vbsButtons.edit=!1,s.settings.vbsButtons.downloadMedia=!1,s.settings.vbsButtons.downloadTranscript=!1,s.settings.vbsButtons.favorite=!1,s.settings.vbsButtons.remove=!1,s.settings.vbsButtons.share=!1,s.settings.vbsButtons.orderTranscript=!1),"undefined"==typeof Fuse&&(s.settings.localSearch=!1),t(n,"localSearchHelperUrl"),s.settings.localSearch&&"undefined"==typeof localSearchHelper&&jQuery.ajax({url:s.settings.localSearchHelperUrl+"localSearchHelper.js",dataType:"script",async:!0}),t(n,"topicHover"),t(n,"keywordsGroups"),t(n,"showAutoGeneratedKeywords"),t(n,"keywordsCounter"),s.settings.tabView?e("#"+n.transcriptblock).empty():(t(n,"transcriptBlock"),t(n,"transcriptHeight"),a(n,"transcriptWidth")),t(n,"transcriptResizable"),t(n,"transcriptHighlight"),t(n,"turnTimes"),t(n,"lineBreak"),t(n,"humanOnly"),s.settings.tabView?e("#"+n.commentsblock).empty():(t(n,"commentsBlock"),a(n,"commentsWidth")),t(n,"commentsUsername"),t(n,"commentsUserhandle"),"jwplayer"==s.settings.playerType){var o=jwplayer(s.settings.playerId).config.playlist;s.settings.hasPlaylist=!(!(o&&o.length>1)||s.settings.mediaId)}s.settings.tabView?e("#"+n.newsblock).empty():(t(n,"newsBlock"),a(n,"newsWidth")),s.settings.tabView?e("#"+n.predictionsblock).empty():(t(n,"predictionsBlock"),a(n,"predictionsWidth")),t(n,"markersInNativeTimeline"),s.settings.markersInNativeTimeline&&(s.settings.showControlsBlock=!1),t(n,"cssPathForPlayerFrame"),t(n,"modalSave"),t(n,"nativePlaylist"),t(n,"restrictions"),s.settings.restrictions.length>0&&(s.settings.vbsButtons.edit=s.settings.restrictions.indexOf("updateTranscript")>-1,s.settings.editKeywords=s.settings.restrictions.indexOf("manageKeywords")>-1,s.settings.vbsButtons.remove=s.settings.restrictions.indexOf("deleteFile")>-1,s.settings.vbsButtons.share=s.settings.restrictions.indexOf("manageShares")>-1),t(n,"ready")};var t=function(e,t){var a=t.toLowerCase();s.settings[t]="undefined"!=typeof e[a]?e[a]:s.settings[t]},a=function(e,t){var a=t.toLowerCase();s.helper.isMobile(),s.settings[t]="undefined"!=typeof e[a]?e[a]<220?220:e[a]:s.settings[t]};return s.default_data={months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],customMarkers:{},speakers:{},allSpeakers:[],vbsSpeakers:{},keywords:{},duration:null,vclass:null,sclass:null,position:0,commentsThreads:null,startParams:[],played:0,playerDom:null,playerHeight:null,movelistner:!1,dragging:!1,draggingVol:!1,kf:!1,tf:!1,lspeaker:null,clicker:!1,waiterSave:!1,metadataWaiter:!1,isSaving:!1,searcht:null,searchHits:null,localData:{},isMobile:!1,keywordClickEvent:null,playlist_meta:null,highlightSnippets:null},s.data={},e.fn.voicebase=function(t){return s.methods[t]?s.methods[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.vbplugin"),void 0):s.methods.init.apply(this,arguments)},s}(jQuery);voiceBase=function(e,s){"use strict";return e.api={inited:!1,init:function(){this.inited=!0,this.parameters=jQuery.extend(!0,{},this.default_parameters),e.settings.mediaId?(this.parameters.mediaid=e.settings.mediaId,delete this.parameters.externalid):(this.parameters.externalid=e.settings.externalId,delete this.parameters.mediaid),e.settings.token||e.settings.example?(this.parameters.token=e.settings.token,delete this.parameters.apikey,delete this.parameters.password):(delete this.parameters.token,this.parameters.apikey=e.settings.apiKey,this.parameters.password=e.settings.password),e.api.response={metadata:null,keywords:null,transcript:null,comments:null},e.api.data={keywords:{},comments:{},tmp:{}},e.api.ready={metadata:!1,keywords:!1,transcript:!1,comments:!1},e.api.errors={processing:0,failure:0},this.showProcessingMsg=!1,this.endSearch=!1},default_parameters:{version:e.default_settings.apiVersion,ModPagespeed:"off"},parameters:{},getToken:function(s){if(e.helper.isApi2_0())e.api2_0.getToken();else{var t={};jQuery.extend(t,this.parameters),t.action="getToken",t.timeout=s,delete t.mediaid,delete t.externalid,e.settings.restrictions&&e.settings.restrictions.length>0&&(t.privs=e.settings.restrictions.join(",")),e.api.call(t,e.api.setToken)}},setToken:function(s){"SUCCESS"==s.requestStatus?(e.settings.token=s.token,e.api.parameters.token=s.token,delete e.api.parameters.apikey,delete e.api.parameters.password,e.view.initWithToken()):alert(s.statusMessage)},getExampleToken:function(){var s={};e.api.callCustom(e.settings.exampleTokenUrl,s,e.api.setExampleToken)},setExampleToken:function(s){s.success===!0?(e.settings.token=s.token,e.api.parameters.token=s.token,e.view.initWithToken()):alert(s.message)},getMetaData:function(){e.data.metadataWaiter=setInterval(function(){if(e.data.metadataWaiter&&e.PlayerApi.isPlayerReady())if(clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null,e.settings.hasPlaylist&&e.settings.stream){var s=e.PlayerApi.getPlaylist();if(e.data.playlist_meta){var t=e.PlayerApi.getCurrentPlaylistItem(),a=e.PlayerApi.getPlaylistItemId(t);e.api.setMetaData(e.data.playlist_meta.metadata[a.id])}else e.api.getMetaDataForPlaylist(s)}else if(e.helper.isApi2_0())e.api2_0.getMetaData();else{var r={};jQuery.extend(r,e.api.parameters),r.action="getFileMetaData",r.confidence="0.0",e.api.call(r,e.api.setMetaData)}},10)},setMetaData:function(t){var a=e.helper.find(".vbs-media-block");if("SUCCESS"!=t.requestStatus&&(t=e.api.createMetaData()),"SUCCESS"==t.requestStatus&&"PROCESSING"!=t.response.fileStatus){t.self_made&&(a.find(".vbs-download-audio-btn").addClass("vbs-disable-button"),a.find(".vbs-del-btn").addClass("vbs-disable-button"),a.find(".vbs-star-btn").addClass("vbs-disable-button")),e.api.response.metadata=t,t.response.lengthMs?(e.data.duration=t.response.lengthMs/1e3,e.view.renderTimeInMediaTitle()):s(".vbs-time").hide(),e.helper.find(".voicebase_record_times").show(),e.helper.find(".vplayer").show();var r=s("#"+e.settings.playerId);if("jwplayer"==e.settings.playerType)e.data.playerDom="flash"===e.PlayerApi.getRenderingMode()?r.parent():r,e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());else if("kaltura"==e.settings.playerType)e.data.playerDom=s("#"+e.settings.playerId),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());else if("sublime"==e.settings.playerType){e.data.playerDom=r.parent(),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId());var n=s("#"+e.settings.controlsBlock);n.find(".vbs-record-player").addClass("vbs-1-right-btns").find(".vbs-volume-toolbar").remove()}else if("jplayer"==e.settings.playerType){var i=e.instances[e.current_instance].player.interface;i&&(e.data.playerDom=i.getGui(),e.data.playerDom.addClass("vbs-player-wrapper vbs-"+e.helper.randId()))}else 0===s(".vbs-player-wrapper").length&&(e.data.playerDom=s("#"+e.settings.playerId),e.data.playerDom.before('<div class="vbs-player-wrapper vbs-'+e.helper.randId()+'"></div>'));if(e.helper.isMediaTypeEqualVideo()){a.addClass("vbs-video"),s(".vbs-video .vbs-section-title").attr("data-title","Hide Video"),e.helper.find(".vbs-record-player").addClass("vbs-video");var o=e.helper.findc(".vbs-player-wrapper"),l=s("#"+e.settings.playerId).width();s("#"+e.settings.mediaBlock).insertBefore(o).css("width",l),l<e.settings.mediumResponsive&&l>=e.settings.minResponsive?a.addClass("less-600px"):l<e.settings.minResponsive&&a.addClass("less-600px").addClass("less-460px"),e.settings.vbsButtons.fullscreen&&a.find(".vbs-section-btns ul").append('<li><a href="#" class="vbs-expand-btn" data-title="Expand Video"></a></li>'),e.settings.expandMediaBlock||e.helper.find(".vbs-media-block .vbs-section-title").click()}else e.PlayerApi.hidePlayer();t.response.humanOrderStatus&&t.response.humanOrderDueDate&&e.helper.setOrderedButton(t.response.humanOrderDueDate),e.helper.adjustMediaTime(),t.response.isFavorite?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-title","Remove to Favorites"):e.helper.find(".vbs-star-btn").attr("data-title","Add from Favorites"),e.helper.checkAutoStart()}else a.append(e.templates.get("disabler")),e.helper.find(".vbs-record-player").append(e.templates.get("disabler")),e.api.setErrors(t);e.api.ready.metadata=!0},getMetaDataForPlaylist:function(t){e.data.playlist_meta={},e.data.playlist_meta.promises=[],e.data.playlist_meta.metadata={};for(var a=0;a<t.length;a++){var r=t[a];e.api.setMetaDataPromise(r)}s.when.apply(this,e.data.playlist_meta.promises).then(function(){e.api.resolveMetaDataPromise(t)})},setMetaDataPromise:function(t){var a={};jQuery.extend(a,this.parameters),a.action="getFileMetaData",a.confidence="0.0",delete a.mediaid,delete a.externalid;var r;t.vbs_mediaid?a.mediaid=r=t.vbs_mediaid:t.vbs_externalid&&(a.externalid=r=t.vbs_externalid);var n=s.getJSON(e.settings.apiUrl,a).done(function(s){e.data.playlist_meta.metadata[r]=s}).fail(function(e){console.log(e)});e.data.playlist_meta.promises.push(n)},resolveMetaDataPromise:function(s){for(var t=[],a=0;a<s.length;a++){var r=s[a],n=e.PlayerApi.getPlaylistItemId(r),i=n.id;if(e.data.playlist_meta.metadata[i]){var o,l=e.data.playlist_meta.metadata[i].response;l?o=e.PlayerApi.getStreamUrl(l):(o=r.file,e.data.playlist_meta.metadata[i]=e.api.createMetaData());var d={file:o,title:r.title};n.isMediaid?d.vbs_mediaid=i:d.vbs_externalid=i,t.push(d),0===a&&e.api.setMetaData(e.data.playlist_meta.metadata[i])}}e.PlayerApi.loadFile(t)},setLocalMetaData:function(){e.data.localData.metadata=e.api.createMetaData(),e.api.setMetaData(e.data.localData.metadata)},createMetaData:function(){var s=1e3*e.PlayerApi.getDuration(),t=s>0?s:0;return{requestStatus:"SUCCESS",self_made:!0,response:{lengthMs:t,hasVideo:!0,isFavorite:!1}}},getKeywords:function(){var s={};jQuery.extend(s,this.parameters),s.action="getFileAnalytics",s.returnCategories="1",s.includeStartTimes=!0,e.settings.keywordsGroups&&(s.returnGroups=!0),e.api.call(s,e.api.setKeywords)},setKeywords:function(t){var a=e.helper.find(".vbs-keywords-block");if("SUCCESS"==t.requestStatus){e.api.response.keywords=t;var r=[],n=[],i=[],o=[];for(var l in t.categories)n.push(t.categories[l]);if(e.settings.keywordsGroups)for(l in t.groups)n.push(t.groups[l]);r=t.keywords;var d=jQuery.map(n,function(s){var t=e.speakers.parseSpeakersInCategory(s,o,i);return o=t.speakersName,i=t.speakersArray,{name:s.name,score:s.score,subcategories:s.subcategories,similarCategories:s.similarCategories,speakers:t.isps,type:s.type}});d.sort(function(e,s){return e.score-s.score}),d.reverse();var p={name:"ALL TOPICS",keywords:r,subcategories:{},similarCategories:{},speakers:i.join()};d.unshift(p);var c=[];for(var v in t.keywords)c.push(t.keywords[v].name);e.data.keywords=c,n.push(p);var b='<ul class="vbs-topics-list">',u="",m=0;for(var f in d)if("undefined"!=typeof d[f]){var h="";if("undefined"!=typeof d[f].subcategories&&d[f].subcategories.length)for(var g in d[f].subcategories)h+=d[f].subcategories[g].name+"<br/>";var y="group"==d[f].type?"group":"",w="ALL TOPICS"==d[f].name?"vbs-all-topics":y;u+=" "+e.templates.parse("categoriesLiTemplate",{title:d[f].name,subcategories:h,speakers:d[f].speakers,liclass:w}),m++}b+=u+"</ul>",n.sort(function(e,s){return s.keywords.length-e.keywords.length});var k=[],C=s();for(var _ in n){var S="group"==n[_].type?'class="group"':"",x="ALL TOPICS"==n[_].name?'class=""':S,T=s('<ul tid="'+n[_].name+'" '+x+"></ul>"),B=n[_].keywords;for(l in B){{var P="",I=[],M=[];B[l]}for(var A in B[l].t){if(""!==B[l].t&&B[l].t[A]){var D=B[l].t[A];for(var E in D)M.push(D[E])}var H=e.helper.replaceAndTrim(A),N=e.speakers.getSpeakerKeyByName(H);P+="data-spt-"+N+'="'+(""!==B[l].t&&B[l].t[A]?B[l].t[A].join():"")+'" ',I.push(N),"-1"==k.indexOf(H)&&k.push(H)}var j=B[l].t?'class="key"':"",U="undefined"==typeof B[l].internalName?B[l].name:B[l].internalName.join(),O=e.settings.keywordsCounter?" <span>("+M.length+")</span>":"",R="<li "+j+'>   <a href="#" t="'+M.join()+'" speakers="'+I+'" '+P+">"+B[l].name+"</a>"+O+"</li>",K=s(R);K.find("a").data("keywordInternalName",U),T.append(K)}C=C.add(T)}e.settings.keywordsColumns&&"auto"!=e.settings.keywordsColumns&&e.helper.find(".vbs-keywords-list-wrapper").addClass(e.helper.getColumnClassByNumber(e.settings.keywordsColumns)),a.find(".vbs-topics").html(b),a.find(".vbs-keywords-list-tab").html(C),e.settings.showAutoGeneratedKeywords?e.helper.selectTopic(a.find(".vbs-topics").find("li").first()):e.helper.hideAutoGeneratedKeywords(),e.settings.expandKeywordsBlock?a.slideDown("fast",function(){e.settings.keywordsColumns&&"auto"==e.settings.keywordsColumns?e.helper.keywordsAutoColumns():e.settings.keywordsColumns&&"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}):(a.show(),a.find(".vbs-section-title").attr("data-title","Show Keywords"),a.find(".vbs-section-body").hide(),a.find(".vbs-search-form").hide())}else a.append(e.templates.get("disabler")),e.settings.tabView||(a.show(),a.find(".vbs-search-form").hide(),a.find(".vbs-section-body").hide()),e.settings.searchBarOuter&&(s("#vbs-voice_search_txt").prop("disabled","disabled"),s("#vbs-searchbar-block").find(".vbs-search-form").addClass("vbs-form-disabled")),e.api.setErrors(t);e.api.ready.keywords=!0},getTranscript:function(){var s={};jQuery.extend(s,this.parameters),s.action="getKeywords",s.confidence="0.0",e.api.call(s,e.api.setTranscript)},setTranscript:function(t){e.api.response.transcript=t;var a=e.helper.find(".vbs-transcript-block");if(("FAILURE"==t.requestStatus||"MACHINECOMPLETE"!=t.fileStatus&&"HUMANCOMPLETE"!=t.fileStatus)&&(e.api.ready.transcript=!0,e.api.setErrors(t),"FAILURE"===t.requestStatus&&(!t.transcript||t.transcript&&0===t.transcript.length)))return a.addClass("vbs-ho").append(e.templates.get("disabler")).show(),!1;if("human"==t.transcriptType?a.addClass("vbs-human").find(".vbs-section-title").attr("data-title","Hide Transcript"):e.settings.vbsButtons.orderTranscript&&a.addClass("vbs-with-order-btn"),e.settings.humanOnly&&"machine"==t.transcriptType)return!1;for(var r=[],n="",i=0,o=t.transcript,l=0,d=0,p=!1,c=o.length,v=0;c>v;v++){var b=o[v];0===v&&(n+='<span t="0">');for(var u=2;10>=u;u++)Math.floor(b.s/1e3)>=l+e.settings.transcriptHighlight*u&&(l+=e.settings.transcriptHighlight*u,n+='<span t="'+l+'"></span>');Math.floor(b.s/1e3)>=l+e.settings.transcriptHighlight&&(l+=e.settings.transcriptHighlight,n+='</span><span t="'+l+'">'),i+=b.s;var m=e.helper.isTurn(b.m),f=e.speakers.createSpeakerAttr(b);d=m?d+1:d;var h=m&&v>2?"<br/><br/>":"",g=e.settings.lineBreak&&"undefined"!=typeof o[v-1]&&o[v].s-o[v-1].e>1e3*e.settings.lineBreak?"<br/><br/>":"",y="";0===v&&"undefined"==typeof b.m&&(y="data-f=true",p=!0);var w=e.helper.replaceN(b.w);n+=b.w.match(/\w+/g)?h+g+'<span class="w vbs-trans-word" t="'+b.s+'" '+f+" "+y+"> "+w+"</span>":'<span class="vbs-punc vbs-trans-word" t="'+b.s+'" '+f+">"+w+"</span>"}n+="</span>",a.find(".vbs-transcript-wrapper").html(n),d&&p&&a.find(".vbs-transcript-wrapper span[data-f=true]").before('<span class="w" t="0" m=">> "><br><br>&gt;&gt; </span>'),a.not(".vbs-human").length&&!e.settings.expandTranscriptBlock&&(a.find(".vbs-section-body").hide(),a.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show Transcript")),a.find(".vbs-transcript-prewrapper").css("height",e.settings.transcriptHeight+"px"),a.slideDown("fast");var k=e.settings.apiUrl.replace("services","orderTranscript"),C=e.settings.mediaId?e.settings.mediaId:e.settings.externalId,_=k+"/"+C+"?token="+e.settings.token+"&cancel=close";if(e.helper.find(".vbs-order-human-trans a").attr("href",_),s.map(t.transcript,function(e){r.push(e.w)}),e.api.ready.transcript=!0,e.settings.transcriptResizable&&s.isFunction(s.fn.resizable)){var S=s("#"+e.settings.transcriptBlock),x=S.find(".vbs-section-body"),T=S.width(),B=S.offset(),P=B&&B.left?s(document).width()-Math.round(B.left)-10:S.width();e.helper.find(".vbs-resizable").resizable({minWidth:T,maxWidth:P,resize:function(){var t=s(this).width();x.width(t),x.siblings(".vbs-section-header").width(t),e.helper.checkScrollForResize(x)}}),e.helper.checkScrollForResize(x)}"REPROCESSING"!=t.fileStatus||e.settings.modalSave||(e.helper.setIsSaving(!0),e.api.triggerTranscriptStatus())},setPredictions:function(s){var t=e.helper.find(".vbs-predictions-block "),a='<table class="vbs-predictions-table">';a+="<thead>   <tr>       <th>Model Id</th>       <th>Type</th>       <th>Class</th>   </tr></thead><tbody>";for(var r=0;r<s.predictions.length;r++){var n=s.predictions[r];a+="<tr>   <td>"+n.model+"</td>   <td>"+n.type+"</td>   <td>"+n.class+"</td></tr>"}a+="</tbody></table>",t.find(".vbs-predictions-wrapper").html(a),t.show(),e.settings.expandPredictionsBlock||(t.find(".vbs-section-title").attr("data-title","Show Predictions").addClass("vbs-hidden"),t.find(".vbs-section-body").hide())},searchInfo:function(){var s=this;s.showProcessingMsg=!1,s.endSearch=!1,setTimeout(function(){s.showProcessingMsg=!0,s.endSearch||e.helper.showMessage("Processing your search...","info")},500),setTimeout(function(){if(!s.endSearch&&s.showProcessingMsg){e.helper.clearMessage();var t=e.templates.get("endSearchMessage");e.helper.appendMessage(t)}},2e3)},getSearch:function(s,t){var a=this,r=e.api.validateSearch(s);if(!r)return e.helper.showMessage("Search phrase is invalid. Its length can be up to 254 characters.","error"),e.helper.hideLoader(),!1;if(e.data.clicker=!0,e.data.keywordClickEvent||e.helper.collapseNewsBlock(),t=!("undefined"!=typeof t&&t===!1),e.settings.localSearch)e.api.getLocalSearch(s,t);else{var n=s.join(" ").toLowerCase(),i={};jQuery.extend(i,this.parameters),i.action="searchFile",i.terms=n,e.api.searchInfo(),e.api.call(i,function(s,t){a.endSearch=!0,s.numberOfHits>1e3&&e.helper.showMessage("Displaying your search results...","info"),e.api.setSearch(s,t)},{start:t,terms:s})}},validateSearch:function(e){var s=e.join(" ");return s.length<255},getLocalSearch:function(t,a){var r,n=this;window.Worker&&"undefined"!=typeof localSearchHelper?(e.api.searchInfo(),e.data.searchWorker=new Worker(e.settings.localSearchHelperUrl+"localSearchWorker.js"),e.data.searchWorker.onerror=function(s){e.helper.showMessage("Search error!","error"),console.log(["ERROR: Line ",s.lineno," in ",s.filename,": ",s.message].join(""))},e.data.searchWorker.onmessage=function(i){clearInterval(e.events.time),e.events.time=null,n.endSearch=!0,r=i.data.results;var o=0;r.hits.hits.forEach(function(e){o+=e.hits.length}),o>1e3&&e.helper.showMessage("Displaying your search results...","info");var l=setInterval(function(){l&&s(".vbs-markers").find(".vbs-marker").length===o&&(clearInterval(l),l=null,e.helper.clearMessage(),e.helper.setOnTimeInterval())},100);setTimeout(function(){e.api.setSearch(r,{start:a,terms:t})},10)},e.data.searchWorker.postMessage({transcript:e.api.response.transcript.transcript,terms:t})):(r=localSearchHelper.localTranscriptSearch(e.api.response.transcript.transcript,t),e.api.setSearch(r,{start:a,terms:t}))},setSearch:function(t,a){console.time("setSearch");var r=a.start,n=a.terms;e.data.clicker=!1;var i=e.helper.find(".vbs-record-timeline-wrap");e.data.markersStyles={markersWrapper:i,markersContainer:i.find(".vbs-markers"),markersWrapperWidth:i.width()};var o={};if(e.helper.find(".vbs-widget .vbs-word").each(function(e,t){var a=s(t),r=a.find(".vbs-search_word").text().replace(/"/g,"").trim().toLowerCase();o[r]=a.find(".vbs-marker").css("border-bottom-color")}),"SUCCESS"==t.requestStatus){var l=[];if(t.hits.length){var d=0,p="";t.hits.hits.map(function(s){var t=[],a=[];s.hits.map(function(r){if(e.speakers.filterResultForSpeaker(r.time)){t=t.concat(r.time);var n=r.phrase?r.phrase:e.helper.getPhraseByTime(r.time,r.end,s.term);a=a.concat(n)}}),p+=e.view.markerWidget(t,a,o[s.term]),l=l.concat(t),d++}),setTimeout(function(){p.length&&e.helper.find(".vbs-next-action-btn").removeClass("vbs-next-notactive"),e.data.markersStyles.markersContainer.append(p)},0),e.settings.editKeywords&&t.hits.hits.length>0?(e.data.searcht=l,e.data.searchHits=t.hits.hits,e.helper.checkKeyword(n,l,t.hits.hits)):(e.data.searcht=null,e.data.searchHits=null)}l.sort(function(e,s){return e-s}),r&&e.PlayerApi.seek(l[0])}else"FAILURE"==t.requestStatus&&e.helper.hideLoader();e.helper.clearMessage(),console.timeEnd("setSearch")},downloadAudio:function(){var s={};jQuery.extend(s,this.parameters),s.action="getFileMetadata",e.api.call(s,e.api.setDownloadAudio)},setDownloadAudio:function(s){"SUCCESS"==s.requestStatus?window.location=s.response.downloadMediaUrl:e.helper.showMessage(s.statusMessage,"error")},favorite:function(s){var t={};jQuery.extend(t,this.parameters),s="undefined"!=typeof s?s:!0,t.action="updateMediaFile",t.favorite=s?"add":"remove",e.view.favorite(s),e.api.call(t,e.api.sendFavorite)},sendFavorite:function(s){"SUCCESS"!=s.requestStatus&&(e.view.favoriteToggle(),e.helper.showMessage(s.statusMessage,"error"))},getAutoNotesHtmlURL:function(){var s={};return jQuery.extend(s,this.parameters),s.action="getAutoNotesHtml",s.content=!0,e.settings.apiUrl+"?"+e.common.getStringFromObject(s)},editKeyword:function(t,a,r,n){r=r.trim();var i={};jQuery.extend(i,this.parameters),i.keywordname=a,i.action="moveKeyword",i.categoryname="ALL TOPICS"!=r?r:"",i.mode=t;var o=s(n).parent();e.api.call(i,e.api.responseEditKeywords,{mode:t,li:o})},responseEditKeywords:function(s,t){"SUCCESS"==s.requestStatus?("up"==t.mode?t.li.insertBefore(t.li.prev()):"down"==t.mode?t.li.insertAfter(t.li.next()):"first"==t.mode&&t.li.insertBefore(t.li.siblings(":eq(0)")),"delete"==t.mode&&t.li.remove()):e.helper.showMessage(s.statusMessage,"error")},removeKeyword:function(t,a,r){if(t){a=a.trim();var n={};jQuery.extend(n,this.parameters),n.action="deleteKeyword",n.keywordname=t,n.categoryname="ALL TOPICS"!=a?a:"";var i=s(r).parent();e.api.call(n,e.api.responseRemoveKeyword,{category_name:a,keyword_name:t,li:i})}},responseRemoveKeyword:function(s,t){"SUCCESS"==s.requestStatus?("ALL TOPICS"==t.category_name&&e.data.keywords.splice(e.data.keywords.indexOf(t.keyword_name)),t.li.remove()):e.helper.showMessage(s.statusMessage,"error")},removeTopic:function(s){var t={};jQuery.extend(t,this.parameters),t.categoryname=s,t.action="deleteKeywordCategory",e.api.call(t,e.api.responseRemoveTopic)},responseRemoveTopic:function(t){if("SUCCESS"==t.requestStatus){var a=e.helper.find(".vbs-topics-list");a.find("li.vbs-active").remove();var r=a.find("li.vbs-all-topics");r.parent().find(".vbs-active").removeClass("vbs-active"),r.addClass("vbs-active");var n=r.find("a").text().trim(),i=e.helper.find(".vbs-keywords-list-tab");i.find("ul").removeClass("vbs-active"),i.find('ul[tid="'+n+'"]').addClass("vbs-active"),s(".vbs-topic-delete-popup").remove(),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}else e.helper.showMessage(t.statusMessage,"error")},addKeywords:function(s,t){var a={};jQuery.extend(a,this.parameters),a.keyword=s,a.action="addKeyword",e.api.call(a,e.api.responseAddKeywords,{keywords:s,times:t})},responseAddKeywords:function(t,a){if("SUCCESS"==t.requestStatus){var r=e.helper.find(".vbs-topics-list li.vbs-all-topics");r.parent().find(".vbs-active").removeClass("vbs-active"),r.addClass("vbs-active");var n=r.find("a").text().trim(),i=e.helper.find(".vbs-keywords-list-tab");i.find("ul").removeClass("vbs-active"),i.find('ul[tid="'+n+'"]').addClass("vbs-active");var o=a.keywords.replace(/"/g,"");e.data.keywords.push(o);var l=e.settings.keywordsCounter?" <span>("+a.times.split(",").length+")</span>":"",d=s('<li class="key"><a href="#" t="'+a.times+'" speakers="">'+o+"</a>"+l+"</li>");d.find("a").data("keywordInternalName",o),i.find("ul.vbs-active").prepend(d),e.helper.find(".vbs-add-search-word").each(function(){s(this).data("data-kwa").replace(/"/g,"")===o&&s(this).remove()}),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns()}else e.helper.showMessage(t.statusMessage,"error")},saveTrancript:function(s){var t={};jQuery.extend(t,this.parameters),t.content=s,t.action="updateTranscript",e.helper.setIsSaving(!0),e.api.callPost(t,e.api.responseSaveTrancript,s)},responseSaveTrancript:function(s){"SUCCESS"==s.requestStatus?setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer):e.helper.saveTranscriptError(s.statusMessage)},triggerTranscriptStatus:function(){var s={};jQuery.extend(s,this.parameters),s.action="getFileStatus",e.api.call(s,e.api.responseTriggerTranscriptStatus)},responseTriggerTranscriptStatus:function(s){"SUCCESS"!=s.requestStatus||"PROCESSING"!=s.fileStatus&&"REPROCESSING"!=s.fileStatus?"SUCCESS"==s.requestStatus&&"ERROR"==s.fileStatus?e.helper.saveTranscriptError(s.response):"SUCCESS"==s.requestStatus?e.helper.saveTranscriptComplete():"FAILURE"==s.requestStatus?e.helper.saveTranscriptError(s.statusMessage):e.helper.showMessage(s.statusMessage,"error"):setTimeout(function(){e.api.triggerTranscriptStatus()},1e3*e.settings.transcriptCheckTimer)},getNews:function(){var t=e.helper.getSearchWordsArray();if(0===t.length)return e.api.addEmptyMessageForNews("empty"),!1;if(s("#"+e.settings.newsBlock).find(".vbs-section-title").hasClass("vbs-hidden"))return!1;if(e.settings.showNewsBlock){var a=e.helper.find(".vbs-news-block"),r=t;if(s.isArray(r)&&(r=r.join(" ")),e.data.prevNewsRequest===r)return!1;e.data.prevNewsRequest=r,a.find(".vbs-news-wrapper").html('<div class="vbs-loader"></div>');var n=encodeURI(e.settings.newsUrl+r);return s.ajax({type:"GET",url:n,success:function(s){s=JSON.parse(s),e.api.setNews(s,t)},error:function(e,s,t){console.log(t+": Error "+e.status)}}),!0}},setNews:function(t,a){var r=t&&t.d?t.d.results:[];if(r.length>0){s.isArray(a)&&(a=a.join(", "));var n=e.helper.find(".vbs-news-block");n.find(".vbs-news-words").html(a);for(var i="",o=0;o<r.length;o++){var l=r[o],d=l.Title||"",p=l.Source||"",c=l.Date,v=l.Url;
i+=e.templates.parse("vbs-news-elem",{title:d,source:p,time:c,url:v})}n.find(".vbs-news-wrapper").html(i),n.find(".vbs-news-elem:odd").addClass("vbs-news-elem-odd").after('<div class="clear-block"></div>'),e.settings.hasNewsBlockHeader||n.addClass("vbs-no-header")}else e.api.addEmptyMessageForNews("not_found");console.log("news:\n",t)},addEmptyMessageForNews:function(s){var t="";"not_found"===s?t="News are not founded":"empty"===s&&(t="Please select a keyword");var a=e.templates.parse("vbs-empty-news",{message:t});e.helper.find(".vbs-news-block").find(".vbs-news-wrapper").html(a)},call:function(s,t,a){a="undefined"!=typeof a?a:!1,this.inited||this.init();var r=9===e.helper.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"GET",data:s,dataType:r?"jsonp":"json"}).done(function(e){t(e,a)}).fail(function(e){console.log(e)})},callPost:function(s,t,a){a="undefined"!=typeof a?a:!1;var r=9===e.helper.isIe();jQuery.ajax({url:e.settings.apiUrl,type:"POST",data:s,dataType:r?"jsonp":"json"}).done(function(e){t(e,a)}).fail(function(e){console.log(e)})},callCustom:function(s,t,a,r){r="undefined"!=typeof r?r:!1;var n=9===e.helper.isIe();jQuery.ajax({url:s,type:"POST",data:t,dataType:n?"jsonp":"json"}).done(function(e){a(e,r)}).fail(function(e){console.log(e)})},setErrors:function(s){"FAILURE"==s.requestStatus?e.api.errors.failure++:s.response&&"PROCESSING"==s.response.fileStatus?e.api.errors.processing++:"PROCESSING"==s.fileStatus&&e.api.errors.processing++}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.api2_0={getToken:function(){var t=e.settings.apiKey,a=e.settings.password,r=e.settings.apiUrl+"access/users/+"+t.toLowerCase()+"/tokens";s.ajax({type:"GET",url:r,headers:{Authorization:"Basic "+btoa(t+":"+a)},success:function(s){s.tokens&&s.tokens.length>0&&e.api.setToken({token:s.tokens[0].token,requestStatus:"SUCCESS"})},error:function(e,s,t){console.log(t+": Error "+e.status)}})},getMetaData:function(){var t=e.settings.apiUrl+"media/"+e.settings.mediaId;s.ajax({type:"GET",url:t,beforeSend:function(s){s.setRequestHeader("Authorization","Bearer "+e.settings.token)},success:function(s){var t=s.media,a={requestStatus:"PLUGIN"};if(t&&t.metadata&&t.metadata.length&&(a={requestStatus:"SUCCESS",response:{lengthMs:t.metadata.length.milliseconds}}),e.api.setMetaData(a),t){if(t.keywords&&t.keywords.latest){var r=t.keywords.latest,n={requestStatus:"SUCCESS",keywords:r.words||[],categories:r.categories||{},groups:r.groups||[]};e.api.setKeywords(n)}if(t.transcripts&&t.transcripts.latest){var i=t.transcripts.latest,o={requestStatus:"SUCCESS",transcriptType:i.type,transcript:i.words};e.api.setTranscript(o)}if(t.predictions&&t.predictions.latest&&t.predictions.latest.predictions){var l=t.predictions.latest.predictions,d={requestStatus:"SUCCESS",predictions:l};e.api.setPredictions(d)}e.api.ready.comments=!0}},error:function(e,s,t){console.log(t+": Error "+e.status)}})}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.comments={getComments:function(s,t){var a={};jQuery.extend(a,e.api.parameters),e.api.data.tmp.hide="undefined"!=typeof s?s:e.settings.expandCommentsBlock?!1:!0,e.api.data.tmp.rebuild="undefined"!=typeof t?t:!1,a.action="getComments",e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(a.username=e.settings.commentsUsername),e.api.call(a,e.comments.setComments)},setComments:function(t){if("SUCCESS"==t.requestStatus){var a="",r="";if(void 0!==t.response.threads){var n=0,i=0;e.data.commentsThreads=t.response.threads;for(var o in t.response.threads){var l=t.response.threads[o];for(var d in l.comments){var p=l.comments[d],c=p.level;p.level>"5"&&(c="5");var v=e.helper.parseTime(l.timeStamp);a+='<div class="vbs-comment-row vbs-answer'+c+'">\n                                                              <div class="vbs-comment-title">\n                                                                  <span class="vbs-comment-author">'+p.userName+"</span> ",a+=1==c?'<span>commented at</span>\n                                                                  <a href="javascript:void(0)" class="vbs-comment-time" data-vbct="'+l.timeStamp+'">'+v+"</a>":"<span>replied</span>";var b=p.canEdit?"vbs-with-edition-btns":"";a+='</div>\n                                                              <div class="vbs-comment-content '+b+'">\n                                                                  <div class="vbs-arrow"></div>\n                                                                  <div class="vbs-comment-message">\n                                                                      <p>'+p.content+"</p>\n                                                                  </div>";var u=!0;e.settings.restrictions.length>0&&(u=e.settings.restrictions.indexOf("manageComments")>-1||e.settings.restrictions.indexOf("manageOwnComments")>-1),u&&(a+=p.canEdit?'<div class="vbs-comment-edit-wrapper">\n                                                <div class="vbs-comment-edit-btn-wrapper">\n                                                    <a href="#" c_id="'+p.id+'" c_tm="'+l.timeStamp+'" class="vbs-comment-edit vbs-popup-btn">Edit</a>\n                                                </div>\n                                                <div class="vbs-comment-delete-btn-wrapper">\n                                                    <a href="#" c_id="'+p.id+'" class="vbs-comment-delete vbs-popup-btn">Delete</a>\n                                                </div>\n                                            </div>':'<div class="vbs-comment-reply-wrapper">\n                                                <a href="#"  c_id="'+p.id+'" class="vbs-comment-reply vbs-popup-btn">Reply</a>\n                                            </div>'),a+="</div>\n                                                          </div>\n                                                      </div>",i++,n++}}r+=n+" Comment(s)"}else r+="No Comments",a+='<div class="vbs-comment-row"><div class="vbs-comment-title">No Comments</div></div>';s(".vbs-comments-block .vbs-section-name").attr("style","width: 200px;").text(r),e.comments.commentsWidget(a,e.api.data.tmp.hide),e.api.data.tmp.rebuild&&e.comments.commentsTWidget()}else{var m=e.helper.find(".vbs-comments-block");m.append(e.templates.get("disabler")),e.settings.tabView||(m.show(),m.find(".vbs-section-body").hide(),m.find(".vbs-section-title .vbs-section-name").text("Comments")),e.api.setErrors(t)}e.api.ready.comments=!0},addComment:function(s){var t={};jQuery.extend(t,e.api.parameters),t.action="addComment",t.comment=s.comment,s.comment_timestamp!==!1&&(t.timeStamp=s.comment_timestamp),s.parent_comment_id!==!1&&(t.commentId=s.parent_comment_id),e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(t.username=e.settings.commentsUsername),e.settings.commentsUserhandle&&""!==e.settings.commentsUserhandle&&(t.userhandle=e.settings.commentsUserhandle),e.api.call(t,e.comments.sendComment)},sendComment:function(s){"SUCCESS"==s.requestStatus?e.comments.getComments(e.helper.find(".vbs-comments-block .vbs-section-title").hasClass("vbs-hidden"),!0):e.helper.showMessage(s.statusMessage,"error")},editComment:function(s){var t={};jQuery.extend(t,e.api.parameters),t.action="editComment",t.comment=s.comment,t.commentId=s.comment_id,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(t.username=e.settings.commentsUsername),e.api.call(t,e.comments.sendEditComment)},sendEditComment:function(s){var t=e.api.data.tmp.commentParent,a=e.api.data.tmp.commentData;if("SUCCESS"==s.requestStatus){t.parents(".vbs-comment-content").find(".vbs-comment-message p").text(a.comment),t.remove();var r=a.comment_id,n=e.data.commentsThreads;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i].comments;o.forEach(function(e){e.id==r&&(e.content=a.comment)})}e.comments.commentsTWidget()}else t.find("textarea").attr("disabled",!1),e.helper.showMessage(s.statusMessage,"error")},deleteComment:function(s){var t={};jQuery.extend(t,e.api.parameters),t.action="deleteComment",t.commentId=s,e.settings.commentsUsername&&""!==e.settings.commentsUsername&&(t.username=e.settings.commentsUsername),e.api.call(t,e.comments.sendComment)},commentsWidget:function(s,t){var a=e.helper.find(".vbs-comments-block");a.find(".vbs-section-body").html(s),t&&(a.find(".vbs-section-body").hide(),a.find(".vbs-section-title").addClass("vbs-hidden")),a.slideDown("fast")},commentsTWidget:function(){var s=e.helper.find(".vbs-record-timeline-wrap"),t="";for(var a in e.data.commentsThreads){var r=e.data.commentsThreads[a].timeStamp,n=r*s.width()/e.data.duration,i=r>e.data.duration/2?"vbs-from-right":"",o=e.data.commentsThreads[a].comments[0].content;t+=e.templates.parse("vbsCommentsTimeline",{position:n,rightClass:i,stime:r,commentText:o})}e.helper.find(".vbs-comments-wrapper-block").html(t),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame&&e.comments.commentsWidgetForNativeTimeline()},resizeCommentsTWidget:function(){var t=e.helper.find(".vbs-record-timeline-wrap").width(),a=e.data.duration;e.helper.find(".vbs-comments-wrapper-block div.vbs-comments-wrapper ").each(function(){var e=s(this),r=e.attr("stime"),n=r*t/a;e.css("left",n)})},commentsWidgetForNativeTimeline:function(){var t=s(".vbs-comments-wrapper-block").find(".vbs-comments-wrapper"),a=e.PlayerApi.getPlayerIframe(),r=a.find(".scrubber");0===r.find(".vbs-comments-wrapper-block").length&&r.append('<div class="vbs-comments-wrapper-block"></div>');var n=r.find(".vbs-comments-wrapper-block");n.empty(),s.each(t,function(s,t){e.comments.createScruberComment(t,n)})},createScruberComment:function(t,a){var r=e.data.duration,n=s(t).attr("stime"),i=n/r*100,o=n>e.data.duration/2?"vbs-from-right":"",l=s(t).find("a").text(),d=s(e.templates.parse("vbsCommentsTimeline",{position:"0",rightClass:o,stime:n,commentText:l}));d.css({top:"-15px",left:i+"%"}),d.find(".vbs-comment-preview").css({"z-index":99999999991}),o||d.find(".vbs-comment-preview").css({"padding-left":"10px"}),a.append(d)},toggleBlockHandler:function(s){s.toggleClass("vbs-hidden");var t=s.parents(".vbs-comments-block").find(".vbs-section-body");s.hasClass("vbs-hidden")?(s.attr("data-title","Show Comments"),t.slideUp()):(s.attr("data-title","Hide Comments"),t.slideDown(),e.helper.collapseNewsBlock())},clickAddCommentHandler:function(t){var a={},r=e.data.position;a.vbt=Math.round(r);var n=e.helper.parseTime(Math.round(r)),i=e.templates.parse("commentPopup",{vbt:a.vbt,vbspTime:n}),o=e.helper.find(".vbs-comments-popup"),l=e.helper.find(".vbs-comments-block .vbs-section-btns");t.hasClass("vbs-active")?o.fadeOut("fast",function(){l.find(".vbs-comments-btn").removeClass("vbs-active"),o.remove()}):(e.helper.find(".vbs-comments-popup").each(function(){s(this).remove()}),l.find(".vbs-clearfix li").append(i),l.find(".vbs-comments-btn").addClass("vbs-active"),e.helper.find(".vbs-comments-popup").show(),s("#vbs-comment-text").focus()),e.helper.collapseNewsBlock()},confirmAddCommentHandler:function(s){e.helper.collapseNewsBlock();var t=s.parent(".vbs-comment-footer").parent(".vbs-comments-popup"),a={},r=t.find("#vbs-comment-text").val(),n=t.find("#vbs-comment-timeline").attr("vbct");return""===r?(alert("Text of comment is required."),!1):(e.helper.find(".vbs-comments-popup").fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),e.helper.find(".vbs-comments-popup").addClass("vbs-hidden")}),a.comment=r,a.comment_timestamp=n,a.parent_comment_id=!1,e.comments.addComment(a),void 0)},playCommentHandler:function(s){var t=setTimeout(function(){clearTimeout(t),e.PlayerApi.seek(s.parent(".vbs-comment-popup-row").find("#vbs-comment-timeline").attr("vbct"))},250)},replyHandler:function(s){var t=e.templates.parse("commentReplyPopup",{c_id:s.attr("c_id")}),a=s.parent(".vbs-comment-reply-wrapper");0===a.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),a.append(t),a.find(".vbs-comments-popup").show()):a.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},replyConfirmHandler:function(s){var t=s.parents(".vbs-comment-footer").parents(".vbs-comments-popup"),a={},r=t.find("#vbs-comment-reply-text").val(),n=s.attr("c_id");return""===r?(alert("Text of comment is required."),!1):(t.parents(".vbs-comment-reply-wrapper").find(".vbs-comments-popup").remove(),a.comment=r,a.comment_timestamp=!1,a.parent_comment_id=n,e.comments.addComment(a),void 0)},editHandler:function(s){var t=s.attr("c_tm"),a=e.helper.parseTime(Math.round(t)),r=s.parents(".vbs-comment-row"),n=r.find(".vbs-comment-message p").text(),i={c_id:s.attr("c_id"),vbt:t,vbspTime:a,commentText:n},o=r.hasClass("vbs-answer1")?e.templates.parse("commentEditFirstPopup",i):e.templates.parse("commentEditPopup",i),l=s.parent(".vbs-comment-edit-btn-wrapper");0===l.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),l.append(o),l.find(".vbs-comments-popup").show(),l.find("textarea").focus()):l.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},editConfirmHandler:function(s){var t=s.parents(".vbs-comments-popup"),a={},r=t.find("textarea").val(),n=s.attr("c_id");return""===r?(alert("Text of comment is required."),!1):(a.comment=r,a.comment_timestamp=!1,a.comment_id=n,t.find("textarea").attr("disabled",!0),e.api.data.tmp.commentParent=t,e.api.data.tmp.commentData=a,e.comments.editComment(a),void 0)},deleteHandler:function(s){var t=e.templates.parse("commentDeletePopup",{c_id:s.attr("c_id")}),a=s.parent(".vbs-comment-delete-btn-wrapper");0===a.find(".vbs-comments-popup").length?(e.helper.find(".vbs-comments-popup").addClass("old_reply_popup"),a.append(t),a.find(".vbs-comments-popup").show()):a.find(".vbs-comments-popup").remove(),e.helper.find(".vbs-comments-popup.old_reply_popup").remove(),e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active")},deleteConfirmHandler:function(s){var t=s.attr("c_id");e.comments.deleteComment(t),s.parents(".vbs-comment-edit-wrapper").remove()},cancelHandler:function(s){var t=s.parents(".vbs-comments-popup");t.fadeOut("fast",function(){e.helper.find(".vbs-comments-block .vbs-section-btns .vbs-comments-btn").removeClass("vbs-active"),t.addClass("vbs-hidden").remove()})},commentTimeHandler:function(s){var t=s.attr("data-vbct");t&&e.PlayerApi.seek(t)},updateTimeInPopup:function(s){var t=s||0===s?s:e.data.played;e.helper.find(".vbs-comments-add-popup #vbs-comment-timeline").html(e.helper.parseTime(t)).attr("vbct",t)}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,s=!{toString:null}.propertyIsEnumerable("toString"),t=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=t.length;return function(r){if("object"!=typeof r&&("function"!=typeof r||null===r))throw new TypeError("Object.keys called on non-object");var n,i,o=[];for(n in r)e.call(r,n)&&o.push(n);if(s)for(i=0;a>i;i++)e.call(r,t[i])&&o.push(t[i]);return o}}()),String.prototype.padLeft=function(e){return new Array(e-this.length+1).join("0")+this},jQuery.extend(jQuery.expr[":"],{wordtime:function(e,t,a){var r=parseFloat(s(e).attr("t")),n=a[3].split(/\s?,\s?/),i=parseFloat(n[0]),o=parseFloat(n[1]);return!isNaN(r)&&!isNaN(i)&&!isNaN(o)&&o>=r&&r>=i}}),e.common={getStringFromObject:function(e){return Object.keys(e).map(function(s){return encodeURIComponent(s)+"="+encodeURIComponent(e[s])}).join("&")},inArrayV:function(e,s){for(var t in e)if(e[t]==s)return!0;return!1},findTermInArray:function(s,t){for(var a=!1,r=0;r<s.length;r++){var n=s[r];if(n=e.helper.replaceTrimAndLower(n),n===t){a=!0;break}}return a},keysToLowerCase:function(e){for(var s=Object.keys(e),t=s.length;t--;){var a=s[t];a!==a.toLowerCase()&&(e[a.toLowerCase()]=e[a],delete e[a])}return e},vbmenus:function(t,a,r){var n="undefined"!=typeof s.fn.zclip,i="undefined"!=typeof addthis;if(n===!1&&i===!1&&e.settings.editKeywords===!1||e.settings.contextMenu===!1&&"keyword"!==a)return!1;t.preventDefault();var o={},l=s(r).parents("ul").hasClass("group");if("timeline"===a){var d;if("ins"==t.target.localName)d=s(t.target).parent().attr("stime");else{var p=t.offsetX||t.clientX-s(t.target).offset().left;d=Math.round(e.data.duration*(p+t.target.offsetLeft)/e.helper.find(".vbs-record-timeline-wrap").width())}o.vbt=d;var c=s("#vbs-voice_search_txt");c.val().length&&(o.vbs=encodeURI(c.val()))}else if("keyword"==a){var v=s(r).data("keywordInternalName");v.match(/\s+/g)&&(v='"'+v+'"'),o.vbs=encodeURI(v)}else if("transcript"==a){var b=s(r).text();b=encodeURI(b),o.vbs=b}s("ul.vbs-vbcmenu").remove();var u=e.helper.getNewUrl(o),m=s("<ul class='vbs-vbcmenu'></ul>");if(n&&e.settings.contextMenu&&m.append('<li id="vbc_url"><a href="#">Copy URL</a></li>'),i&&e.settings.contextMenu&&m.append('<li id="vbc_share"><a class="addthis_button_expanded addthis_default_style" addthis:url="'+u+'" addthis:title="Check out">Share</a></li>'),"keyword"==a&&e.settings.editKeywords&&!l){var f=s(r),h='<span class="vbs-keyword_controls">';f.parent().prev().length&&(h+='<span class="vbs-vbe vbs-voicebase_first" title="Move to Top">Move to Top</span><span class="vbs-vbe vbs-voicebase_up" title="Move up">Move up</span>'),f.parent().next().length&&(h+='<span class="vbs-vbe vbs-voicebase_down" title="Move down">Move down</span>'),h+='<span class="vbs-vbe vbs-voicebase_remove" title="Remove">Remove</span></span>';var g=s(h);g.data("keywordInternalName",f.data("keywordInternalName"));var y=s('<li id="vbc_move"></li>');y.append(g),m.append(y)}m.appendTo("body");var w=s(".vbs-vbcmenu"),k=e.view.getPositionElementForTooltip(s(r));w.height()+t.pageY<document.body.clientHeight?w.css({top:k.top+s(r).height()+"px",left:k.left+k.width/2+"px"}):w.css({top:k.top-s(r).height()-w.height()+"px",left:k.left+k.width/2+"px"}),n&&s("#vbc_url").find("a").zclip({path:e.settings.zeroclipboard,copy:u}),i&&addthis.toolbox("#vbc_share")},vbEditMenu:function(e,t){var a=s(t),r=s(".vbs-edit-mode-wrapper");s("ul.vbs-vbcmenu").remove(),r.find(".vbs-menu-target").removeClass("vbs-menu-target"),a.addClass("vbs-menu-target");var n=a.attr("t")/1e3,i=n>1?n-1:n,o="";if(o+='<li><a href="#" class="vbsc-edit-play" data-time="'+i+'">Play</a></li>',a.hasClass("vbs-edit-speaker")||a.prev().hasClass("vbs-edit-speaker")||(o+='<li><a href="#" class="vbsc-edit-speaker" data-time="'+1e3*n+'">Insert Speaker</a></li>'),a.hasClass("vbs-edit-speaker")){var l=a.attr("m")||"";o+='<li><a href="#" class="vbsc-rename-speaker" data-speaker-key="'+l+'">Rename Speaker</a></li>'}r.append("<ul class='vbs-vbcmenu'>"+o+"</ul>");var d=s(".vbs-vbcmenu"),p=e.clientY+r.scrollTop();d.height()+e.clientY<document.body.clientHeight?d.css({top:p+"px",left:e.pageX+"px"}):(s(t).find("br").length>0&&(p+=15*s(t).find("br").length),d.css({top:p-d.height()-a.height()+"px",left:e.pageX+"px"}))},uniqueArray:function(e){e=e?e:[];for(var s={},t=0;t<e.length;t++)s[e[t]]=!0;return e=Object.keys(s)},hidePopup:function(e){e.fadeOut("fast",function(){s(this).remove()})},unEscapeHtml:function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;lt;/g,"&lt;").replace(/&amp;gt;/g,"&gt;")}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.events={time:null,onTime:function(){if(e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface){Math.round(e.data.position)!=Math.round(e.PlayerApi.getPosition())&&(e.data.clicker||e.helper.hideLoader(),e.settings.transcriptHighlight!==!1&&e.helper.highlight(e.PlayerApi.getPosition()),e.data.movelistner=!1),e.data.position===e.data.duration&&e.helper.hideLoader();var s=e.data.position=e.PlayerApi.getPosition();"PLAYING"===e.PlayerApi.getStatus()&&-1!==e.PlayerApi.getDuration()&&e.data.duration!==e.PlayerApi.getDuration()&&(e.data.duration=e.PlayerApi.getDuration(),e.view.renderTimeInMediaTitle());var t=e.data.duration;if(e.data.dragging===!1&&e.data.movelistner===!1&&"undefined"!=typeof s&&t){e.helper.find(".vbs-player-slider").css("left",100*s/t+"%"),e.helper.find(".vbs-record-progress").css("width",100*s/t+"%");var a=e.helper.parseTime(s);e.helper.find(".vbs-ctime").html(a),e.comments.updateTimeInPopup(s),e.helper.find(".vbs-share-popup").find(".vbsp-time").attr("vbct",s).html(a)}e.data.clicker||("PAUSED"==e.PlayerApi.getStatus()?e.helper.find(".vbs-player-control .vbs-play-btn").removeClass("vbs-playing").attr("data-title","Play"):"PLAYING"==e.PlayerApi.getStatus()&&e.helper.find(".vbs-player-control .vbs-play-btn").addClass("vbs-playing").attr("data-title","Pause")),e.PlayerApi.getBuffer()&&e.helper.find(".vbs-record_buffer").css("width",e.PlayerApi.getBuffer()+"%"),e.speakers.speakerIsSpeaking()}},registerEvents:function(){var t=e.helper.isMobile()?"touchstart":"touchstart click";e.settings.toggleBlocks&&e.settings.toggleMediaBlock&&e.helper.find(".vbs-media-block .vbs-section-title").off(t).on(t,function(t){t.preventDefault();var a=s(this);a.toggleClass("vbs-hidden"),a.hasClass("vbs-hidden")?(e.data.playerHeight=e.data.playerDom.height(),"sublime"==e.settings.playerType||"video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.hide():e.data.playerDom.css({height:"0px"}),e.helper.find(".vbs-expand-btn").hide(),e.helper.findc(".vbs-player-wrapper .vbs-time").hide(),a.parents(".vbs-media-block").hasClass("vbs-video")&&s(".vbs-tooltip").text("Show Video"),a.attr("data-title","Show Video")):("sublime"==e.settings.playerType||"video_js"==e.settings.playerType||"jplayer"==e.settings.playerType||"jwplayer"==e.settings.playerType&&"html5"===e.PlayerApi.getRenderingMode()?e.data.playerDom.show():e.data.playerDom.css({height:e.data.playerHeight+"px"}),e.helper.find(".vbs-expand-btn").show(),e.helper.findc(".vbs-player-wrapper .vbs-time").show(),a.parents(".vbs-media-block").hasClass("vbs-video")&&s(".vbs-tooltip").text("Hide Video"),a.attr("data-title","Hide Video"))}),e.settings.markersInNativeTimeline&&s(document).off("DOMSubtreeModified",".vbs-markers").on("DOMSubtreeModified",".vbs-markers",function(s){s.target.innerHTML.length>0?e.view.markerWidgetForNativeTimeline():e.view.clearScrubberOfMarks()}),e.helper.find(".vbs-markers,.vbs-custom-markers").on(t,"a.vbs-marker",function(t){t.preventDefault();var a=s(this).attr("stime");return e.PlayerApi.seek(a),!1}),e.helper.find(".vbs-comments-wrapper-block").on(t,".vbs-comment-preview a",function(t){t.preventDefault(),e.helper.collapseNewsBlock();var a=s(this).attr("stime");return e.PlayerApi.seek(a),!1}),s("."+e.data.vclass+" .vbs-player-control, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on(t,".vbs-play-btn",function(t){t.preventDefault();var a=s(this),r=s(".vbs-tooltip");return a.hasClass("vbs-playing")?(a.removeClass("vbs-playing").attr("data-title","Play"),e.helper.track("pause"),r.text("Play"),e.helper.hideLoader(),e.PlayerApi.pause()):(e.helper.track("play"),a.addClass("vbs-playing").attr("data-title","Pause"),r.text("Pause"),e.helper.showLoader(),e.PlayerApi.play()),!1}),s(document).off(t,".vbs-prev-btn").on(t,".vbs-prev-btn",function(s){s.preventDefault();var t=e.PlayerApi.getPosition()-15;return t=0>t?.001:t,e.PlayerApi.seek(t),!1}),e.helper.find(".vbs-next-action-btn").on(t,function(t){if(t.preventDefault(),!s(this).hasClass("vbs-next-notactive")){var a=e.helper.find(".vbs-record-timeline-wrap .vbs-markers");e.helper.moveToNextMarker(a)}}),s(window).off("resize.vbs_resize").on("resize.vbs_resize",function(){if(e.view.resizeTimelineElements(),e.helper.isMobile()){var t=e.PlayerApi.getMobilePlayerSize();e.PlayerApi.setSizePlayer(t.mobile_width,t.mobile_height),s("#"+e.settings.mediaBlock).css("width",e.helper.getMobileWidth())}e.view.checkResponsive()}),s(document).off("mousedown",".vbs-record-timeline-wrap .vbs-dragger").on("mousedown",".vbs-record-timeline-wrap .vbs-dragger",function(t){t.preventDefault();var a=s(this).parents(".vbs-record-timeline-wrap");if(0===t.button){var r=100*(t.pageX-a.offset().left)/a.width();e.helper.find(".vbs-player-slider").css("left",r+"%"),e.helper.find(".vbs-record-progress").css("width",r+"%"),e.data.movelistner=!0,e.data.dragging=!0}}).off("mousemove",".vbs-record-timeline-wrap .vbs-dragger").on("mousemove",".vbs-record-timeline-wrap .vbs-dragger",function(t){t.preventDefault();var a=s(this).parents(".vbs-record-timeline-wrap"),r=100*(t.pageX-a.offset().left)/a.width();r>100?r=100:0>r&&(r=0),e.data.played=Math.round(e.data.duration*r/100),e.data.dragging&&(e.helper.find(".vbs-player-slider").css("left",r+"%"),e.helper.find(".vbs-record-progress").css("width",r+"%"),e.helper.find(".vbs-ctime").html(e.helper.parseTime(e.data.played)),e.helper.find(".vbs-share-popup .vbsp-time").html(e.helper.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.updateTimeInPopup(null))}).off("mouseup.vbs_mouseup").on("mouseup.vbs_mouseup",function(){if(e.data.dragging&&(e.PlayerApi.seek(e.data.played),e.helper.track("seek",e.data.played),e.helper.find(".vbs-share-popup .vbsp-time").html(e.helper.parseTime(e.data.played)).attr("vbct",e.data.played),e.comments.updateTimeInPopup(null),e.helper.find("#vbs-share-position").is(":checked"))){var t={};t.vbt=e.data.played;var a=e.helper.getNewUrl(t);s("#vbsp-url").val(a),"undefined"!=typeof addthis&&addthis.update("share","url",a)}e.data.dragging=!1}),e.helper.find(".vbs-markers,.vbs-custom-markers").on({mouseover:function(t){e.helper.find('[ctime="'+s(t.target).parent().attr("stime")+'"]').fadeIn(75)},mouseout:function(t){e.helper.find('[ctime="'+s(t.target).parent().attr("stime")+'"]').fadeOut(100)}}),e.helper.find(".vbs-utterance-markers").on(t,".vbs-utter-marker",function(t){t.preventDefault();var a=s(this).attr("data-stime");return e.PlayerApi.seek(a),!1}),s(document).off("change",".vbs-utterance-block input[type=checkbox]").on("change",".vbs-utterance-block input[type=checkbox]",function(){var t=s(this).attr("data-row");e.helper.find(".vbs-utterance-markers").find(".vbs-utter-row"+t).toggle()}),e.helper.find(".vbs-volume-toolbar, ."+e.data.vclass+" .vbs-edit-mode-prewrapper").on(t,".vbs-volume-btn",function(t){t.preventDefault();var a=s(this),r=e.helper.find(".vbs-volume-toolbar-block");if(a.hasClass("show"))r.fadeOut("fast"),a.removeClass("show");else{var n=e.PlayerApi.getVolume();e.PlayerApi.setUiVolume(n),r.fadeIn(100),a.addClass("show")}}),s(document).off("mousedown",".vbs-volume-toolbar-block").on("mousedown",".vbs-volume-toolbar-block",function(t){var a=s(this);if(0===t.button){var r=100-100*(t.pageY-a.find(".vbs-volume-slider").offset().top)/s(this).height();r>100?r=100:0>r&&(r=0),e.PlayerApi.setUiVolume(r),e.PlayerApi.setVolume(r),e.data.draggingVol=!0}}).off("mousemove",".vbs-volume-toolbar-block").on("mousemove",".vbs-volume-toolbar-block",function(t){t.preventDefault();var a=s(this);if(e.data.draggingVol){var r=100-100*(t.pageY-a.find(".vbs-volume-slider").offset().top)/s(this).height();r>100?r=100:0>r&&(r=0),e.PlayerApi.setUiVolume(r),e.PlayerApi.setVolume(r)}}).on("mouseup mouseleave",function(){e.data.draggingVol=!1}),e.helper.find(".vbs-keywords-block").on(t,".vbs-keywords-list-tab li a",function(t){t.preventDefault(),e.data.keywordClickEvent=!0,"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader();var a=s(this);e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.removeBold();var r=a.data("keywordInternalName"),n=e.helper.termFor(r,"url"),i=e.helper.termFor(r,"marker");e.helper.find("#vbs-voice_search_txt").val(n).change(),a.addClass("bold"),i.length&&e.view.searchWordWidget(i);var o=e.helper.find("#vbs-voice_search_txt");return o.data("data-val",o.val()),e.helper.track("keyword",r),e.api.getSearch(i),e.api.getNews(),e.data.keywordClickEvent=!1,!1}),e.settings.toggleBlocks&&e.settings.toggleKeywordsBlock&&e.helper.find(".vbs-keywords-block .vbs-section-title").on(t,function(e){e.preventDefault();var t=s(this);t.toggleClass("vbs-hidden");var a=t.parents(".vbs-keywords-block");t.hasClass("vbs-hidden")?(t.attr("data-title","Show Keywords"),a.find(".vbs-section-body").slideUp(),a.find(".vbs-search-form").hide()):(t.attr("data-title","Hide Keywords"),a.find(".vbs-section-body").slideDown(),a.find(".vbs-search-form").show())}),e.helper.find(".vbs-keywords-block .vbs-more-btn a").on(t,function(t){t.preventDefault(),e.settings.keywordsHeight>e.helper.getMaxKeywordHeight()&&(e.settings.keywordsHeight=e.helper.getKeywordHeight());var a="100%";e.helper.find(".vbs-keywords-list-wrapper").css({height:a});var r=s(this);return e.data.kf?(e.data.kf=!1,r.text("Show More..."),e.helper.find(".vbs-keywords-wrapper").animate({height:e.settings.keywordsHeight+"px"},700)):(e.helper.find(".vbs-keywords-wrapper").animate({height:e.helper.getMaxKeywordHeight()+"px"},700),r.text("Hide More..."),e.data.kf=!0),!1}),s(document).off(t,".vbs-widget em").on(t,".vbs-widget em",function(t){t.preventDefault();var a=s(this),r=a.find(".vbs_word"),n=s("#vbs-voice_search_txt"),i=[];r.length&&(s.each(r,function(e,t){i.push(s(t).find(".search_word").text()),s(t).remove()}),n.val(i.join(" "))),e.helper.find(".vbs-widget-wrap").addClass("focused"),n.css("opacity","1"),e.helper.find("#vbs-search-string").hide(),n.focus()}),e.helper.find("#vbs-clear-string").on(t,function(t){return t.preventDefault(),s(this).parents(".vbs-search-form").hasClass("vbs-filled")&&(e.helper.collapseNewsBlock(),e.PlayerApi.pause(),e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find("#vbs-voice_search_txt").val("").change(),e.helper.find(".vbs-kwe-add").remove(),e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").stop(!0).css("left",0)),!1}),e.helper.find("#vbs-voice_search_txt").on("keyup",function(){var s=e.helper.getSearchWordsArray();s.length?e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p"):e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p")}),e.helper.find("#vbs-voice_search_txt").on("blur",function(){var t=e.helper.getSearchWordsArray();t.length?(e.view.searchWordWidget(t),e.helper.find(".vbs-powered-by-label").addClass("vbs-hidden-p")):(e.helper.find(".vbs-markers, .vbs-search-word-widget").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-powered-by-label").removeClass("vbs-hidden-p"));var a=s(this);a.data("data-val",a.val()),e.helper.find(".vbs-widget-wrap").removeClass("focused"),e.helper.find("#vbs-search-string").show()}),e.helper.find("#vbs-voice_search_txt").on("change",function(){var t=s(this);e.helper.removeBold();var a=e.helper.find("#vbs-search-string");if(t.val().length>0?e.helper.find(".vbs-search-form").addClass("vbs-filled"):(e.helper.find(".vbs-search-form").removeClass("vbs-filled"),t.css("opacity","1"),a.hide(),e.helper.find("#vbs-voice_search_txt").focus()),s("#vbs-share-search").is(":checked")){var r={};r.vbs=encodeURI(t.val());var n=e.helper.getNewUrl(r);e.helper.find("#vbsp-url").val(n),"undefined"!=typeof addthis&&addthis.update("share","url",n)}e.helper.find(".vbs-kwe-add").remove(),e.helper.updateQuotesVisibility(),a.show()}),e.helper.find("#vbs-search-btn").on(t,function(s){s.preventDefault(),e.helper.find("#vbs-search-form").submit()}),e.helper.find("#vbs-search-form").on("submit",function(){if(s("#vbs-searchbar-block").find(".vbs-search-form").hasClass("vbs-form-disabled"))return!1;"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.find("#vbs-voice_search_txt").blur(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.helper.find(".vbs-kwe-add").remove();
var t=e.helper.getSearchWordsArray();return t.length>0?(e.helper.showLoader(),e.view.searchWordWidget(t),e.api.getSearch(t)):e.helper.updateQuotesVisibility(),!1}),s(document).off(t,".vbs-unquote-btn").on(t,".vbs-unquote-btn",function(s){s.preventDefault(),e.helper.removeQuotes()}),e.helper.find("#vbs-search-string").on(t,function(t){t.preventDefault(),e.helper.isMobile()&&t.stopPropagation(),(s(t.target).hasClass("vbs-search-word-widget")||0===e.helper.find("#vbs-voice_search_txt").val().length)&&(s(this).hide(),e.helper.find("#vbs-voice_search_txt").css("opacity","1").focus())}),e.helper.find(".vbs-topics").on(t,'.vbs-topics-list li[class="vbs-active"]',function(e){e.preventDefault()}),e.helper.find(".vbs-topics").on(t,'.vbs-topics-list li[class!="vbs-active"]',function(){e.helper.selectTopic(s(this))}),e.helper.find(".vbs-keywords-list-tab").on("mouseenter touchstart","li.key a",function(t){var a=s(t.target).is("span")?s(t.target).parent():s(t.target),r=a.attr("t");e.view.keywordHover(r)}),e.helper.find(".vbs-keywords-list-tab").on("mouseleave touchend","li.key a",function(){e.view.removeKeywordHover()}),e.settings.topicHover===!0&&e.helper.find(".vbs-keywords-block").on({mouseover:function(){var t=s(this).text().trim(),a=[];e.helper.find('.vbs-keywords-list-tab ul[tid="'+t+'"]').find("li.key a").each(function(){a.push(s(this).attr("t"))});var r=[];s.each(a.join().split(","),function(e,t){-1===s.inArray(t,r)&&r.push(t)}),e.view.keywordHover(r.join())},mouseout:function(){e.view.removeKeywordHover()}},".vbs-topics-list li a"),e.helper.find(".vbs-select-language").on(t,function(e){e.preventDefault(),a(s(this))}),e.helper.find(".vbs-select-language-wrapper .vbs-select-dropdown").on(t,"li",function(t){t.preventDefault();var a=s(this);return a.hasClass("vbs-disabled")?!1:(a.parents(".vbs-select-dropdown").fadeOut("fast"),e.view.selectLanguage({lang_code:a.attr("data-lang-code"),lang_name:a.text()}),void 0)}),e.helper.find(".vbs-select-speaker").on(t,function(e){e.preventDefault(),a(s(this))});var a=function(s){s.hasClass("vbs-s-show")?(e.helper.find(".vbs-select-dropdown").fadeOut("fast"),s.removeClass("vbs-s-show")):(e.helper.find(".vbs-select-dropdown").fadeIn(100),s.addClass("vbs-s-show"))},r=e.helper.find(".vbs-select-speaker"),n=e.helper.find(".vbs-search-btn"),i=e.helper.find(".vbs-widget-wrap"),o=parseInt(i.css("paddingLeft"))+parseInt(i.css("paddingRight")),l=n.width()+parseInt(n.css("borderLeft")),d=parseInt(r.css("paddingLeft"))+parseInt(r.css("paddingRight")),p=parseInt(r.css("borderLeftWidth"))+parseInt(r.css("borderRightWidth")),c=parseInt(i.css("minWidth"));if(s("#vbs-keywords").width()<=437&&(r.addClass("vbs-fixed-width"),i.addClass("vbs-without-min-width")),s("#vbs-keywords").width()<=360&&e.helper.find(".vbs-search-form").addClass("less-360px"),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").on(t,"li",function(t){t.preventDefault(),r.css("width","auto");var a=s(this);if(a.hasClass("vbs-disabled"))return!1;e.helper.find(".vbs-select-dropdown").fadeOut("fast");var v=a.attr("data-speaker"),b="all"==v?"Select speaker...":a.text();if(e.helper.find(".vbs-select-speaker").removeClass("vbs-s-show").html(b),e.helper.filterKeywords(v),!e.settings.searchBarOuter){var u,m,f,h=a.parents("#vbs-keywords");if(h.hasClass("less-600px")){if(h.width()<=437)return!1;u=r.width()+d+p;var g=12;if(n.css("right",u+g),i.css("marginRight",u+l+g),i.width()<=c){m=e.helper.find(".vbs-keywords-block").width();var y=e.helper.find(".vbs-widget-wrap"),w=parseInt(y.css("borderLeftWidth"))+parseInt(y.css("borderRightWidth"));f=m-(c+w+l+g+p+d+o),r.css("width",f),n.css("right",f+d+p+g),i.css("marginRight",f+d+p+l+g)}}else if(u=r.width()+d+p,n.css("right",u),i.css("marginRight",u+l),i.width()<=c){m=e.helper.find(".vbs-keywords-block").width()-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderLeftWidth"))-parseInt(e.helper.find(".vbs-keywords-block .vbs-section-header").css("borderRightWidth"));var k=e.helper.find(".vbs-keywords-block .vbs-section-title").width()+parseInt(e.helper.find(".vbs-keywords-block .vbs-search-form").css("borderLeftWidth"));f=m-(k+l+c+p+d+o+1),r.css("width",f),n.css("right",f+d+p),i.css("marginRight",f+d+p+l)}}}),e.settings.editKeywords){s(document).off(t,".vbs-voicebase_up").on(t,".vbs-voicebase_up",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordUp)return e.settings.webHooks.keywordUp(),!1;var a,r=s(this),n=r.parent().data("keywordInternalName"),i=v(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=s(i).text();e.api.editKeyword("up",o,a,i)}),s(document).off(t,".vbs-voicebase_down").on(t,".vbs-voicebase_down",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordDown)return e.settings.webHooks.keywordDown(),!1;var a,r=s(this),n=r.parent().data("keywordInternalName"),i=v(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=s(i).text();e.api.editKeyword("down",o,a,i)}),s(document).off(t,".vbs-voicebase_first").on(t,".vbs-voicebase_first",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.keywordFirst)return e.settings.webHooks.keywordFirst(),!1;var a,r=s(this),n=r.parent().data("keywordInternalName"),i=v(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=s(i).text();e.api.editKeyword("first",o,a,i)}),s(document).off(t,".vbs-voicebase_remove").on(t,".vbs-voicebase_remove",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeKeyword)return e.settings.webHooks.removeKeyword(),!1;var a,r=s(this),n=r.parent().data("keywordInternalName"),i=v(n);e.helper.find(".vbs-topics")&&(a=e.helper.find(".vbs-topics-list li.vbs-active").text());var o=s(i).text();e.api.removeKeyword(o,a,i)});var v=function(t){var a;return e.helper.find(".vbs-keywords-list-tab ul.vbs-active").find("a").each(function(){return s(this).data("keywordInternalName")==t?(a=s(this),!0):void 0}),a};s(document).off(t,".vbs-topic-del-btn-wrap .vbs-cross-btn").on(t,".vbs-topic-del-btn-wrap .vbs-cross-btn",function(t){t.preventDefault();var a=s(".vbs-topic-delete-popup"),r=s(this);if(a.length)a.fadeOut("fast",function(){a.remove()});else{var n=s(document).find(".vbs-popup");n.hide().siblings("a").removeClass("vbs-active"),s(e.templates.parse("deleteTopicPopup",{topicname:r.parents("li").find("a").text()})).appendTo("body");var i=s(this).offset().top,o=s(this).offset().left,l=s(".vbs-topic-delete-popup");l.css({top:i+"px",left:o+"px"}),e.helper.find(".vbs-edit-topics").scroll(function(){l.fadeOut("fast",function(){s(this).remove()})})}}),s(document).off(t,".vbs-add-search-word").on(t,".vbs-add-search-word",function(t){t.preventDefault(),e.api.addKeywords(s(this).data("data-kwa"),s(this).data("data-kwt"))})}s(document).off(t,".vbs-topic-delete-popup .vbs-confirm-btn").on(t,".vbs-topic-delete-popup .vbs-confirm-btn",function(e){e.preventDefault(),s(".vbs-topic-delete-popup").fadeOut("fast",function(){s(this).remove()})}),s(document).off(t,".vbs-topic-delete-popup .vbs-cancel-btn").on(t,".vbs-topic-delete-popup .vbs-cancel-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.removeTopic)return e.settings.webHooks.removeTopic(),!1;var a=s(this),r=a.parents(".vbs-topic-delete-popup").attr("data-topic");e.api.removeTopic(r)}),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").on(t,"span.w",function(t){t.preventDefault(),"PLAYING"==e.PlayerApi.getStatus()&&e.PlayerApi.pause(),e.helper.showLoader(),e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=s(this),r=a.attr("t")/1e3;r=r>1?r-1:r,e.helper.find(".vbs-player-slider").css("left",r/e.data.duration*100+"%"),e.helper.find(".vbs-record-progress").css("width",r/e.data.duration*100+"%"),e.PlayerApi.seek(r);var n=a.text().trim();e.helper.track("transcript",n),n.match(/\s+/g)&&(n='"'+n+'"');var i=e.helper.find("#vbs-voice_search_txt");return i.val(n).change(),n.length&&e.view.searchWordWidget([n]),i.data("data-val",i.val()),e.api.getSearch([n],!1),!1}),e.settings.toggleBlocks&&e.settings.toggleTranscriptBlock&&e.helper.find(".vbs-transcript-block .vbs-section-title").on(t,function(e){e.preventDefault();var t=s(this);t.toggleClass("vbs-hidden"),t.hasClass("vbs-hidden")?(t.attr("data-title","Show Transcript"),t.parents(".vbs-transcript-block").find(".vbs-section-body").slideUp()):(t.attr("data-title","Hide Transcript"),t.parents(".vbs-transcript-block").find(".vbs-section-body").slideDown())}),e.helper.find(".vbs-transcript-block .vbs-more-btn a").on(t,function(t){t.preventDefault();var a=e.helper.find(".vbs-transcript-wrapper").height(),r=s(this);e.data.tf?(e.data.tf=!1,r.text("Show More..."),s(".vbs-transcript-prewrapper").animate({height:e.settings.transcriptHeight+"px"},700)):(s(".vbs-transcript-prewrapper").animate({height:a+20+"px"},700,"linear",function(){s(this).css({height:"auto"})}),r.text("Hide More..."),e.data.tf=!0)}),e.helper.find(".vbs-transcript-block .vbs-transcript-prewrapper").on({mouseover:function(){s(this).addClass("vbs-t-hover")},mouseout:function(){s(this).removeClass("vbs-t-hover")}}),e.helper.find(".vbs-section-btns").on(t,".vbs-cloud-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.downloadMedia)return e.settings.webHooks.downloadMedia(),!1;var a=s(this);a.hasClass("vbs-active")?(a.removeClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeOut("fast")):(a.addClass("vbs-active"),a.parent().find(".vbs-download-popup").fadeIn("fast"))}),e.helper.find(".vbs-download-popup").on(t,".vbs-donwload-pdf, .vbs-donwload-rtf, .vbs-donwload-srt",function(t){t.preventDefault(),e.helper.find(".vbs-cloud-btn").removeClass("vbs-active"),e.helper.find(".vbs-download-popup").fadeOut("fast");var a=s(this).attr("format");e.helper.downloadFile(a)}),e.helper.find(".vbs-media-block").on(t,".vbs-download-audio-btn",function(t){return t.preventDefault(),s(this).hasClass("vbs-disable-button")?!1:"undefined"!=typeof e.settings.webHooks.downloadTranscript?(e.settings.webHooks.downloadTranscript(),!1):(e.api.downloadAudio(),void 0)}),e.helper.find(".vbs-share-btn-wrapper").on(t,".vbs-share-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.socialShare)return e.settings.webHooks.socialShare(),!1;var a={},r=e.PlayerApi.getPosition();a.vbt=Math.round(r);var n=e.helper.getNewUrl(a),i=e.helper.parseTime(Math.round(r)),o="undefined"!=typeof s.fn.zclip?"":"vbs-no-zclip",l="";for(var d in e.settings.addThisButtons)l+='<a class="addthis_button_'+e.settings.addThisButtons[d]+'"></a>';var p="undefined"!=typeof addthis?'<div class="vbs-share-social-row vbs-clearfix">\n                        <span>Choose one:</span>\n                        <div class="vbs-social-wrapper">\n                            <div class="vbs-addthis-toolbox addthis_toolbox addthis_default_style">'+l+'<a class="addthis_counter addthis_bubble_style"></a>\n                            </div>\n                        </div>\n                    </div>':"",c=e.settings.voicebaseShare?'<span>or</span><a href="#" class="vbs-voicebase-share-btn">Share with E-mail</a>':"",v=e.templates.parse("sharePopup",{vbt:a.vbt,vbspTime:i,zclip:o,addthis:p,url:n,vbShareButton:c}),b=e.helper.find(".vbs-share-popup");0===b.length||b.hasClass("vbs-hidden")?(e.helper.find(".vbs-share-popup.vbs-hidden").remove(),e.helper.find(".vbs-share-btn-wrapper").append(v),"undefined"!=typeof s.fn.zclip&&e.helper.find(".vbs-copy-btn").zclip({path:e.settings.zeroclipboard,copy:function(){return e.helper.find("#vbsp-url").val()}}),"undefined"!=typeof addthis&&addthis.toolbox(".vbs-addthis-toolbox",{},{url:n,title:e.settings.shareTitle})):b.fadeOut("fast",function(){b.addClass("vbs-hidden").show()})}),s(document).off(t,"#vbs-share-position").on(t,"#vbs-share-position",function(){var s=e.PlayerApi.getPosition(),t=e.helper.parseTime(Math.round(s)),a={vbt:Math.round(s)};b(a,this),e.helper.find(".vbsp-time").html(t).attr("vbct",t)}),s(document).off(t,"#vbs-share-search").on(t,"#vbs-share-search",function(){var e={vbs:encodeURI(s("#vbs-voice_search_txt").val())};b(e,this)}),s(document).off(t,"#vbs-share-file").on(t,"#vbs-share-file",function(){var e={vbt:0};b(e,this)});var b=function(t,a){e.helper.find(".vbs-share-popup .vbs-share-radio-row").removeClass("vbs-checked"),s(a).parents(".vbs-share-radio-row").addClass("vbs-checked");var r=e.helper.getNewUrl(t);e.helper.find("#vbsp-url").val(r),"undefined"!=typeof addthis&&addthis.update("share","url",r)};e.helper.find(".vbs-share-btn-wrapper").on(t,".vbs-cancel-btn",function(e){e.preventDefault(),m()}),e.helper.find(".vbs-share-btn-wrapper").on(t,".vbs-addthis-toolbox a",function(e){e.preventDefault(),m()}),e.helper.find(".vbs-share-btn-wrapper").on(t,".vbsp-url",function(e){e.preventDefault(),s(this).select()});var u;e.helper.find(".vbs-share-btn-wrapper").on(t,".vbs-play-btn",function(t){t.preventDefault(),clearTimeout(u),u=setTimeout(function(){e.PlayerApi.seek(s(".vbsp-time").attr("vbct"))},250)}),e.helper.find(".vbs-share-btn-wrapper").on(t,".vbs-voicebase-share-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.vbShare?(e.settings.webHooks.vbShare(),("undefined"==typeof e.settings.webHooks.vbShareClose||"undefined"!=typeof e.settings.webHooks.vbShareClose&&e.settings.webHooks.vbShareClose===!0)&&m(),!1):(alert("Default Voicebase Share action"),void 0)});var m=function(){var s=e.helper.find(".vbs-share-popup");s.fadeOut("fast",function(){s.addClass("vbs-hidden").show()})};e.helper.find(".vbs-section-btns").on(t,".vbs-del-btn",function(e){e.preventDefault();var t=s(this);if(t.hasClass("vbs-disable-button"))return!1;var a=t.parent().find(".vbs-download-popup");t.hasClass("vbs-active")?(t.removeClass("vbs-active"),a.fadeOut("fast")):(t.addClass("vbs-active"),a.fadeIn("fast"))}),window.addEventListener("storage",function(s){"vbs-deleted-ids"===s.key&&e.helper.clearUiForDeletedIds()},!1),e.helper.find(".vbs-section-btns").on(t,".vbs-red-btn",function(t){return t.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),s(this).parents(".vbs-popup").fadeOut("fast"),e.helper.setDeletedIdsInLocalStorage(),"undefined"!=typeof e.settings.webHooks.remove?(e.settings.webHooks.remove(),!1):(alert("Default delete action"),void 0)}),e.helper.find(".vbs-section-btns").on(t,".vbs-blue-btn",function(t){t.preventDefault(),e.helper.find(".vbs-section-btns .vbs-del-btn").removeClass("vbs-active"),s(this).parents(".vbs-popup").fadeOut("fast")}),e.helper.find(".vbs-section-btns").on(t,".vbs-star-btn",function(t){t.preventDefault();var a=s(this);if(a.hasClass("vbs-disable-button"))return!1;if(a.hasClass("vbs-active")){if("undefined"!=typeof e.settings.webHooks.favoriteTrue)return e.settings.webHooks.favoriteTrue(),!1;e.api.favorite(!1)}else{if("undefined"!=typeof e.settings.webHooks.favoriteFalse)return e.settings.webHooks.favoriteFalse(),!1;e.api.favorite(!0)}}),e.helper.find(".vbs-section-btns").on(t,".vbs-help-btn",function(s){return s.preventDefault(),"undefined"!=typeof e.settings.webHooks.help?(e.settings.webHooks.help(),!1):(window.open(e.settings.helpUrl,"_blank"),void 0)}),e.helper.find(".vbs-section-btns").on(t,".vbs-expand-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreen)return e.settings.webHooks.fullscreen(),!1;if(s("body").addClass("vbs-fullscreen"),"sublime"==e.settings.playerType||"jplayer"==e.settings.playerType){var a=e.helper.findc(".vbs-player-wrapper");e.PlayerApi.setSizePlayer(a.width(),a.height())}var r=s("#"+e.settings.controlsBlock);return e.settings.markersInNativeTimeline?f("full"):g("full"),r.append('<a href="#" class="vbs-fullscreen-exit">Exit</a>').wrap('<div class="vbs-controls-wrapper"></div>').addClass("vbs-controls-box"),e.settings.markersInNativeTimeline&&h("full"),e.view.resizeTimelineElements(),e.helper.collapseNewsBlock(),!1}),s(document).off(t,".vbs-fullscreen-exit").on(t,".vbs-fullscreen-exit",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.fullscreenExit)return e.settings.webHooks.fullscreenExit(),!1;s("body").removeClass("vbs-fullscreen"),("sublime"==e.settings.playerType||"jplayer"==e.settings.playerType)&&e.PlayerApi.setDefaultSizePlayer(),s(this).remove();var a=s("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),e.settings.markersInNativeTimeline?(f("exit_full"),h("exit_full")):g("exit_full"),e.view.resizeTimelineElements()});var f=function(t){var a=s("#"+e.settings.controlsBlock),r=s("#vbs-searchbar-block");if("full"==t)if(a.addClass("vbs-native-markers"),e.settings.searchBarOuter)a.append(r);else{var n='<div id="vbs-searchbar-block" class="vbs-controls-after-searchbar vbs-searchbar-outer"></div>';a.append(n),r=s("#vbs-searchbar-block"),r.append(s(".vbs-search-form")),r.append(s(".vbs-after-controls-wrapper"))}else"exit_full"==t&&(a.removeClass("vbs-native-markers"),e.settings.searchBarOuter?a.after(r):(s(".vbs-keywords-block .vbs-section-title").after(s(".vbs-search-form")),s(".vbs-keywords-block").find(".vbs-controls-after-searchbar").empty().append(s(".vbs-after-controls-wrapper")),s("#vbs-searchbar-block").remove()))},h=function(t){var a=s("#vbs-searchbar-block");if("full"==t){var r=a.width()-s(".vbs-fullscreen-exit").width()-s(".vbs-after-controls-wrapper").width()-20;a.find(".vbs-search-form").width(r),s(".vbs-controls-wrapper").height("85px")}else"exit_full"==t&&(e.settings.searchBarOuter?a.find(".vbs-search-form").width(a.width()-s(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2):s(".vbs-search-form").width("inherit"))};e.helper.find(".vbs-section-btns").on(t,".vbs-readermode-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermode)return e.settings.webHooks.readermode(),!1;e.view.hideTooltips(),s("body").addClass("vbs-readermode");var a=s("#"+e.settings.controlsBlock);g("full"),a.append('<a href="javascript:void(0)" class="vbs-reader-exit">Exit</a>').wrap('<div id="vbs-controls-placement"><div class="vbs-controls-wrapper"></div></div>').addClass("vbs-controls-box"),e.view.resizeTimelineElements();var r=e.data.vclass;e.settings.localApp&&(r+=" vbs-local-app"),s("body").append('<div id="vbs-reader-wrap" class="'+r+'"></div>'),s(".vbs-controls-wrapper").appendTo("#vbs-reader-wrap"),s(".vbs-transcript-block").appendTo("#vbs-reader-wrap"),e.helper.collapseNewsBlock()}),s(document).off(t,".vbs-reader-exit").on(t,".vbs-reader-exit",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.readermodeExit)return e.settings.webHooks.readermodeExit(),!1;s("body").removeClass("vbs-readermode"),s(this).remove(),s(".vbs-controls-wrapper").appendTo("#vbs-controls-placement").unwrap(),s(".vbs-transcript-block").appendTo("#"+e.settings.transcriptBlock),s("#vbs-reader-wrap").remove();var a=s("#"+e.settings.controlsBlock);a.unwrap().removeClass("vbs-controls-box"),g("exit_full"),e.view.resizeTimelineElements()});var g=function(t){var a=s("#"+e.settings.controlsBlock),r=s("#vbs-searchbar-block");"full"==t?(e.settings.searchBarOuter?(r.css("height",0),a.append(r)):a.append(s(".vbs-search-form")),a.hasClass("less-600px")&&!e.helper.isMobile()&&a.removeClass("less-600px").addClass("less-600px-backup"),e.settings.markersInNativeTimeline&&e.view.resetControlsPlace()):"exit_full"==t&&(e.settings.searchBarOuter?(r.css("height","32px"),a.after(r)):s(".vbs-keywords-block .vbs-section-title").after(s(".vbs-search-form")),a.hasClass("less-600px-backup")&&!e.helper.isMobile()&&a.removeClass("less-600px-backup").addClass("less-600px"),e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar())};e.settings.toggleBlocks&&e.settings.toggleCommentBlock&&e.helper.find(".vbs-comments-block .vbs-section-title").on(t,function(t){t.preventDefault(),e.comments.toggleBlockHandler(s(this))}),e.helper.find(".vbs-comments-block .vbs-section-btns").on(t,".vbs-comments-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.clickAddCommentHandler(s(this)),void 0)}),e.helper.find(".vbs-comments-block").on(t,".vbs-section-header .vbs-confirm-btn",function(t){t.preventDefault(),e.comments.confirmAddCommentHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-play-btn",function(t){t.preventDefault(),e.helper.collapseNewsBlock(),e.comments.playCommentHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-time",function(t){t.preventDefault(),e.comments.commentTimeHandler(s(this)),e.helper.collapseNewsBlock()}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-reply",function(t){return t.preventDefault(),e.helper.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.comment?(e.settings.webHooks.comment(),!1):(e.comments.replyHandler(s(this)),void 0)}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-edit",function(t){return t.preventDefault(),e.helper.collapseNewsBlock(),"undefined"!=typeof e.settings.webHooks.commentEdit?(e.settings.webHooks.commentEdit(),!1):(e.comments.editHandler(s(this)),void 0)}),e.helper.find(".vbs-comments-block").on(t,".vbs-section-header .vbs-cancel-btn, .vbs-comment-reply-wrapper .vbs-cancel-btn, .vbs-comment-edit-btn-wrapper .vbs-cancel-btn, .vbs-comment-delete-btn-wrapper .vbs-confirm-btn",function(t){t.preventDefault(),e.helper.collapseNewsBlock(),e.comments.cancelHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-reply-wrapper .vbs-confirm-btn",function(t){t.preventDefault(),e.helper.collapseNewsBlock(),e.comments.replyConfirmHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-edit-btn-wrapper .vbs-confirm-btn",function(t){t.preventDefault(),e.helper.collapseNewsBlock(),e.comments.editConfirmHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-delete",function(t){t.preventDefault(),e.helper.collapseNewsBlock(),e.comments.deleteHandler(s(this))}),e.helper.find(".vbs-comments-block").on(t,".vbs-comment-delete-btn-wrapper .vbs-cancel-btn",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.commentDelete?(e.settings.webHooks.commentDelete(),!1):(e.comments.deleteConfirmHandler(s(this)),void 0)}),e.helper.find(".vbs-section-btns").on(t,".vbs-evernote-btn",function(s){if(s.preventDefault(),"undefined"!=typeof e.settings.webHooks.evernote)return e.settings.webHooks.evernote(),!1;if("undefined"!=typeof filepicker){var t=null!==e.api.response.metadata&&""!==e.api.response.metadata.response.title?e.api.response.metadata.response.title:"VoiceBase";filepicker.exportFile(e.api.getAutoNotesHtmlURL(),{service:"EVERNOTE",suggestedFilename:t})}}),e.helper.find(".vbs-section-btns").on(t,".vbs-edit-btn",function(t){if(t.preventDefault(),e.helper.getIsSaving())return!1;if("undefined"!=typeof e.settings.webHooks.editTranscript)return e.settings.webHooks.editTranscript(),!1;e.view.hideTooltips(),e.data.savingSpeakers=s.extend({},e.data.speakers),e.helper.find(".vbs-edit-mode-prewrapper").html(e.templates.parse("vbs-edit-trans-mode",{ourtranscript:e.helper.editTranscriptText()})),s("body").addClass("vbs-no-scroll");var a=s("#"+e.settings.transcriptBlock);a.wrap('<div id="transcript_placement"></div>'),s("body").append('<div id="vbs-edit-wrap"  class="'+e.data.vclass+'"></div>'),a.appendTo("#vbs-edit-wrap"),e.helper.collapseNewsBlock()}),e.helper.find(".vbs-transcript-block").on(t,".vbs-edit-mode-exit",function(t){return t.preventDefault(),"undefined"!=typeof e.settings.webHooks.editTranscriptExit?(e.settings.webHooks.editTranscriptExit(),!1):(e.data.speakers=e.data.savingSpeakers,s("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),s("#vbs-edit-wrap").remove(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),s("body").removeClass("vbs-no-scroll"),void 0)}),e.helper.find(".vbs-transcript-block").on(t,".vbs-save-edition-popup-trigger",function(s){s.preventDefault(),e.helper.showSaveQuestion()}),e.helper.find(".vbs-transcript-block").on(t,".vbs-cancel-edition-btn",function(s){s.preventDefault(),e.helper.find(".vbs-save-popup-wrapper").fadeOut("fast")}),e.helper.find(".vbs-transcript-block").on(t,".vbs-discard-edition-btn",function(s){s.preventDefault(),e.helper.find(".vbs-edit-mode-prewrapper").html(e.templates.parse("vbs-edit-trans-mode",{ourtranscript:e.helper.editTranscriptText()}))}),e.helper.find(".vbs-transcript-block").on(t,".vbs-save-edition-btn",function(s){s.preventDefault(),e.helper.saveTranscript()}),s(".vbs-section-btns").on(t,".vbs-print-btn",function(t){if(t.preventDefault(),"undefined"!=typeof e.settings.webHooks.print)return e.settings.webHooks.print(),!1;var a=window.open("","","height="+screen.availHeight+",width="+screen.availWidth+",left=0,top=0");a.document.write("<html><head><title></title>"),a.document.write("</head><body >");var r=s(".vbs-transcript-wrapper").clone();r.find(".vbs-trans-info").remove(),a.document.write(r.html()),a.document.write("</body></html>"),a.document.close(),a.focus(),a.print(),a.close()}),s(".vbs-transcript-block").on(t,".vbs-order-human-trans a",function(t){var a=s(t.target).parents(".vbs-order-human-trans"),r=a.hasClass("vbs-human-ordered");if("undefined"!=typeof e.settings.webHooks.orderTranscript&&!r){var n=(e.data.duration/60).toFixed(2);return e.settings.webHooks.orderTranscript({$orderButton:a,apiUrl:e.settings.apiUrl,version:e.settings.version,apiKey:e.settings.apiKey,password:e.settings.password,mediaId:e.settings.mediaId,mediaUrl:e.api.response.metadata.response.streamUrl,recordName:e.api.response.metadata.response.title,mediaLengthInMinutes:n}),!1}return r?!1:void 0}),e.settings.toggleBlocks&&e.settings.toggleNewsBlock&&e.helper.find(".vbs-news-block .vbs-section-title").on(t,function(t){t.preventDefault();var a=s(this);a.toggleClass("vbs-hidden");a.parents(".vbs-news-block").find(".vbs-section-body");a.hasClass("vbs-hidden")?e.helper.collapseNewsBlock():(e.helper.expandNewsBlock(),e.api.getNews())}),e.settings.toggleBlocks&&e.settings.togglePredictionsBlock&&e.helper.find(".vbs-predictions-block  .vbs-section-title").on(t,function(e){e.preventDefault();var t=s(this);t.toggleClass("vbs-hidden"),t.hasClass("vbs-hidden")?(t.attr("data-title","Show Predictions"),t.parents(".vbs-predictions-block").find(".vbs-section-body").slideUp()):(t.attr("data-title","Hide Predictions"),t.parents(".vbs-predictions-block").find(".vbs-section-body").slideDown())}),s(document).off(t,".vbs-reload-overlay,.vbs-white-popup-overlay").on(t,".vbs-reload-overlay,.vbs-white-popup-overlay",function(t){t.preventDefault();var a=s(this);if(a.hasClass("vbs-white-popup-overlay")&&e.settings.tabView)return!1;a.fadeOut("fast",function(){a.remove()});var r=s(t.target);r.hasClass("vbs-reload-btn")&&location.reload()}),(e.settings.contextMenu||e.settings.editKeywords)&&(e.helper.find(".vbs-record-timeline-wrap").on("contextmenu taphold",function(s){e.common.vbmenus(s,"timeline",this)}),e.helper.find(".vbs-keywords-wrapper").on("contextmenu taphold",".vbs-keywords-list-wrapper li a",function(s){e.common.vbmenus(s,"keyword",this)}),e.helper.find(".vbs-transcript-prewrapper").on("contextmenu taphold",".vbs-transcript-wrapper span.w",function(s){e.common.vbmenus(s,"transcript",this)}),s(document).off("click.vbs_vbcmenu").on("click.vbs_vbcmenu",function(e){1===e.which&&s("ul.vbs-vbcmenu").css({top:"-5000px"})})),e.helper.find(".vbs-transcript-block").on("contextmenu taphold",".vbs-edition-block span.vbs-wd",function(s){s.preventDefault(),e.common.vbEditMenu(s,this)}),s(document).off("keydown",".vbs-edition-block").on("keydown",".vbs-edition-block",function(e){13==e.keyCode&&document.execCommand("insertHTML",!1,"<br>")}),s(document).off(t,".vbsc-edit-play").on(t,".vbsc-edit-play",function(t){t.preventDefault();var a=s(this).attr("data-time");e.PlayerApi.seek(a)}),s(document).off(t,".vbsc-edit-speaker").on(t,".vbsc-edit-speaker",function(t){t.preventDefault(),e.speakers.createInsertSpeakerDialog(s(this))}),s(document).off(t,".vbs-select-insert-speaker").on(t,".vbs-select-insert-speaker",function(e){e.preventDefault(),a(s(this))}),s(document).off(t,".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li").on(t,".vbs-select-insert-speaker-wrapper .vbs-select-dropdown li",function(t){t.preventDefault(),e.speakers.selectSpeakerInInsertDialog(s(this))}),s(document).off(t,".vbs-insert-speaker-popup .vbs-cancel-btn").on(t,".vbs-insert-speaker-popup .vbs-cancel-btn",function(t){t.preventDefault(),e.common.hidePopup(s(".vbs-insert-speaker-popup"))}),s(document).off(t,".vbs-insert-speaker-popup .vbs-confirm-btn").on(t,".vbs-insert-speaker-popup .vbs-confirm-btn",function(t){t.preventDefault();var a=s(".vbs-insert-speaker-popup"),r=e.validator.validate(a);r&&(e.speakers.insertSpeakerToEditor(),e.common.hidePopup(a))}),s(document).off(t,".vbsc-rename-speaker").on(t,".vbsc-rename-speaker",function(t){t.preventDefault(),e.speakers.createRenameSpeakerDialog(s(this))}),s(document).off(t,".vbs-rename-speaker-popup .vbs-cancel-btn").on(t,".vbs-rename-speaker-popup .vbs-cancel-btn",function(t){t.preventDefault(),e.speakers.enableRenameAllSpeakersInEditor(),e.common.hidePopup(s(".vbs-rename-speaker-popup"))}),s(document).off(t,".vbs-rename-speaker-popup .vbs-confirm-btn").on(t,".vbs-rename-speaker-popup .vbs-confirm-btn",function(t){t.preventDefault();var a=s(".vbs-rename-speaker-popup"),r=e.validator.validate(a);r&&(e.speakers.renameSpeaker(),e.common.hidePopup(a))}),s(document).off("blur keyup paste",".vbs-edition-block").on("blur keyup paste",".vbs-edition-block",function(){var t=window.getSelection?window.getSelection():document.selection;if(t.focusNode&&t.focusNode.parentElement){var a=s(t.focusNode.parentElement);a.hasClass("vbs-edit-speaker")&&e.speakers.renameSpeakerFromEditor(a)}}),e.settings.debug&&s(document).off("keydown.vbs_keydown").on("keydown.vbs_keydown",function(s){var t=s.which||s.keyCode;71===t&&(s.metaKey||s.ctrlKey)&&s.altKey&&e.helper.debug()}),e.settings.tabView&&s(document).off(t,".vbs-tabs-links a").on(t,".vbs-tabs-links a",function(e){e.preventDefault();var t=s(this),a=t.attr("data-href");return t.hasClass("vbs-active")||(t.siblings().removeClass("vbs-active"),t.addClass("vbs-active")),s(".vbs-tab").each(function(){s(this).removeClass("vbs-tab-visible")}),s(a).addClass("vbs-tab-visible"),!1}),s(document).off(t,".vbs-selected-playlist-item").on(t,".vbs-selected-playlist-item",function(t){t.preventDefault();var a=s(this).parents(".vbs-playlist");if(a.toggleClass("collapsed"),!a.hasClass("collapsed")){var r=e.PlayerApi.getPlaylistItemIndex(),n=a.find("[data-playlist-item-index="+r+"]");a.animate({scrollTop:n.offset().top-n.parent().offset().top})}}),s(document).off(t,".vbs-playlist-item").on(t,".vbs-playlist-item",function(t){t.preventDefault();var a=s(this).attr("data-playlist-item-index"),r=s(this).parents(".vbs-playlist");r.addClass("collapsed"),e.PlayerApi.setPlaylistItem(a)}),s(document).off(t,".vbs-cancel-search").on(t,".vbs-cancel-search",function(s){s.preventDefault(),e.data.searchWorker&&e.data.searchWorker.terminate(),e.helper.clearMessage(),e.helper.hideLoader(),e.data.clicker=!1,e.PlayerApi.play()})}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.helper={isRand:!1,randConstant:null,css:"",randId:function(){return this.isRand||this.randConstant||(this.isRand=!0,this.randConstant=this.rand()),this.randConstant},rand:function(){return Math.ceil(1e9*Math.random())},loadCss:function(e){if(-1==this.css.indexOf("["+e+"]")){this.css+="["+e+"]";var s=document.createElement("link");s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",e),"undefined"!=typeof s&&document.getElementsByTagName("head")[0].appendChild(s)}},find:function(t){return s("."+e.data.vclass+" "+t)},findc:function(t){return s("."+e.data.vclass+t)
},showLoader:function(){var s=e.helper.find(".vbs-record-timeline-wrap");e.settings.animation&&s.has(".vbs-loader")&&s.prepend('<div class="vbs-loader"></div>')},hideLoader:function(){e.helper.find(".vbs-record-timeline-wrap .vbs-loader").fadeOut("fast",function(){s(this).remove()})},removeBold:function(){e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a.bold").removeClass("bold")},termFor:function(e,s){var t=e.split(","),a=[];for(var r in t)t[r].match(/\s+/g)?a.push('"'+t[r]+'"'):a.push(t[r]);return"undefined"!=typeof s&&"url"==s?a.join(" "):a},parseTime:function(e){var s=Math.floor(e/3600)+"",t=Math.floor(e%3600/60)+"",a=Math.floor(e%3600%60)+"";return s.padLeft(2)+":"+t.padLeft(2)+":"+a.padLeft(2)},getSearchWordsArray:function(){var s=e.helper.find("#vbs-voice_search_txt").val().trim();return s=e.helper.matchWords(s),s=s?s:[]},matchWords:function(s){return s=e.helper.checkQuotes(s),s=s.replace(/""/g,'"'),s.match(/("[^"]+")+|[\S]+/gi)},checkQuotes:function(e){for(var s=[],t=!1,a=-1;!t;)a=e.indexOf('"',a+1),-1!==a?s.push(a):t=!0;if(s.length%2!==0)if(1===s.length)e+='"';else if(s.length>=3){var r=s[s.length-2],n=e.substring(0,r+1),i=e.substring(r+1);e=n+' "'+i}return e},selectTopic:function(t){if(t.hasClass("vbs-active")||t.hasClass("vbs-disabled"))return!1;t.parent().find(".vbs-active").removeClass("vbs-active"),t.addClass("vbs-active");var a=t.find("a"),r=a.text().trim();e.helper.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),e.helper.find('.vbs-keywords-list-tab ul[tid="'+r+'"]').addClass("vbs-active"),"topics"==e.settings.keywordsColumns&&e.helper.keywordsAutoTopicsColumns(),e.settings.editKeywords&&s(".vbs-topic-delete-popup").fadeOut("fast",function(){s(this).remove()}),e.speakers.filterSpeakersList(a.attr("speakers").split(","))},keywordsAutoTopicsColumns:function(t){t="undefined"!=typeof t?t:5;var a=e.helper.find(".vbs-keywords-list-wrapper"),r=this;return 0===t?!1:(a.removeClass(r.getColumnClassByNumber(t+1)).addClass(r.getColumnClassByNumber(t)),a.find("ul.vbs-active li").each(function(){return s(this).height()>18?(r.keywordsAutoTopicsColumns(t-1),!1):void 0}),void 0)},keywordsAutoColumns:function(t){t="undefined"!=typeof t?t:5;var a=e.helper.find(".vbs-keywords-list-wrapper"),r=this;return 0===t?(a.removeClass("vbs-auto-columns"),!1):(a.addClass("vbs-auto-columns"),a.removeClass(this.getColumnClassByNumber(t+1)).addClass(this.getColumnClassByNumber(t)),a.find("ul li").each(function(){return s(this).height()>18?(r.keywordsAutoColumns(t-1),!1):void 0}),a.removeClass("vbs-auto-columns"),void 0)},getColumnClassByNumber:function(e){switch(e){case 1:return"vbs-one-col";case 2:return"vbs-two-col";case 3:return"vbs-three-col";case 4:return"vbs-four-col";case 5:return"vbs-five-col";default:return""}},filterKeywords:function(t){e.settings.filterSpeaker=t;var a=e.helper.find(".vbs-topics .vbs-topics-list li");a.removeClass("vbs-disabled"),a.find("a").each(function(){var e=s(this);"all"==t||(e.is('[speakers*="'+t+'"]')||e.parent().addClass("vbs-disabled"),e.attr("t",e.attr("data-spt-"+t)))}),e.helper.find(".vbs-keywords-list-wrapper .vbs-keywords-list-tab li a").each(function(){var a=s(this);if(a.parent().removeClass("key"),"all"==t){a.parent().addClass("key").show();var r=[];for(var n in e.data.speakers)"undefined"!=typeof a.attr("data-spt-"+n)&&r.push(a.attr("data-spt-"+n));a.attr("t",r.join())}else a.is('[speakers*="'+t+'"]')?a.parent().addClass("key").show():a.parent().hide(),a.attr("t",a.attr("data-spt-"+t))});var r=e.helper.find(".vbs-topics .vbs-topics-list li.vbs-active");if(r.is(":hidden")){var n=e.helper.find(".vbs-topics-list li.vbs-all-topics");n.parent().find(".vbs-active").removeClass("vbs-active"),n.addClass("vbs-active");var i=n.find("a").text().trim();e.helper.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),e.helper.find('.vbs-keywords-list-tab ul[tid="'+i+'"]').addClass("vbs-active")}e.helper.find("#vbs-voice_search_txt").val().trim().length>0&&(e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive"),e.api.getSearch([e.helper.find("#vbs-voice_search_txt").val().trim()],!1)),e.settings.keywordsCounter&&e.helper.find(".vbs-keywords-list-tab li a").each(function(){var e=s(this),t=e.attr("t");e.parent().find("span").html("("+t.split(",").length+")")})},setUtterance:function(t){for(var a="",r="",n=t.length,i=0;n>i;i++){for(var o=t[i],l=o.segments,d=l.length,p=0;d>p;p++){var c=l[p],v=e.PlayerApi.getOffset(c.s),b=e.PlayerApi.getOffset(c.e),u=b-v,m=e.helper.parseTime(c.s)+" to "+e.helper.parseTime(c.e),f=65,h=c.u.substr(0,f-3)+"...";a+=e.templates.parse("utteranceMarker",{startTime:c.s,rownum:i+1,width:u,position:v,title:h,time:m})}r+=e.templates.parse("utteranceCheckBox",{rownum:i+1,title:o.name,segmentsCount:l.length})}if(e.helper.find(".vbs-utterance-markers").empty().append(a),r){var g=e.templates.get("utteranceBlock");s("#"+e.settings.controlsBlock).after(s(g)),s(".vbs-utterance-block").addClass(e.data.vclass).find("ul").append(r)}},downloadFile:function(s){var t=e.api.parameters;t.action="getTranscript",t.content=!0,t.format=s;var a=e.settings.apiUrl+"?"+e.common.getStringFromObject(t);window.location=a},getNewUrl:function(s){var t=window.location.search.substring(1),a=t.split("&"),r={},n=[];if(t.length>0)for(var i=a.length,o=0;i>o;o++){var l=a[o].split("=");if("vbt"!=l[0]&&"vbs"!=l[0]){r[l[0]]=l[1];for(var d in s)decodeURIComponent(l[0])==d&&(r[l[0]]=s[d])}}for(var p in e.settings.shareParams)"undefined"==typeof r[p]&&(r[p]=e.settings.shareParams[p]);for(var c in s)"undefined"==typeof r[c]&&(r[c]=s[c]);for(var v in r)n.push(v+"="+r[v]);return e.settings.shareUrl?e.settings.shareUrl+"?"+n.join("&"):window.location.origin+window.location.pathname+"?"+n.join("&")},checkAutoStart:function(){for(var s=window.location.search.substring(1),t=["vbt","vbs"],a=s.split("&"),r={},n=a.length,i=0;n>i;i++){var o=a[i].split("=");for(var l in t)decodeURIComponent(o[0])==t[l]&&(r[t[l]]=o[1])}return e.data.startParams=r,!1},waitReady:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearInterval(e.data.waiter),e.data.waiter=null,e.helper.checkErrors(),e.speakers.speakersWidget(),Object.keys(e.data.speakers).length>1&&e.speakers.speakerFilterWidget(e.data.speakers,"all"),e.comments.commentsTWidget(),e.settings.editKeywords&&s(".vbs-keywords-block .vbs-topics").addClass("vbs-edit-topics"),s(".vbs-media-block").hasClass(".less-600px")||s(".vbs-record-player .vbs-time-name-wrapper-narrow").css({opacity:0}),"jwplayer"===e.settings.playerType&&null!==e.api.response.metadata&&!e.settings.hasPlaylist)if(e.helper.isApi2_0()&&e.settings.stream){var t=e.settings.apiUrl+e.settings.mediaId+"/streams/original?"+e.settings.token;e.PlayerApi.loadFile(t)}else if("html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream){var a=e.api.response.metadata.response.rtmpUrl+""+e.api.response.metadata.response.rtmpFile;e.PlayerApi.loadFile(a)}else("http"===e.settings.stream||e.settings.stream===!0)&&e.PlayerApi.loadFile(e.api.response.metadata.response.streamUrl);e.data.startParams!==!1&&this.autoStart(e.data.startParams),e.api.response.keywords&&e.api.response.keywords.utterances&&e.helper.setUtterance(e.api.response.keywords.utterances),e.view.checkEmptyHeadersForTabs(),e.view.tooltips(),e.methods.ready()}return!1},waitReadyAfterSave:function(){if(e.api.ready.keywords&&e.api.ready.metadata&&e.api.ready.transcript&&e.api.ready.comments){if(clearTimeout(e.data.waiterSave),e.data.waiterSave=null,e.settings.modalSave){var t=e.helper.find(".vbs-save-popup-wrapper");t.find(".vbs-save-loading-popup").fadeOut("fast"),t.find(".vbs-save-done-popup").fadeIn("fast")}else e.helper.clearSavingMessages(),s("#"+e.settings.controlsBlock).after(e.templates.get("successSavingMessage")),setTimeout(function(){e.helper.clearSavingMessages()},3e3);setTimeout(function(){e.settings.modalSave&&e.helper.exitEditFullscreen(),e.helper.checkErrors(),e.speakers.speakersWidget(),e.comments.commentsTWidget(),e.view.tooltips()},800)}return!1},exitEditFullscreen:function(){s("#"+e.settings.transcriptBlock).appendTo("#transcript_placement").unwrap(),e.helper.find(".vbs-edit-mode-prewrapper").html(""),s("body").removeClass("vbs-no-scroll")},autoStart:function(s){var t;if("undefined"!=typeof s.vbs){e.helper.find(".vbs-markers").html(""),e.helper.find(".vbs-next-action-btn:not([class='vbs-next-notactive'])").addClass("vbs-next-notactive");var a=decodeURI(s.vbs).trim();a=e.helper.matchWords(a),a=a?a:[];var r=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(r).data("data-val",r).change(),a.length&&e.view.searchWordWidget(a);var n=!0;return"undefined"!=typeof s.vbt&&(n=!1,t=s.vbt,e.PlayerApi.seek(t)),e.api.getSearch(a,n),!1}"undefined"!=typeof s.vbt&&(t=s.vbt,e.PlayerApi.seek(t))},moveToNextMarker:function(t){var a=!0,r=[],n=t.find("a");n.each(function(){r.push(parseFloat(s(this).attr("stime")))}),r.sort(function(e,s){return parseInt(e,10)-parseInt(s,10)});for(var i in r)if(r[i]>e.PlayerApi.getPosition()+1)return e.PlayerApi.seek(r[i]),a=!1,!1;a&&n.length&&e.PlayerApi.seek(r[0])},moveToPrevMarker:function(t){var a=!0,r=[],n=t.find("a");n.each(function(){r.push(parseFloat(s(this).attr("stime")))}),r.sort(function(e,s){return parseInt(s,10)-parseInt(e,10)});for(var i in r)if(r[i]<e.PlayerApi.getPosition()-1)return e.PlayerApi.seek(r[i]),a=!1,!1;a&&n.length&&e.PlayerApi.seek(r[0])},startScroll:function(){var t=e.helper.find("#vbs-search-string .vbs-marquee");if(t.is(":visible")){var a=t.find(".vbs-search-word-widget");a.stop(!0).css("left",0);var r=0;e.helper.find(".vbs-word").width(function(e,s){r+=s}),r>t.width()?(a.width(r),e.helper.scrollStringLeft()):a.width(s("#vbs-search-string").width())}},scrollStringLeft:function(){var s=e.helper.find(".vbs-word").length,t=1200*s,a=e.helper.find("#vbs-search-string .vbs-marquee"),r=a.find(".vbs-search-word-widget");r.animate({left:a.width()-r.width()},{duration:t,complete:function(){e.helper.scrollStringRight()}})},scrollStringRight:function(){var s=e.helper.find(".vbs-word").length,t=1200*s;e.helper.find("#vbs-search-string .vbs-marquee .vbs-search-word-widget").animate({left:"1"},{duration:t,complete:function(){e.helper.scrollStringLeft()}})},getMaxKeywordHeight:function(){var s=e.helper.find(".vbs-topics-list").height(),t=e.helper.find(".vbs-keywords-list-tab ul.vbs-active").height()+10;return s>t?s:t},getKeywordHeight:function(){var e=s(".vbs-topics").height(),t=s(".vbs-keywords-list-tab").height()+10;return e>t?e:t},checkKeyword:function(t,a,r){e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word a.vbs-add-search-word").remove(),t=e.common.uniqueArray(t);for(var n in t){var i=e.helper.replaceTrimAndLower(t[n]);if(!e.common.findTermInArray(e.data.keywords,i)){var o=[];for(var l in r)r[l].term==i&&r[l].hits.map(function(e){o=o.concat(e.time)});if(o.length>0){var d=s('<a href="#add" class="vbs-add-search-word" title="Add to all topics"></a>');d.data("data-kwa",t[n]),d.data("data-kwt",o.join(",")),e.helper.find("#vbs-search-string .vbs-search-word-widget .vbs-word").each(function(){var e=s(this).find(".vbs-search_word").text();e===t[n]&&s(this).append(d)})}}}},localSearch:function(t,a){if(a.length>1)return e.api.getSearch(a),!1;var r=[],n=[];e.helper.find(".vbs-widget .vbs-word").each(function(e,t){var a=s(t),r=a.find(".vbs-search_word").text().replace(/"/g,"").toLowerCase();n[r]=a.find(".vbs-marker").css("border-bottom-color")});var i=[],o=t.attr("t").split(","),l=[];o.map(function(s){e.speakers.filterResultForSpeaker(s)&&(i=i.concat(s),l=l.concat(e.helper.getPhraseByTime(s-1e3,s+1500,a)))});var d=e.helper.find(".vbs-record-timeline-wrap");e.data.markersStyles={markersWrapper:d,markersContainer:d.find(".vbs-markers"),markersWrapperWidth:d.width()};var p=e.view.markerWidget(i,l,n[a]);e.data.markersStyles.markersContainer.append(p),r=r.concat(i),r.sort(function(e,s){return e-s}),e.PlayerApi.seek(r[0])},getPhraseByTime:function(s,t,a){var r="",n=e.helper.find(".vbs-transcript-wrapper > span > span:wordtime("+1e3*s+","+1e3*t+")");if(r=e.helper.getTextFromElems(n),"undefined"!=typeof Fuse){var i=r.split(" "),o=a.split(" ").length,l=[];if(o>1)for(var d=0;d<i.length;d++){for(var p="",c=0;o>c;c++)i[d+c]&&(p+=i[d+c]+" ");l.push(p.trim())}else l=i;var v=new Fuse(l,{threshold:.4}),b=v.search(a),u=b.length>0?b[0]:null;if(null!==u){r="";for(var m=0;m<l.length;m++){var f=l[m];f=f.split(" ")[0],m>=u&&u+o-1>=m&&(f="<b>"+f+"</b>"),r+=f+" "}}}return r},getTextFromElems:function(t){var a="";return t.each(function(){if(!s(this).attr("m")){var t=s(this).text();t=e.helper.replaceAndTrim(t),""===t||t.match(/\w+/g)?""!==t&&(a+=""===a?t:" "+t):a+=t}}),a},highlight:function(t){var a=Math.round(t);1==a&&(a=0);var r=Math.floor(a/e.settings.transcriptHighlight);a=r*e.settings.transcriptHighlight;var n=e.helper.find(".vbs-transcript-block"),i=n.find(".vbs-transcript-wrapper"),o=n.find(".vbs-transcript-prewrapper");i.children("span").removeClass("vbs-hl"),i.children("span:wordtime("+a+","+(a+e.settings.transcriptHighlight-1)+")").addClass("vbs-hl");var l=i.children("span.vbs-hl").length?i.children("span.vbs-hl"):!1,d=o.length?o:!1;l&&d&&o.not(".vbs-t-hover").stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500),s("body").hasClass("vbs-readermode")&&o.not(".vbs-t-hover").length&&(d=n.length?n:!1,l&&d&&n.stop(!0,!0).animate({scrollTop:l.offset().top-d.offset().top+d.scrollTop()-(d.height()-20)/2},500))},manageHighlightSnippets:function(t){for(var a=e.data.highlightSnippets,r=e.helper.find(".vbs-transcript-wrapper"),n=0;n<a.length;n++){var i=a[n],o=r.find(".vbs-trans-word:wordtime("+1e3*i.startTime+","+1e3*i.endTime+")");o.each(function(){var e=t?i.color:"";s(this).css("background-color",e)})}},track:function(s,t){if(t="undefined"!=typeof t?t:!1,"undefined"!=typeof ga&&e.settings.trackEvents)switch(s){case"play":return ga("send","event",e.settings.mediaId,"Play",e.PlayerApi.getPosition()),!0;case"pause":return ga("send","event",e.settings.mediaId,"Pause",e.PlayerApi.getPosition()),!0;case"seek":return ga("send","event",e.settings.mediaId,"Seek",t),!0;case"keyword":return ga("send","event",e.settings.mediaId,"Keyword",t),!0;case"transcript":return ga("send","event",e.settings.mediaId,"Transcript",t),!0;default:return!1}return!1},editTranscriptText:function(){for(var s=e.api.response.transcript.transcript,t="",a=0,r=0,n=s.length,i=0;n>i;i++){var o=s[i];0===i&&(t+='<span t="0">');for(var l=2;10>=l;l++)Math.floor(o.s/1e3)>=r+e.settings.transcriptHighlight*l&&(r+=e.settings.transcriptHighlight*l,t+='<span t="'+r+'"></span>');Math.floor(o.s/1e3)>=r+e.settings.transcriptHighlight&&(r+=e.settings.transcriptHighlight,t+='</span><span t="'+r+'">'),a+=o.s;var d=e.speakers.createSpeakerAttr(o),p=e.helper.replaceN(o.w);t+=o.w.match(/\w+/g)?'<span class="w vbs-wd '+(d.length?"vbs-edit-speaker":"")+'" t="'+o.s+'" '+d+"> "+p+"</span>":'<span class="vbs-wd" t="'+o.s+'" '+d+">"+p+"</span>"}return t+="</span>"},isTurn:function(e){return"undefined"!=typeof e&&"turn"==e},getClearWordFromTranscript:function(s){return e.helper.replaceAndTrim(s).replace(/:$/,"")},showSaveQuestion:function(){var t=s(".vbs-edit-speaker").length,a=e.helper.find(".vbs-edition-block").find('.w:not(".vbs-edit-speaker")').length,r=s(".vbs-transcript-prewrapper").find(".w").length-t,n=s(".vbs-save-popup");n.removeClass("vbs-long-edit vbs-short-edit"),a>r&&a>r/5?n.addClass("vbs-long-edit"):r>a&&r/5>a&&n.addClass("vbs-short-edit"),e.helper.find(".vbs-save-popup-wrapper").fadeIn("fast")},saveTranscript:function(){var s=e.helper.find(".vbs-edition-block").html();s=s.replace(/<br\s*[\/]?>/gi,"\n"),s=s.replace(/\\n/,"\n");var t=document.createElement("div");t.innerHTML=s;var a=t.textContent||t.innerText||"";e.api.saveTrancript(a.trim());var r=e.helper.find(".vbs-save-popup-wrapper");e.settings.modalSave?(r.find(".vbs-save-popup").fadeOut("fast"),r.find(".vbs-save-loading-popup").fadeIn("fast")):(r.fadeOut("fast"),e.helper.exitEditFullscreen())},saveTranscriptComplete:function(){e.helper.setIsSaving(!1),e.view.initAfterSaveTranscript(),e.data.waiterSave=setInterval(function(){e.data.waiterSave&&e.helper.waitReadyAfterSave()},100)},saveTranscriptError:function(t){if(e.helper.setIsSaving(!1),e.settings.modalSave){var a=e.helper.find(".vbs-save-popup-wrapper");a.find(".vbs-save-popup").show(),a.find(".vbs-save-loading-popup").fadeOut("fast"),a.fadeOut("fast");var r=e.templates.parse("abstractErrorPopup",{errorTitle:"Could not save transcript",errorText:t});s(".vbsp-"+e.helper.randId()+".vbs-content").append(r)}else{e.helper.clearSavingMessages();var n=e.templates.parse("textErrorMessage",{errorText:t});s("#"+e.settings.controlsBlock).after(n)}},setIsSaving:function(t){e.data.isSaving=t,e.settings.modalSave||(t?(s(".vbs-edit-btn").addClass("vbs-disable-button"),e.helper.clearSavingMessages(),s("#"+e.settings.controlsBlock).after(e.templates.get("savingMessage"))):s(".vbs-edit-btn").removeClass("vbs-disable-button"))},clearSavingMessages:function(){s(".vbs-saving").remove(),s(".vbs-success-saving").remove(),s(".vbs-text-error-message").remove()},getIsSaving:function(){return e.data.isSaving},adjustMediaTime:function(){var s=e.helper.find(".vbs-media-block"),t=s.find(".vbs-section-title"),a=s.find(".vbs-section-btns"),r=t.offset().left+t.width(),n=a.offset().left;if(r>=n&&(t.find(".vbs-voice-name").hide(),t=s.find(".vbs-section-title"),a=s.find(".vbs-section-btns"),r=t.offset().left+t.width(),n=a.offset().left,r>=n&&(t.find(".vbs-time").hide(),s.hasClass("vbs-video")))){var i=e.helper.parseTime(e.data.duration);e.helper.findc(".vbs-player-wrapper").append('<span class="vbs-time vbs-time-in-player"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">'+i+"</span></span>")}},checkErrors:function(){if(e.settings.modalErrors){var t=s(".vbsp-"+e.helper.randId()+".vbs-content");if(e.api.errors.processing)t.append(e.templates.get("reloadOverlayCredentials"));else if(e.api.errors.failure){e.settings.tabView?t.append(e.templates.parse("abstractAlertPopup",{errorTitle:"File has not finishing processing yet",errorText:"Search, keywords, and transcript for this file are not available. If reloading does not solve the problem, please contact support for assistance."})):t.append(e.templates.get("errorPopup"));var a=t.find(".vbs-big-error-popup"),r=parseInt(a.css("height"));a.css("marginTop",-r/2)}}else if(e.api.errors.processing||e.api.errors.failure){var n="File not indexed. Search, Keywords & Transcript are unavailable for this recording.";e.api.errors.processing&&(n="Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance");var i=e.templates.parse("textErrorMessage",{errorText:n});s("#"+e.settings.controlsBlock).after(i)}},debug:function(){var s="inited";"rtmp"==e.settings.stream?s=e.api.response.metadata.response.rtmpUrl+e.api.response.metadata.response.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(s=e.api.response.metadata.response.streamUrl);var t={type:e.settings.playerType,mode:e.PlayerApi.getRenderingMode(),inited:e.instances.length,isStream:e.settings.stream,streamUrl:s,mediaID:e.settings.mediaId?e.settings.mediaId:e.settings.externalId,statusMetaData:e.api.response.metadata&&e.api.response.metadata.requestStatus?e.api.response.metadata.requestStatus:!1,statusKeyword:e.api.response.keywords&&e.api.response.keywords.requestStatus?e.api.response.keywords.requestStatus:!1,statusTranscript:e.api.response.transcript&&e.api.response.transcript.requestStatus?e.api.response.transcript.requestStatus:!1,statusTranscriptFileStatus:e.api.response.transcript&&e.api.response.transcript.fileStatus?e.api.response.transcript.fileStatus:!1,statusComments:e.api.response.comments&&e.api.response.comments.requestStatus?e.api.response.comments.requestStatus:!1,browserAppVersion:navigator.appVersion,browserUserAgent:navigator.userAgent,browserPlatform:navigator.platform,browserUserLanguage:navigator.userLanguage,url:window.location.href};"undefined"!=typeof _LTracker&&_LTracker.push(t);var a=e.helper.find(".vbs-logger");if(a.length>0)a.remove();else{e.helper.find(".vbs-record-player").after(e.templates.parse("loggerBlock",{response:JSON.stringify(t)}));var r=e.helper.find(".vbs-logger textarea");r.bind("focus",function(){this.select()})}console.log(t)},replaceAndTrim:function(e){return e.replace(/<br\s*[\/]?>/gi,"").replace(/\n/gi,"").trim()},replaceN:function(e){return e.replace(/\\n/g,"<br>").replace(/\n/g,"<br>")},replaceTrimAndLower:function(e){return e.replace(/"/g,"").toLowerCase().trim()},collapseNewsBlock:function(){var t=s("#"+e.settings.newsBlock);if(t.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=t.find(".vbs-section-body");t.find(".vbs-section-title").addClass("vbs-hidden").attr("data-title","Show News"),t.find(".vbs-news-words-wrapper").hide(),a.slideUp()}},expandNewsBlock:function(){var t=s("#"+e.settings.newsBlock);if(t.length>0&&e.settings.toggleBlocks&&e.settings.toggleNewsBlock){var a=t.find(".vbs-section-body");t.find(".vbs-section-title").removeClass("vbs-hidden").attr("data-title","Hide News"),t.find(".vbs-news-words-wrapper").show(),a.slideDown()}},updateQuotesVisibility:function(){if(e.settings.vbsButtons.unquotes){var s=e.helper.find(".vbs-search-form"),t=e.helper.getSearchWordsArray(),a=t.filter(function(e){return 0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1});a.length>0?s.addClass("vbs-quoted"):s.removeClass("vbs-quoted")}},removeQuotes:function(){var t=e.helper.getSearchWordsArray(),a=[];t.forEach(function(e){if(0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1){e=e.replace(/"/g,"");var s=e.split(" ");s.forEach(function(e){a.push(e)})}else a.push(e)});var r=a.join(" ");e.helper.find("#vbs-voice_search_txt").val(r).data("data-val",r),s("#vbs-search-form").submit()},setOrderedButton:function(t){t=t.replace(/-/g,"/");var a=new Date(t),r=e.data.months[a.getMonth()],n=a.getDate().toString();1===n.length&&(n="0"+n);var i=s(".vbs-order-human-trans");i.addClass("vbs-human-ordered").removeAttr("data-title"),i.find("a").attr("href","#").text("Transcript due "+r+" "+n)},clearIntervals:function(){clearInterval(e.data.waiterSave),e.data.waiterSave=null,e.instances.length>0&&e.instances[e.current_instance]&&e.instances[e.current_instance].player&&(clearInterval(e.instances[e.current_instance].player.find_player_interval),e.instances[e.current_instance].player.find_player_interval=null),clearInterval(e.events.time),e.events.time=null,clearInterval(e.data.waiter),e.data.waiter=null,clearInterval(e.data.metadataWaiter),e.data.metadataWaiter=null},isIe:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")?parseInt(e.split("msie")[1]):!1},isRetina:function(){var e="(-webkit-min-device-pixel-ratio: 1.5),            (min--moz-device-pixel-ratio: 1.5),            (-o-min-device-pixel-ratio: 3/2),            (min-resolution: 1.5dppx)";return window.devicePixelRatio>1?!0:window.matchMedia&&window.matchMedia(e).matches?!0:!1},isMobile:function(){if(e.data.isMobile)return e.data.isMobile;var s=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(s=!0)}(navigator.userAgent||navigator.vendor||window.opera),e.data.isMobile=s,s},is_iDevice:function(){var e=!1;return function(s){/ip(hone|od|ad)/i.test(s)&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},renderMobile:function(){s("body").addClass("vbs-mobile"),e.helper.isRetina()&&s("body").addClass("vbs-retina")},getMobileWidth:function(){var e=s(".vbs-content").width();return e},setOnTimeInterval:function(){e.events.time=setInterval(function(){e.events.time&&e.events.onTime()},250)},isMediaTypeEqualVideo:function(){var s=e.settings.mediaTypeOverride;if(s)return"video"===s;if(e.api.response){var t=e.api.response.metadata;return!(t&&t.response&&t.response.hasVideo===!1)}return!0},isApi2_0:function(){return"2.0"===e.settings.apiVersion},clearMessage:function(){e.settings.localSearch?(s(".vbs-message").remove(),s(".vbs-text-error-message").remove()):(s(".vbs-message").fadeOut(),s(".vbs-text-error-message").fadeOut())},showMessage:function(s,t){e.helper.clearMessage();var a=e.templates.parse("infoMessage",{errorText:s,mode:t});e.helper.appendMessage(a)},appendMessage:function(t){e.settings.searchBarOuter?s("#"+e.settings.searchBarBlock).before(t):s("#"+e.settings.keywordsBlock).before(t)},checkScrollForResize:function(e){var s=e.find(".vbs-transcript-wrapper");e.height()>s.height()?e.find(".ui-resizable-se,.ui-resizable-e").addClass("vbs-no-scroll"):e.find(".ui-resizable-se,.ui-resizable-e").removeClass("vbs-no-scroll")},setDeletedIdsInLocalStorage:function(){var s=e.helper.getDeletedIdsInLocalStorage();s.push(e.settings.mediaId),localStorage.setItem("vbs-deleted-ids",JSON.stringify(s))},getDeletedIdsInLocalStorage:function(){return JSON.parse(localStorage.getItem("vbs-deleted-ids"))||[]},clearUiForDeletedIds:function(){var t=e.helper.getDeletedIdsInLocalStorage(),a=t.filter(function(s){return s===e.settings.mediaId});a.length>0&&(s(".vbs-section-btns,.vbs-order-human-trans,.vbs-time").remove(),s(".vbs-record-player").hide(),e.helper.showMessage("No such media file!","error"),e.PlayerApi.destroy())},hasSpottedKeywordsInGroups:function(){for(var e=voiceBase.api.response.keywords,s=e.groups,t=!1,a=0;a<s.length;a++){var r=s[a];if(r.keywords.length>0){t=!0;break}}return t},showAutoGeneratedKeywords:function(){var s=e.helper.find(".vbs-keywords-wrapper");s.find(".vbs-keyword-message").remove();var t=s.find(".vbs-topics"),a=t.hasClass("vbs-no-visible-topics");t.removeClass("vbs-no-visible-topics").find(".vbs-hidden-topic").removeClass("vbs-hidden-topic"),a&&e.helper.selectTopic(t.find("li").first())},hideAutoGeneratedKeywords:function(){var s=e.helper.find(".vbs-keywords-wrapper"),t=s.find(".vbs-topics");t.find("li:not(.group)").addClass("vbs-hidden-topic"),t.find("li").removeClass("vbs-active");var a=t.find(".group");if(a.length>0)e.helper.selectTopic(a.first());else if(s.find(".vbs-keywords-list-tab ul").removeClass("vbs-active"),t.addClass("vbs-no-visible-topics"),0===s.find(".vbs-keyword-message").length){var r=e.templates.parse("infoMessage",{errorText:"None of the specified keywords or phrases were spotted for this media file",mode:"error"}),n='<div class="vbs-keyword-message">'+r+"</div>";s.prepend(n)}}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.methods={init:function(s){e.reSettings(s),e.init(e.settings.playerId),e.view.init(this)},ready:function(){e.settings.ready.apply(this)},favorite:function(s){return s?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-tile","Remove from Favorites"):e.helper.find(".vbs-star-btn").removeClass("vbs-active").attr("data-tile","Add from Favorites"),s},favoriteToggle:function(){var s=e.helper.find(".vbs-star-btn");return s.toggleClass("vbs-active"),s.hasClass("vbs-active")},isFavorite:function(){return e.helper.find(".vbs-star-btn").hasClass("vbs-active")},getPosition:function(){return Math.round(e.PlayerApi.getPosition())},getSearchString:function(){return e.helper.find("#vbs-voice_search_txt").val()},getSharePositionUrl:function(){var s={};return s.vbt=Math.round(e.PlayerApi.getPosition()),e.helper.getNewUrl(s)},getShareSearchStringUrl:function(){var s={};return s.vbs=encodeURI(e.helper.find("#vbs-voice_search_txt").val()),e.helper.getNewUrl(s)},getShareFlag:function(){return e.helper.find('.vbs-share-radio-row input[name="share-opt"]:checked').val()},search:function(s){return e.helper.find("#vbs-voice_search_txt").val(s),e.helper.find("#vbs-search-form").submit(),s},position:function(s){return e.PlayerApi.seek(s),s},destroy:function(){e.helper.clearIntervals(),e.PlayerApi.destroy(),s(this).remove(),s(".vbs-content").remove()},addCustomMarkers:function(s){e.data.customMarkers=s},showCustomMarkers:function(){e.view.showCustomMarkers()},hideCustomMarkers:function(){e.view.hideCustomMarkers()},nextCustomMarkers:function(){var s=e.helper.find(".vbs-custom-markers");e.helper.moveToNextMarker(s)},prevCustomMarkers:function(){var s=e.helper.find(".vbs-custom-markers");e.helper.moveToPrevMarker(s)},addHighlightTranscript:function(s){e.data.highlightSnippets=s},showHighlightTranscript:function(){e.helper.manageHighlightSnippets(!0)},hideHighlightTranscript:function(){e.helper.manageHighlightSnippets(!1)},hasSpottedKeywordsInGroups:function(){return e.helper.hasSpottedKeywordsInGroups()},showAutoGeneratedKeywords:function(){e.helper.showAutoGeneratedKeywords()},hideAutoGeneratedKeywords:function(){e.helper.hideAutoGeneratedKeywords()}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.Player=function(s,t){var a=this;a.instance=s;var r=e.settings.playerType;r=r.toLowerCase().replace(/^\s+|\s+$/,""),a.player_type=r,a.instance.player_ready=!1,a.find_player_interval=setInterval(function(){if(a.find_player_interval)try{a.interface=new e.interface[r](t,a.instance),clearInterval(a.find_player_interval),a.find_player_interval=null,e.helper.setOnTimeInterval()}catch(s){console.log(s)}},250)},e.interface={youtube:function(s,t){var a=this;if(a.instance=t,document.getElementById(s)&&"iframe"==document.getElementById(s).tagName.toLowerCase()){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"not_ready";if(!YT.loaded)throw"not_ready";if(a.instance.ytplayerloaded)return!1;a.youtube_player=new YT.Player(s),a.instance.ytplayerloaded=!0}else a.youtube_player=window.document[s];a.play=function(){a.youtube_player.playVideo()},a.pause=function(){a.youtube_player.pauseVideo()},a.play_state=function(){try{var e=a.youtube_player.getPlayerState();return 1==parseInt(e)||5==parseInt(e)?"PLAYING":"PAUSED"}catch(s){return"PAUSED"}},a.position=function(){try{return a.youtube_player.getCurrentTime()+.07}catch(e){return 0}},a.duration=function(){return a.youtube_player?parseInt(a.youtube_player.getDuration()+.5):!1},a.seek=function(e){e=parseInt(e,10),a.youtube_player.seekTo(e),a.play()},a.get_volume=function(){return a.youtube_player?a.youtube_player.getVolume():!1
},a.set_volume=function(e){a.youtube_player.setVolume(e)},a.get_buffer=function(){return a.youtube_player&&a.youtube_player.getVideoBytesLoaded?100*a.youtube_player.getVideoBytesLoaded()/a.youtube_player.getVideoBytesTotal():!1},a.destroy=function(){},window.onYouTubePlayerReady=function(){a.instance.player_ready||(a.instance.player_ready=!0,e.settings.localApp&&(YSP.api.init("ytplayer"),YSP.api.getLanguages(function(s){e.data.localData.languages=s.languages,e.view.initApi()})))}},jwplayer:function(t,a){var r=this;if(r.instance=a,"undefined"==typeof jwplayer||!jwplayer(t)||!jwplayer(t).play)throw"not_ready";r.jw_player=jwplayer(t),r.jw_player.onReady(function(){i()}),r.jw_player.onError(function(t){s(".vbs-text-error-message").remove();var a=t.message;"Error loading media: File could not be played"===a&&e.helper.is_iDevice()&&(a="This media file cannot be played on your current device and operating system. Please try on a different device or upgrade to a supported version of iOS 8.");var r=e.templates.parse("textErrorMessage",{errorText:a});s("#"+e.settings.controlsBlock).after(r)});var n=function(){r.play=function(){r.jw_player.play()},r.pause=function(){r.jw_player.pause()},r.play_state=function(){return"PLAYING"==r.jw_player.getState()?"PLAYING":"PAUSED"},r.position=function(){return r.jw_player.getPosition()},r.duration=function(){return r.jw_player.getDuration()},r.seek=function(e){r.jw_player.seek(e)},r.get_volume=function(){return r.jw_player.getVolume()},r.set_volume=function(e){return r.jw_player.setVolume(e)},r.get_buffer=function(){return r.jw_player.getBuffer()},r.get_rendering_mode=function(){return r.jw_player.getRenderingMode()},r.load_file=function(s){e.settings.hasPlaylist?r.jw_player.load(s):r.jw_player.load([{file:s}])},r.getWidth=function(){var e=r.jw_player.getWidth();if("100%"===e){var t=r.jw_player.getContainer();e=s(t).width()}return e},r.getHeight=function(){var e=r.jw_player.getHeight();if("100%"===e){var t=r.jw_player.getContainer();e=s(t).height()}return e},r.setSize=function(e,s){(null===e||"undefined"==typeof e)&&(e=r.jw_player.getWidth()),(null===s||"undefined"==typeof s)&&(s=r.jw_player.getHeight()),r.jw_player.resize(e,s)};var t=null;r.initPluginFromPlaylistItem=function(){var a=r.getCurrentPlaylistItem(),n=e.PlayerApi.getPlaylistItemId(a);if(n.id!==t){t=n.id,delete e.settings.mediaId,delete e.settings.externalId,e.helper.clearIntervals(),n.isMediaid?e.settings.mediaId=a.vbs_mediaid:e.settings.externalId=a.vbs_externalid,e.helper.setOnTimeInterval(),e.view.initApi();var i=r.jw_player.getPlaylistIndex();s(".vbs-playlist-item").removeClass("active"),s(".vbs-selected-playlist-item").find(".vbs-item-name").text(a.title);var o=s("[data-playlist-item-index="+i+"]");o.addClass("active"),o[0].scrollIntoView()}},r.setPlaylistItem=function(e){e=parseInt(e),r.jw_player.playlistItem(e)},r.getPlaylistItemIndex=function(){return r.jw_player.getPlaylistIndex()},r.onChangePlayListItem=function(){r.jw_player.onPlaylistItem(function(){r.initPluginFromPlaylistItem()})},r.getCurrentPlaylistItem=function(){return r.jw_player.getPlaylistItem()},r.getPlaylist=function(){return r.jw_player.getPlaylist()},r.renderPlaylist=function(){var t=r.getPlaylist();s("#"+e.settings.controlsBlock).before(e.templates.get("playlist"));var a="";t.forEach(function(s,t){a+=e.templates.parse("playlist-item",{title:s.title,index:t})}),s(".vbs-playlist-dropdown").append(a)},r.destroy=function(){r.jw_player.getRenderingMode()&&r.jw_player.remove()}},i=function(){if(r.instance.player_ready=!0,n(),e.helper.isMobile()){var t=e.PlayerApi.getMobilePlayerSize();r.setSize(t.mobile_width,t.mobile_height),s("#"+e.settings.mediaBlock).css("width",t.mobile_width)}e.settings.hasPlaylist&&(e.settings.nativePlaylist||r.renderPlaylist(),r.onChangePlayListItem())};n(),r.instance.player_ready=!0},kaltura:function(t,a){var r=this;if(r.instance=a,r.kaltura_player=s("#"+t).get(0),r.kaltura_states={buffered:0,bytes_total:0,player_state:!1,playhead_time:0,volume:1,ready:!1},window.bytesTotalChangeHandler=function(e){r.kaltura_states.bytes_total=e},window.html5_kaltura_play_handler=function(){console.log("Kaltura is PLAYING!"),r.kaltura_states.player_state=!0},window.html5_kaltura_pause_handler=function(){console.log("Kaltura is PAUSED!"),r.kaltura_states.player_state=!1},window.html5_kaltura_update_playhead=function(e){r.kaltura_states.playhead_time=parseFloat(e)},window.volumeChangedHandler=function(e){r.kaltura_states.volume=e.newVolume},window.bytesDownloadedChangeHandler=function(e){r.kaltura_states.buffered=e.newValue},window.playerSeekEndHandler=function(){r.play()},r.player_state=!1,r.playhead_time=0,r.player_id=t,r.play=function(){r.kaltura_player.sendNotification("doPlay")},r.pause=function(){r.kaltura_player.sendNotification("doPause")},r.play_state=function(){return r.kaltura_states.player_state?"PLAYING":"PAUSED"},r.position=function(){return r.kaltura_states.playhead_time},r.duration=function(){return r.kaltura_player.evaluate("{mediaProxy.entry.msDuration}")/1e3},r.video_id=function(){return r.kaltura_player.evaluate("{mediaProxy.entry.id}")},r.seek=function(e){r.kaltura_player.sendNotification("doPlay"),setTimeout(function(){r.kaltura_player.sendNotification("doSeek",parseFloat(parseInt(e)))},0)},r.play_file=function(e){if(e.video_id!=this.video_id()){var s=e.m||0;r.kaltura_player.sendNotification("changeMedia",{entryId:e.video_id,seekFromStart:s.toString()}),r.timer=setInterval(function(){return"PLAYING"==r.play_state()&&r.video_id()==e.video_id?(clearInterval(r.timer),!0):void r.play()},200)}else this.seek(e.m)},r.get_buffer=function(){return r.kaltura_states.bytes_total&&r.kaltura_states.buffered?100*r.kaltura_states.buffered/r.kaltura_states.bytes_total:0},r.get_volume=function(){return 100*r.kaltura_states.volume},r.set_volume=function(e){r.kaltura_player.sendNotification("changeVolume",e/100)},r.getPlayerIframe=function(){return s("#"+r.player_id+"_ifp").contents()},r.destroy=function(){},window.kdpReady=function(){if(r.kaltura_states.ready=!0,r.instance.player_ready=!0,console.log("Kaltura is ready!"),r.kaltura_player.addJsListener("volumeChanged","volumeChangedHandler"),r.kaltura_player.addJsListener("playerPlayed","html5_kaltura_play_handler"),r.kaltura_player.addJsListener("playerPaused","html5_kaltura_pause_handler"),r.kaltura_player.addJsListener("playerPlayEnd","html5_kaltura_pause_handler"),r.kaltura_player.addJsListener("playerUpdatePlayhead","html5_kaltura_update_playhead"),r.kaltura_player.addJsListener("bytesTotalChange","bytesTotalChangeHandler"),r.kaltura_player.addJsListener("bytesDownloadedChange","bytesDownloadedChangeHandler"),r.kaltura_player.addJsListener("playerSeekEnd","playerSeekEndHandler"),"OBJECT"==r.kaltura_player.tagName&&r.play(),e.settings.markersInNativeTimeline&&e.settings.cssPathForPlayerFrame){var s=document.createElement("link");s.href=e.settings.cssPathForPlayerFrame,s.rel="stylesheet",s.type="text/css";var t=r.getPlayerIframe();t[0].body.appendChild(s)}},window.jsCallbackReady=function(){},!r.kaltura_player||!r.kaltura_player.addJsListener)throw"not_ready";window.kdpReady()},flowplayer:function(t,a){var r=this;if(r.instance=a,"undefined"==typeof flowplayer)throw"not_ready";r.flow_player=s("#"+t);var n=flowplayer(r.flow_player);r.instance.player_ready=!0,r.play=function(){n.play()},r.pause=function(){return n.pause()},r.play_state=function(){var e=n.paused;return e?"PAUSED":"PLAYING"},r.position=function(){return n.video?n.video.time:0},r.duration=function(){return n.video?n.video.duration:0},r.seek=function(e){n.seek(e),r.play()},r.get_buffer=function(){return n.video?100*n.video.buffer/r.duration():0},r.flow_player.bind("volume",function(){var s=r.get_volume();e.PlayerApi.setUiVolume(s)}),r.get_volume=function(){return 100*n.volumeLevel},r.set_volume=function(e){n.volume(e/100)},r.destroy=function(){}},sublime:function(e,t){var a=this;if(a.instance=t,"undefined"==typeof sublime||"undefined"==typeof sublime.player)throw"not_ready";if("undefined"==typeof sublime.player(e))throw"not_ready";a.player_id=e,a.default_size={width:s("#"+a.player_id).width(),height:s("#"+a.player_id).height()},a.player_state=!1;var r=sublime.player(a.player_id);r.on({start:function(){a.player_state="PLAYING"},end:function(){a.player_state="PAUSED"},stop:function(){a.player_state="PAUSED"},pause:function(){a.player_state="PAUSED"},play:function(){a.player_state="PLAYING"}}),a.play=function(){r.play()},a.pause=function(){r.pause()},a.play_state=function(){return a.player_state},a.position=function(){return r.playbackTime()},a.duration=function(){return r.duration()},a.get_buffer=function(){return 0},a.seek=function(e){r.seekTo(e),a.play()},a.setSize=function(e,s){r.setSize(e,s)},a.setDefaultSize=function(){r.setSize(a.default_size.width,a.default_size.height)},a.destroy=function(){}},video_js:function(t,a){var r=this;if(r.instance=a,r.player_id=t,"undefined"==typeof videojs)throw"not_ready";var n=videojs(t);r.instance.player_ready=!0,r.play=function(){n.play()},r.pause=function(){n.pause()},r.play_state=function(){return n.paused()?"PAUSED":"PLAYING"},r.position=function(){return n.currentTime()},r.duration=function(){return n.duration()},r.seek=function(e){n.currentTime(e),r.play()},r.get_buffer=function(){return 100*n.bufferedPercent()||0},n.on("volumechange",function(){var s=r.get_volume();e.PlayerApi.setUiVolume(s)}),r.get_volume=function(){return 100*n.volume()},r.set_volume=function(e){n.volume(e/100)},r.destroy=function(){s("#"+r.player_id).length>0&&n.dispose()}},jplayer:function(t,a){var r=this;r.instance=a,r.player_id=t;var n=s("#"+r.player_id);r.default_size={width:s("#"+r.player_id).width(),height:s("#"+r.player_id).height()},r.play=function(){n.jPlayer("play")},r.pause=function(){n.jPlayer("pause")},r.play_state=function(){return n.data("jPlayer").status.paused?"PAUSED":"PLAYING"},r.position=function(){return n.data("jPlayer").status.currentTime||0},r.duration=function(){return n.data("jPlayer").status.duration||0},r.seek=function(e){e=parseInt(e),n.jPlayer("play",e)},r.get_buffer=function(){return 0},r.get_volume=function(){return 100*n.data("jPlayer").options.volume||0},r.set_volume=function(e){s("#jplayer").jPlayer("volume",e/100)},r.isVideo=function(){return n.data("jPlayer").status.video},r.getGui=function(){return s(n.data("jPlayer").ancestorJq)},r.initEvents=function(){n.bind(s.jPlayer.event.volumechange,function(){var s=r.get_volume();e.PlayerApi.setUiVolume(s)})},r.getWidth=function(){var e=n.jPlayer("option","size");return e.width},r.getHeight=function(){var e=n.jPlayer("option","size");return e.height},r.setSize=function(e,s){n.jPlayer({size:{width:e,height:s}})},r.setDefaultSize=function(){r.setSize(r.default_size.width,r.default_size.height)},r.destroy=function(){n.jPlayer("destroy")};var i=function(){r.instance.player_ready=!0;var e=r.getGui();r.isVideo()||e.hide(),r.initEvents()};i()}},e.PlayerApi={startPlayer:function(s){e.helper.showLoader(),window.setTimeout(function(){e.PlayerApi.cseek(s)},200),window.setTimeout(function(){e.data.movelistner=!1,e.data.dragging=!1},300)},cseek:function(s){e.instances[e.current_instance].player.interface.seek(s)},seek:function(s){e.PlayerApi.startPlayer(s)},play:function(){e.instances[e.current_instance].player.interface.play()},pause:function(){e.instances[e.current_instance].player.interface.pause()},getOffset:function(s){var t=e.helper.find(".vbs-record-timeline-wrap");return s*t.width()/e.data.duration},getDuration:function(){return e.instances[e.current_instance].player.interface.duration()},getPosition:function(){return e.instances[e.current_instance].player.interface.position()},getStatus:function(){return e.instances[e.current_instance].player.interface.play_state()},getVolume:function(){return e.instances[e.current_instance].player.interface.get_volume()},setVolume:function(s){return e.instances[e.current_instance].player.interface.set_volume(s)},setUiVolume:function(s){e.helper.find(".vbs-volume-slider-full").css("height",s+"%"),e.helper.find(".vbs-volume-slider-handler").css("bottom",s+"%")},getBuffer:function(){return e.instances[e.current_instance].player.interface.get_buffer()},getRenderingMode:function(){return e.instances[e.current_instance].player.interface.get_rendering_mode()},loadFile:function(s){return e.instances[e.current_instance].player.interface.load_file(s)},isPlayerReady:function(){return e.instances[e.current_instance].player_ready},getMobilePlayerSize:function(){var s=e.PlayerApi.getPlayerWidth(),t=e.PlayerApi.getPlayerHeight(),a=s&&t?s/t:0,r=e.helper.getMobileWidth(),n=r/a;return n=n>screen.availHeight?screen.availHeight:n,{mobile_width:r,mobile_height:n}},getPlayerWidth:function(){return e.instances[e.current_instance].player.interface.getWidth()},getPlayerHeight:function(){return e.instances[e.current_instance].player.interface.getHeight()},setSizePlayer:function(s,t){var a=e.instances[e.current_instance].player.interface;return a&&a.setSize?a.setSize(s,t):null},setDefaultSizePlayer:function(){return e.instances[e.current_instance].player.interface.setDefaultSize()},hidePlayer:function(){if("kaltura"!=e.settings.playerType)var t=setInterval(function(){e.instances.length&&(clearTimeout(t),e.helper.findc(".vbs-player-wrapper").css({height:0}),"jwplayer"===e.settings.playerType&&(e.PlayerApi.setSizePlayer(0,0),s("#"+e.settings.playerId).css({opacity:0})))},100)},setPlaylistItem:function(s){return e.instances[e.current_instance].player.interface.setPlaylistItem(s)},getPlaylistItemIndex:function(){return e.instances[e.current_instance].player.interface.getPlaylistItemIndex()},getPlaylist:function(){return e.instances[e.current_instance].player.interface.getPlaylist()},getCurrentPlaylistItem:function(){return e.instances[e.current_instance].player.interface.getCurrentPlaylistItem()},getPlaylistItemId:function(e){var s,t=!1;return e.vbs_mediaid?(s=e.vbs_mediaid,t=!0):e.vbs_externalid&&(s=e.vbs_externalid),{id:s,isMediaid:t}},getStreamUrl:function(s){var t="";return"html5"!=e.PlayerApi.getRenderingMode()&&"rtmp"==e.settings.stream?t=s.rtmpUrl+""+s.rtmpFile:("http"==e.settings.stream||e.settings.stream===!0)&&(t=s.streamUrl),t},getPlayerIframe:function(){return e.instances[e.current_instance].player.interface.getPlayerIframe()},destroy:function(){e.instances[e.current_instance]&&e.instances[e.current_instance].player&&e.instances[e.current_instance].player.interface&&e.instances[e.current_instance].player.interface.destroy&&e.instances[e.current_instance].player.interface.destroy()}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return jQuery.extend(jQuery.expr[":"],{speakertime:function(e,t,a){var r=parseFloat(s(e).attr("s")),n=parseFloat(s(e).attr("e")),i=a[3].split(/\s?,\s?/),o=parseFloat(i[0]);return!isNaN(r)&&!isNaN(n)&&!isNaN(o)&&n>=o&&o>=r}}),e.speakers={inSpeakers:function(s){for(var t in e.data.speakers)if(e.data.speakers[t].toLowerCase()==s.toLowerCase())return!0;return!1},getSpeakerNameByKey:function(s){return"undefined"!=typeof e.data.speakers[s]?e.data.speakers[s]:""},getSpeakerKeyByName:function(s){for(var t in e.data.speakers)if(e.data.speakers[t].toLowerCase()==s.toLowerCase())return t;return""},setSpeakerName:function(s,t){for(var a in e.data.speakers)if(a===s)return e.data.speakers[a]=t,!0;return!1},addSpeakerKey:function(s){if(s&&!e.speakers.inSpeakers(s)&&">>"!=s){var t=Object.keys(e.data.speakers).length+1;e.data.speakers["vbs-sp"+t+"o"]=s}},filterResultForSpeaker:function(s){if("undefined"==typeof e.settings.filterSpeaker||"all"==e.settings.filterSpeaker)return!0;for(var t in e.data.allSpeakers)if(1e3*s>parseFloat(e.data.allSpeakers[t].t)&&("undefined"!=typeof e.data.allSpeakers[parseInt(t)+1]&&1e3*s<=parseFloat(e.data.allSpeakers[parseInt(t)+1].t)||"undefined"==typeof e.data.allSpeakers[parseInt(t)+1]&&1e3*s<=1e3*e.data.duration)&&e.speakers.getSpeakerKeyByName(e.data.allSpeakers[parseInt(t)].s)==e.settings.filterSpeaker)return!0;return!1},filterSpeakersList:function(t){e.helper.find(".vbs-select-dropdown li").removeClass("vbs-disabled").each(function(){var e=s(this),a=e.attr("data-speaker");t.indexOf(a)<0&&"all"!=a&&e.addClass("vbs-disabled")})},parseSpeakersInCategory:function(s,t,a){for(var r in s.speakers){var n=e.helper.replaceAndTrim(s.speakers[r]);if(e.speakers.addSpeakerKey(n),!e.common.inArrayV(t,n)){var i=Object.keys(a).length+1;t.push(n),a.push("vbs-sp"+i+"o")}}var o=[];if("undefined"!=typeof s.speakers&&s.speakers.length)for(var l in s.speakers)o.push(e.speakers.getSpeakerKeyByName(e.helper.replaceAndTrim(s.speakers[l])));return o.join(),{isps:o,speakersName:t,speakersArray:a}},createSpeakerAttr:function(s){var t=e.helper.isTurn(s.m),a=e.helper.getClearWordFromTranscript(s.w),r=t?a:!1,n="";if(r){e.speakers.addSpeakerKey(r);var i=e.speakers.getSpeakerKeyByName(r);n='m="'+i+'"'}return n},speakerIsSpeaking:function(){var t=1e3*e.data.position,a=s(".vbs-speakers > div:speakertime("+t+")");if(a.length){var r=a.attr("cnum"),n=e.speakers.getSpeakerNameByKey(r);if("undefined"!=typeof n&&e.data.lspeaker!=n&&">>"!=n.trim()){e.data.lspeaker=n;var i=e.templates.parse("speakerIsSpeaking",{speakerKey:r,speakerName:n});e.helper.find(".vbs-voice-name").html(i),e.helper.adjustMediaTime()}}else e.helper.find(".vbs-voice-name").html("")},speakersWidget:function(){var t=[],a=1,r=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper");r.find("span.w[m]").each(function(){var r=s(this),n={};n.s=e.speakers.getSpeakerNameByKey(r.attr("m")),n.t=r.attr("t"),t.push(n);var i,o="";e.settings.turnTimes&&(">>"==n.s.trim()?(i=a%2?"vbs-sp1":"vbs-sp2",a++):i=e.speakers.getSpeakerKeyByName(n.s),o+=e.templates.parse("speakerTranscriptLabel",{spClass:i,speakerName:n.s,speakerTime:e.helper.parseTime(n.t/1e3)})),jQuery(o).insertBefore(this)}),a>1&&r.addClass("vbs-machine"),a=1,e.data.allSpeakers=t,t.length&&(e.speakers.renderSpeakersInTimeline(),a>1&&($speakers.addClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").addClass("vbs-machine")))},renderSpeakersInTimeline:function(){var s=e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper"),t=e.data.allSpeakers;if(t.length){e.settings.turnTimes&&s.addClass("vbs-turntimes");var a=e.helper.find(".vbs-record-timeline-wrap").width()-1,r="";for(var n in t){t[n].s=e.helper.replaceAndTrim(t[n].s);var i,o=t[n].t/1e3*a/e.data.duration;i="undefined"!=typeof t[parseFloat(n)+1]?(t[parseFloat(n)+1].t-t[parseFloat(n)].t)/1e3*a/e.data.duration:(e.data.duration-t[parseFloat(n)].t/1e3)*a/e.data.duration;var l;l="undefined"!=typeof t[parseFloat(n)+1]?parseFloat(t[parseFloat(n)+1].t):1e3*e.data.duration;var d;">>"==t[n].s.trim()?(d=snn%2?"vbs-sp1":"vbs-sp2",snn++):d=e.speakers.getSpeakerKeyByName(t[n].s),r+=" "+e.templates.parse("speakersTemplate",{position:o,width:i,s:parseFloat(t[parseFloat(n)].t),e:l,speaker:t[n].s,colorclass:d})}var p=e.helper.find(".vbs-speakers");p.html(r)}},speakerFilterWidget:function(s){var t='<li data-speaker="all">All Speakers</li>';for(var a in s)t+='<li data-speaker="'+a+'">'+s[a]+"</li>";if(e.helper.find(".vbs-search-form").removeClass("vbs-no-speaker"),!e.settings.searchBarOuter){var r=e.helper.findc("#"+e.settings.keywordsBlock),n=e.helper.find(".vbs-keywords-wrapper");r.width()<e.settings.mediumResponsiveWithSpeakers&&r.width()>=e.settings.minResponsive&&(r.addClass("less-600px"),n.height(n.height()-55))}e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(t)},resizeSpeakers:function(){e.speakers.renderSpeakersInTimeline()},createInsertSpeakerDialog:function(t){s(".vbs-insert-speaker-popup").remove();var a=t.parents(".vbs-vbcmenu"),r=s(".vbs-edit-mode-wrapper");r.append(e.templates.parse("insertSpeakerPopup"));for(var n=s(".vbs-select-insert-speaker-wrapper"),i=n.find(".vbs-select-dropdown"),o=e.speakers.getSpeakersFromEditor(),l=e.templates.get("firstSpeakerItem"),d=0;d<o.length;d++){var p=o[d],c=e.speakers.getSpeakerNameByKey(p);l+=e.templates.parse("speakerItem",{speaker_name:c,speaker_key:p})}i.html(l),s(".vbs-insert-speaker-popup").css({top:a.offset().top+r.scrollTop(),left:a.offset().left}).fadeIn(function(){s(".vbs-insert-speaker-input").focus()})},selectSpeakerInInsertDialog:function(t){t.parents(".vbs-select-dropdown").fadeOut("fast");var a=s(".vbs-select-insert-speaker"),r=a.find(".vbs-speaker-selected"),n=s(".vbs-speaker-input-wrapper"),i=t.attr("data-speaker-key");if(i){var o=e.speakers.getSpeakerNameByKey(i);a.removeClass("vbs-new-speaker").attr("data-speaker-key",i),n.hide(),r.html(o)}else{var l=n.find(".vbs-insert-speaker-input");n.show(),a.addClass("vbs-new-speaker"),r.html("Insert new speaker"),setTimeout(function(){l.focus()},0)}a.removeClass("vbs-s-show")},insertSpeakerToEditor:function(){var t,a,r=s(".vbs-edit-mode-wrapper").find(".vbs-menu-target"),n=s(r).attr("t"),i=s(".vbs-select-insert-speaker");if(i.hasClass("vbs-new-speaker")?(t=s(".vbs-insert-speaker-input").val(),e.speakers.addSpeakerKey(t),a=e.speakers.getSpeakerKeyByName(t)):(a=i.attr("data-speaker-key"),t=e.speakers.getSpeakerNameByKey(a)),!r.prev().hasClass("vbs-edit-speaker")&&a){var o=e.templates.parse("insertSpeakerText",{speakerKey:a,speakerTime:n,speakerName:t});r.first().before(o)}},getSpeakersFromEditor:function(){var e=[],t=s(".vbs-edit-speaker");return t.each(function(){var t=s(this).attr("m"),a=e.filter(function(e){return e===t});a.length||e.push(t)}),e},findSpeakerElementsInEditor:function(e){var t=s(".vbs-edit-mode-wrapper"),a=[];return t.find(".vbs-edit-speaker").each(function(){var t=s(this).attr("m");e===t&&a.push(s(this))}),a},createRenameSpeakerDialog:function(t){s(".vbs-rename-speaker-popup").remove(),e.speakers.enableRenameAllSpeakersInEditor();var a=t.parents(".vbs-vbcmenu"),r=t.attr("data-speaker-key"),n=e.speakers.getSpeakerNameByKey(r),i=s(".vbs-edit-mode-wrapper");i.append(e.templates.parse("renameSpeakerPopup",{current_speaker_key:r,current_speaker_name:n})),e.speakers.disableRenameSpeakersInEditor(r),setTimeout(function(){s("#vbs-rename_speaker_input").focus()},0),s(".vbs-rename-speaker-popup").css({top:a.offset().top+i.scrollTop(),left:a.offset().left}).fadeIn()},renameSpeaker:function(){var t=(s(".vbs-edit-mode-wrapper"),s("#vbs-rename_speaker_input").val()),a=s("#vbs-rename_speaker_input").attr("data-old-speaker-key");e.speakers.inSpeakers(t)||e.speakers.addSpeakerKey(t);var r=e.speakers.getSpeakerKeyByName(t),n=e.speakers.findSpeakerElementsInEditor(a);n.forEach(function(e){e.text(t+":").prepend("<br><br>").attr("m",r)}),e.speakers.clearEditorSpeakers(),e.speakers.enableRenameAllSpeakersInEditor(a)},renameSpeakerFromEditor:function(s){var t=s.attr("m"),a=e.helper.getClearWordFromTranscript(s.text());-1!=a.lastIndexOf(":")&&(a=a.substring(0,a.lastIndexOf(":"))),e.speakers.inSpeakers(a)||e.speakers.addSpeakerKey(a),t=e.speakers.getSpeakerKeyByName(a),s.attr("m",t),e.speakers.clearEditorSpeakers()},clearEditorSpeakers:function(){for(var t=s(".vbs-edit-mode-wrapper"),a=Object.keys(voiceBase.data.speakers),r=0;r<a.length;r++){var n=t.find('span.w[m="'+a[r]+'"]');0===n.length&&(e.data.speakers[a[r]]="")}},disableRenameSpeakersInEditor:function(s){var t=e.speakers.findSpeakerElementsInEditor(s);t.forEach(function(e){e.attr("contenteditable","false")})},enableRenameAllSpeakersInEditor:function(){var e=s(".vbs-edit-speaker");e.each(function(){s(this).attr("contenteditable","true")})}},e}(voiceBase,jQuery),voiceBase=function(e){"use strict";var s=function(){var s="";return e.settings.tabView&&(s+=" vbs-tab "),s};return e.templates={parse:function(e,s){var t=this.get(e);for(var a in s){var r=new RegExp("{{\\s*"+a+"\\s*}}","gi");t=t.replace(r,s[a])}return t},get:function(t){var a="";switch(t){case"vbs-media":return a='<div class="vbs-media-block">\n                <div class="vbs-section-header">\n                    <div class="vbs-section-title">\n                        <span class="vbs-section-name vbs-sna">audio</span>\n                        <span class="vbs-section-name vbs-snv"></span>\n                        <span class="vbs-time"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span></span>\n                        <span class="vbs-voice-name"></span>\n                    </div>\n                    <div class="vbs-section-btns"><ul class="vbs-clearfix">',a+=e.settings.vbsButtons.downloadMedia?'<li><a href="#" class="vbs-download-audio-btn" format="pdf" data-title="Download Recording"></a></li>':"",a+=e.settings.vbsButtons.remove?'<li><a href="#" class="vbs-del-btn" data-title="Delete Recording"></a><div class="vbs-download-popup vbs-delete-popup vbs-popup"><div class="vbs-arrow"></div><h3>Are you sure you want to delete this recording?</h3><a href="#" class="vbs-red-btn">Delete</a><a href="#" class="vbs-blue-btn">Cancel</a></div></li>':"",a+=e.settings.vbsButtons.favorite?'<li><a href="#" class="vbs-star-btn"></a></li>':"",a+=e.settings.vbsButtons.help?'<li><a href="#" class="vbs-help-btn" data-title="Help"></a></li>':"",a+='</ul></div>\n                    <div class="clear-block"></div>\n                </div>\n                <div class="vbs-section-body"></div>\n            </div>';case"vbs-controls":var r=e.settings.vbsButtons.prev&&e.settings.vbsButtons.next?" vbs-3-left-btns":e.settings.vbsButtons.prev||e.settings.vbsButtons.next?" vbs-2-left-btns":" vbs-1-left-btns";return a='<div class="vbs-record-player'+r+'">\n                <div class="vbs-player-control">\n                    <a href="#" class="vbs-play-btn" data-title="Play"></a>',a+=e.settings.vbsButtons.prev?'<a href="javascript:void(0)" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>':"",a+=e.settings.vbsButtons.next?'<a href="javascript:void(0)" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>':"",a+='</div>\n                <div class="vbs-time-name-wrapper-narrow">\n                    <span class="vbs-time"><span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:00:00</span></span> <br>\n                    <span class="vbs-voice-name"></span>\n                </div>\n                <div class="vbs-timeline">\n                    <div class="vbs-record-preview">\n                        <div class="vbs-record-timeline-wrap">\n                            <div class="">\n                                <div class="vbs-dragger"></div>\n                                <div class="vbs-record-timeline"></div>\n                                <div class="vbs-record-progress"></div>\n                                <div class="vbs-speakers"></div>\n                                <div class="vbs-player-slider"></div>\n                                <div class="vbs-record_buffer"></div>\n                                <div class="vbs-utterance-markers"></div>\n                            </div>\n                            <!--markers-->\n                            <div class="vbs-markers"></div>\n                            <div class="vbs-custom-markers"></div>\n                            <!-- / markers-->\n                            <div class="vbs-markers-hovers"></div>\n                            <div class="vbs-comments-wrapper-block"></div>\n                            <div class="vbs-record-disabler" style="width: 0%;"></div>\n                        </div>\n                    </div>\n                </div>',a+=e.settings.vbsButtons.share?'<div class="vbs-share-btn-wrapper"><a href="#" class="vbs-share-btn vbs-popup-btn" data-title="Share"></a></div>':"",e.helper.is_iDevice()||(a+='<div class="vbs-volume-toolbar">\n                            <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n                            <div class="vbs-volume-toolbar-block" style="display: none;">\n                                <div class="vbs-volume-slider">\n                                    <div class="vbs-volume-slider-bg"></div>\n                                    <div class="vbs-volume-slider-full"></div>\n                                    <div class="vbs-volume-slider-handler"></div>\n                                </div>\n                            </div>                        </div>'),a+="</div>";case"vbs-searchbar-outer":return a='<div id="vbs-searchbar-block"><div class="vbs-search-form vbs-no-speaker"><form action="#" id="vbs-search-form"><div class="vbs-widget-wrap"><div class="vbs-widget"><input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off><div id="vbs-search-string"><div class="vbs-marquee"><div class="vbs-search-word-widget"></div></div></div>',a+=e.settings.vbsButtons.pwrdb?'<span class="vbs-powered-by-label">Powered by VoiceBase</span>':"",a+='</div><a href="#" id="vbs-clear-string" title="Clear String"></a></div>',e.settings.vbsButtons.unquotes&&(a+='<a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>'),a+='<div class="vbs-search-btn" data-title="Search">   <button type="submit"></button></div></form></div></div>';case"vbs-keywords":a='<div class="vbs-keywords-block '+s()+'">\n                <div class="vbs-section-header">\n                    <div class="vbs-section-title" data-title="Hide Keywords">\n                        <span class="vbs-section-name">Keywords</span>\n                    </div>\n\n                    <div class="vbs-search-form vbs-no-speaker ',a+=e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker?"vbs-one-btn":"vbs-no-btns",a+='">',e.settings.searchBarOuter||(a+='<form action="#" id="vbs-search-form">\n                            <div class="vbs-widget-wrap">\n                                <div class="vbs-widget">\n                                    <input name="get_voice_search" value="" size="20" id="vbs-voice_search_txt" class="vbs-formfields" type="text" placeholder="Search Keywords..." autocomplete=off>\n                                    <div id="vbs-search-string">\n                                        <div class="vbs-marquee">\n                                            <div class="vbs-search-word-widget"></div>\n                                        </div>\n                                    </div>',a+=e.settings.vbsButtons.pwrdb?'<span class="vbs-powered-by-label">Powered by VoiceBase</span>':"",a+='</div>\n                             <a href="#" id="vbs-clear-string" title="Clear String"></a>\n                            </div>',e.settings.vbsButtons.unquotes&&(a+='<a href="javascript:void(0)" class="vbs-unquote-btn">Unquoted</a>'),a+='<div class="vbs-search-btn" data-title="Search">\n                                    <button type="submit"></button>\n                            </div>',a+="</form>"),a+='<div class="vbs-select-speaker-wrapper">\n                        <div class="vbs-select-speaker">Select speaker...</div>\n                        <ul class="vbs-select-dropdown"></ul>\n                    </div>',a+="</div>";var n="";return e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker&&(n+='<li><a href="#" class="vbs-evernote-btn" data-title="Send to Evernote"></a></li>'),n&&(a+='<div class="vbs-section-btns"><ul>',a+=n,a+="</ul></div>"),a+='<div class="clear-block"></div>\n                </div>\n                <!-- / section header-->\n\n                <div class="vbs-section-body">\n                    <div class="vbs-keywords-wrapper vbs-scroll" style="{{ styles }}">\n                        <div class="vbs-topics"></div>\n                        <div class="vbs-keywords-list-wrapper">\n                            <div class="vbs-keywords-list-tab"></div>\n                        </div>\n                        <div class="clear-block"></div>\n                    </div>',a+=e.settings.showMore?'<div class="vbs-more-btn"><a href="#">Show More...</a></div>':"",a+="\n                </div>\n            </div>";case"vbs-edit-trans-mode":var i='<div class="vbs-edit-mode-wrapper">\n                <div class="vbs-controls-wrapper">\n                    <div id="vbs-controls" class="vbs-controls-box">\n                        <div class="vbs-edition-btns vbs-clearfix">';
return i+='<div class="vbs-save-exit-btns">\n                                <a href="#" class="vbs-save-btn vbs-save-edition-popup-trigger" id="vbs-save-edition-popup-trigger">Save & Re-sync</a>\n                                <a href="#" class="vbs-exit-btn vbs-edit-mode-exit">Exit</a>\n                            </div>\n                        </div>\n                        <div class="vbs-record-player vbs-3-left-btns">\n                            <div class="vbs-player-control">\n                                <a href="#" class="vbs-play-btn" data-title="Play"></a>\n                                <a href="#" class="vbs-prev-btn" data-title="Back 15 Seconds"></a>\n                                <a href="#" class="vbs-next-action-btn vbs-next-notactive" data-title="Next Keyword Marker"></a>\n                            </div>\n                            <div class="vbs-time-name-wrapper-narrow" style="opacity: 0;">\n                                <span class="vbs-time">\n                                    <span class="vbs-ctime">00:00:00</span> / <span class="vbs-ftime">00:04:03</span>\n                                </span> <br>\n                                <span class="vbs-voice-name"></span>\n                            </div>\n                                <div class="vbs-timeline">\n                                    <div class="vbs-record-preview">\n                                        <div class="vbs-record-timeline-wrap">\n                                            <div class="">\n                                                <div class="vbs-dragger"></div>\n                                                <div class="vbs-record-timeline"></div>\n                                                <div class="vbs-record-progress" style="width: 0%;"></div>\n                                                <div class="vbs-speakers"></div>\n                                                <div class="vbs-player-slider" style="left: 0%;"></div>\n                                                <div class="vbs-record_buffer"></div>\n                                            </div>\n                                            <!--markers-->  \n                                            <div class="vbs-markers"></div>\n                                            <!-- / markers-->\n                                            <div class="vbs-markers-hovers"></div>\n                                            <div class="vbs-comments-wrapper-block"></div>\n                                            <div class="vbs-record-disabler" style="width: 0%;"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class="vbs-volume-toolbar">\n                                    <a href="#" class="vbs-volume-btn" data-title="Volume"></a>\n                                    <div class="vbs-volume-toolbar-block" style="display: none;">\n                                        <div class="vbs-volume-slider">\n                                            <div class="vbs-volume-slider-bg"></div>\n                                            <div class="vbs-volume-slider-full"></div>\n                                            <div class="vbs-volume-slider-handler"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="vbs-edit-instr vbs-clearfix">\n                    <div class="vbs-mouse-btns-desc">\n                        <span><b>Left click</b> on text to <em>Edit</em></span>\n                        <span><b>Right click</b> on text to <em>Menu</em></span>\n                    </div>\n                    </div>\n                <div class="vbs-edition-block" contenteditable="true">\n                    {{ ourtranscript }}\n                </div>\n                <div class="vbs-popup-overlay vbs-save-popup-wrapper">\n                    <div class="vbs-save-popup">\n                        <h2>Unsaved Changes</h2>\n                        <p class="vbs-normal-save-message">You have unsaved changes that will be lost unless you save them.</p>\n                        <p class="vbs-save-message-short-editing">Edited transcript is too short relative to the original and may be rejected by the system. Attempt to save?</p>\n                        <p class="vbs-save-message-long-editing">Edited transcript is too long relative to the original and may be rejected by the system. Attempt to save?</p>\n                        <a href="#" class="vbs-save-btn vbs-save-edition-btn">Save Changes</a>\n                        <a href="#" class="vbs-exit-btn vbs-discard-edition-btn" >Discard Changes</a>\n                        <a href="#" class="vbs-exit-btn vbs-cancel-edition-btn">Cancel</a>\n                    </div>\n                    <div class="vbs-save-done-popup">\n                        <div class="vbs-save-done-img"></div>                        <h3>Done!</h3>\n                    </div>\n                    <div class="vbs-save-loading-popup">\n                        <div class="vbs-ajax-loader"></div>\n                        <h3>Saving & Re-syncing!</h3>\n                        <p>This may take a little time, especially if you’re editing a longer transcript.</p>\n                    </div>\n                </div>\n                </div>';case"vbs-transcript":var o=e.settings.showMore?"":"vbs-no-showmore-btn";return a='<div class="vbs-transcript-block '+o+s()+'">\n                    <div class="vbs-edit-mode-prewrapper"></div>\n        <div class="vbs-section-header">\n            <div class="vbs-section-title">\n                <span class="vbs-section-name vbs-snh">human transcript</span>\n                <span class="vbs-section-name vbs-snm">machine transcript</span>\n            </div>',a+=e.settings.vbsButtons.orderTranscript?'<div class="vbs-order-human-trans" data-title="See Transcript Price & Options"><a href="#" target="_blank">Order Human Transcript</a></div>':"",a+='<div class="vbs-section-btns">\n                <ul class="vbs-clearfix">',a+=e.settings.vbsButtons.downloadTranscript?'<li><a href="#" class="vbs-cloud-btn vbs-popup-btn" data-title="Download Transcript"></a>\n                <div class="vbs-download-popup vbs-popup">\n                    <div class="vbs-arrow"></div>\n                    <h3>Download transcript</h3>\n                    <a href="#pdf" class="vbs-donwload-pdf" format="pdf">PDF</a>\n                    <a href="#rtf" class="vbs-donwload-rtf" format="rtf">RTF</a>\n                    <a href="#srt" class="vbs-donwload-srt" format="srt">SRT</a>\n                </div>\n                </li>':"",a+=e.settings.vbsButtons.edit?'<li><a href="#" class="vbs-edit-btn" data-title="Edit Transcript"></a></li>':"",a+=e.settings.vbsButtons.print?'<li><a href="#" class="vbs-print-btn" data-title="Print Transcript"></a></li>':"",a+=e.settings.vbsButtons.readermode?'<li><a href="#" class="vbs-readermode-btn" data-title="Reader Mode"></a></li>':"",a+='</ul>\n            </div>\n        </div>\n        <div class="vbs-section-body">\n           <!-- transcript-->\n            <div class="vbs-transcript-prewrapper vbs-resizable"><div class="vbs-transcript-wrapper"></div></div>\n            <!-- / transcript-->\n            ',a+=e.settings.showMore?'<div class="vbs-more-btn"><a href="#">Show More...</a></div>':"",a+="\n        </div>\n    </div>";case"vbs-comments":a='\n                <div class="vbs-comments-block '+s()+'">\n                    <div class="vbs-section-header">\n                        <div class="vbs-section-title" data-title="Show Comments">\n                            <span class="vbs-section-name"></span>\n                        </div>';var l=!0;return e.settings.restrictions.length>0&&(l=e.settings.restrictions.indexOf("manageComments")>-1||e.settings.restrictions.indexOf("manageOwnComments")>-1),l&&(a+='<div class="vbs-section-btns">\n                            <ul class="vbs-clearfix">\n                                <li>',a+=e.settings.tabView?'<a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment"><div class="vbs-comments-btn-icon"></div><span>Add New Comment</span></a>':'<a href="#" class="vbs-comments-btn vbs-popup-btn" data-title="Add a Comment"></a>',a+="</li>\n                            </ul>\n                        </div>"),a+='</div>\n                    <!--wrapper for comments content-->\n                    <div class="vbs-section-body"></div>\n                </div>';case"vbs-news":return a='\n                <div class="vbs-news-block '+s()+'">\n                    <div class="vbs-section-header">\n                        <div class="vbs-section-title" data-title="Show News">\n                            <span class="vbs-section-name">                                <span>News stories</span>                                <span class="vbs-news-words-wrapper">                                    <span class="vbs-small-text"> related to </span>                                    <span class="vbs-news-words"></span>                                </span>                            </span>\n                        </div>\n                    </div>\n                    <!--wrapper for news content-->\n                    <div class="vbs-section-body">\n                        <div class="vbs-news-wrapper vbs-scroll">\n                        </div>\n                    </div>\n                </div>';case"vbs-news-elem":return a="",a+='<a href="{{ url }}" target="_blank" class="vbs-news-elem"><div class="vbs-news-elem-title">{{ title }}</div><div class="vbs-news-elem-body">   <span class="vbs-news-elem-source">{{ source }}</span>   <span>&nbsp;-&nbsp;</span>   <span class="vbs-news-elem-time">{{ time }}</span></div></a>';case"vbs-empty-news":return a='<div class="empty_news_message">{{ message }}</div>';case"vbs-predictions":return a='\n                <div class="vbs-predictions-block '+s()+'">\n                    <div class="vbs-section-header">\n                        <div class="vbs-section-title" data-title="Show Predictions">\n                            <span class="vbs-section-name">                                <span>Predictions</span>                            </span>\n                        </div>\n                    </div>\n                    <!--wrapper for news content-->\n                    <div class="vbs-section-body">\n                        <div class="vbs-predictions-wrapper vbs-scroll">\n                        </div>\n                    </div>\n                </div>';case"disabler":return'<div class="vbs-disabler"></div>';case"reloadOverlay":return a='<div class="vbs-reload-overlay">\n                    <div class="vbs-reload-message-wrapper vbs-clearfix">\n                    <div class="vbs-reload-message"><a href="javascript:void(0)" class="overlay_dismiss">&times;</a><span>Some details were not load</span></div>\n                        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n                    </div>\n                    </div>';case"reloadOverlayCredentials":return a='<div class="vbs-reload-overlay">\n                    <div class="vbs-reload-message-wrapper vbs-large-error-text vbs-clearfix">\n                    <div class="vbs-reload-message">\n                        <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>\n                        <span>Could not load recording data, indexing file may not be complete. If reload does not solve problem contact support for assistance</span></div>\n                        <a href="javascript:location.reload();" class="vbs-reload-btn"></a>\n                    </div>\n                    </div>';case"sharePopup":return a='<div class="vbs-share-popup vbs-popup" style="display: block;">\n                        <div class="vbs-arrow"></div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix vbs-checked">\n                            <input type="radio" name="share-opt" value="share-position" id="vbs-share-position" checked="checked">\n                            <label for="vbs-share-position">\n                                Share position <span class="vbsp-time" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix">\n                            <input type="radio" name="share-opt" value="share-search" id="vbs-share-search">\n                            <label for="vbs-share-search">\n                                Share search  <br>\n                                <span class="vbs-explanation">The current search or keyword  selected</span>\n                            </label>\n                        </div>\n\n                        <div class="vbs-share-radio-row vbs-clearfix">\n                            <input type="radio" name="share-opt" value="share-file" id="vbs-share-file">\n                            <label for="vbs-share-file">Share file from start</label>\n                        </div>\n\n                        <div class="vbs-link-row vbs-clearfix {{ zclip }}">\n                            <input type="text" id="vbsp-url" class="vbsp-url" value="{{ url }}" >\n                            <a href="#" class="vbs-copy-btn">Copy</a>\n                        </div>\n\n                        {{ addthis }}\n\n                        <div class="vbs-share-footer">\n                            {{ vbShareButton }}<a href="#" class="vbs-cancel-btn">Cancel</a>\n                        </div>\n                    </div>';case"commentPopup":return a='\n                    <div class="vbs-comments-popup vbs-comments-add-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-comment-popup-row vbs-clearfix">\n                            <label>\n                                Comment position: <span class="vbs-time" id="vbs-comment-timeline" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment..."></textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Add comment</a>\n                        </div>\n                    </div>';case"commentDeletePopup":return a='<div class="vbs-comments-popup vbs-popup vbs-comment-delete-popup">\n                                <div class="vbs-arrow"></div>\n                                <span>Delete This Comment?</span>\n                                <div class="vbs-comment-footer">\n                                    <a href="#" class="vbs-cancel-btn" c_id="{{ c_id }}">Yes, Delete</a>\n                                    <a href="#" class="vbs-confirm-btn">No, Cancel</a>\n                                </div>\n                            </div>';case"commentReplyPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-reply-text" placeholder="Enter your comment..."></textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" c_id={{ c_id }} class="vbs-confirm-btn">Add comment</a>\n                        </div>\n                    </div>';case"commentEditFirstPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-comment-popup-row vbs-clearfix">\n                            <label>\n                                Comment position: <span class="vbs-time" id="vbs-comment-timeline" vbct="{{ vbt }}">{{ vbspTime }}</span> <br>\n                                <span class="vbs-explanation">Drag the timeline to change</span>\n                            </label>\n                            <a href="#" class="vbs-play-btn"></a>\n                        </div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment...">{{ commentText }}</textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn" c_id="{{ c_id }}">Save Changes</a>\n                        </div>\n                    </div>';case"commentEditPopup":return a='\n                    <div class="vbs-comments-popup vbs-popup vbs-edit-wr">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-enter-comment-row">\n                            <textarea id="vbs-comment-text" placeholder="Enter your comment...">{{ commentText }}</textarea>\n                        </div>\n                        <div class="vbs-comment-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn" c_id="{{ c_id }}">Save Changes</a>\n                        </div>\n                    </div>';case"renameSpeakerPopup":return a='\n                    <div class="vbs-rename-speaker-popup vbs-common-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-common-popup-header vbs-clearfix">\n                            <div class="rename_speaker_label">Rename speaker</div>                            <div class="vbs-old-speaker-name">{{ current_speaker_name }}</div>                            <div class="rename_speaker_label">to:</div>                        </div>\n                        <div class="vbs-common-popup-body">\n                            <input type="text" id="vbs-rename_speaker_input" data-vbs-validate="required" data-old-speaker-key="{{ current_speaker_key }}" placeholder="Enter new speaker name"/>                        </div>\n                        <div class="vbs-common-popup-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Rename</a>\n                        </div>\n                    </div>\n';case"insertSpeakerPopup":return a='\n                    <div class="vbs-insert-speaker-popup vbs-common-popup">\n                        <div class="vbs-arrow"></div>\n                        <div class="vbs-common-popup-header vbs-clearfix">\n                            <div class="rename_speaker_label">Insert speaker</div>                        </div>\n                        <div class="vbs-common-popup-body">\n                            <div class="vbs-select-wrapper vbs-select-insert-speaker-wrapper">\n                                <div class="vbs-select-title vbs-select-insert-speaker vbs-new-speaker">                                    <div class="vbs-speaker-selected">Insert new speaker</div>                                </div>\n                                <ul class="vbs-select-dropdown"></ul>\n                            </div>\n                            <div class="vbs-speaker-input-wrapper">                                <input type="text" data-vbs-validate="required,ignore[invisible]" class="vbs-insert-speaker-input" value="" placeholder="Enter speaker name"/>                            </div>                        </div>\n                        <div class="vbs-common-popup-footer">\n                            <a href="#" class="vbs-cancel-btn">Cancel</a>\n                            <a href="#" class="vbs-confirm-btn">Insert</a>\n                        </div>\n                    </div>\n';case"categoriesLiTemplate":return'<li class="{{liclass}}">   <a href="javascript:void(0);" speakers="{{ speakers }}">{{ title }}</a>   <div class="vbs-topic-del-btn-wrap"><i class="vbs-cross-btn vbs-popup-btn"></i></div></li>';case"newCategoriesLiTemplate":return'<li {{ keyclass }}><a href="javascript:void(0);" t="{{ times }}" in="{{ internalName }}" speakers="{{ speakers }}" {{ sptimes }}>{{ title }}</a></li>';case"categoriesKeywords":return'<div class="category"><h3>{{ cattitle }} (<span class="ccount">{{ count }}</span>)</h3><div class="new-topics"><ul>{{ lis }}</ul><div class="clearblock"></div></div></div>';case"keywordsTemplate":return'<li {{ keyclass }}><a href="#" t="{{ times }}" speakers="{{ speakers }}" {{ sptimes }}>{{ name }}</a>{{ keycounter }}</li>';case"markerTemplate":return'<a href="#" class="vbs-marker" style="border-bottom-color:{{ stcolor }}; z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a><span ctime="{{ time }}" class="vbs-comment">{{ phrase }}</span>';case"customMarkerTemplate":return'<a href="#" class="vbs-marker vbs-custom-marker" style="z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a><span ctime="{{ time }}" class="vbs-comment">{{ phrase }}</span>';case"markerKeyTemplate":return'<a href="#" class="vbs-marker key" style="z-index:91; left:{{ position }}px;" stime="{{ time }}"><ins></ins></a>';case"searchWordTemplate":return'<span class="vbs-word">   <em>       <dfn style="border-bottom-color: {{ color }};" class="vbs-marker"><ins></ins></dfn>       {{ clean_word }}       <span class="vbs-search_word" style="display:none">{{ word }}</span>   </em></span>';case"mainDiv":return a='<!--media-->\n<div id="vbs-media"></div>\n<!--controls-->\n<div id="vbs-controls"></div>',e.settings.tabView?(a+='<!-- tabs-->\n<div class="vbs-not-media-sections vbs-tabs-view">\n    <div class="vbs-tabs-links vbs-clearfix">\n',e.settings.showKeywordsBlock&&(a+='        <a href="javascript:void(0)" data-href=".vbs-keywords-block" class="vbs-active">Keywords</a>\n'),e.settings.showTranscriptBlock&&(a+='        <a href="javascript:void(0)" data-href=".vbs-transcript-block">Transcript</a>\n'),e.settings.showCommentsBlock&&(a+='        <a href="javascript:void(0)" data-href=".vbs-comments-block">Comments</a>\n'),a+='</div>\n    <!--keywords-->\n    <div id="vbs-keywords"></div>\n    <!-- transcript -->\n    <div id="vbs-transcript"></div>\n    <!-- comments -->\n    <div id="vbs-comments"></div>\n</div>\n'):(a+='<!--keywords-->\n                        <div id="vbs-keywords"></div>',e.settings.showNewsBlock&&(a+='<!--news-->\n                            <div id="vbs-news"></div>'),a+='<!-- transcript -->\n                        <div id="vbs-transcript"></div>\n                        <!-- predictions -->\n                        <div id="vbs-predictions"></div>\n                        <!-- comments -->\n                        <div id="vbs-comments"></div>'),a;case"speakersTemplate":return'<div class="vbs-speaker {{ colorclass }}" rel="tooltip" data-plcement="top" style="width: {{ width }}px; left: {{ position }}px;" s="{{ s }}" e="{{ e }}" cnum="{{ colorclass }}"></div>';case"speakersAllFilter":return'<div id="speakers-block" speakerlist="{{ speakerlist }}" style="{{ style }}"><div class="current-speaker"><h3 data-speaker="all">All speakers</h3></div><div class="speakers-list">Click to drill down into what {{ speakers_links }} talked about, or see keywords for <a href="#all" data-speaker="all">All Speakers</a></div><div style="clear: both;"></div></div>';case"speakersFilter":return'<div id="speakers-block" speakerlist="{{ speakerlist }}" style="{{ style }}"><div class="current-speaker"><h3 data-speaker="{{ curspeaker }}">{{ curspeaker }}</h3></div><div class="speakers-list">Click to drill down into what {{ speakers_links }} talked about, or see keywords for <a href="#all" data-speaker="all">All Speakers</a></div><div style="clear: both;"></div></div>';case"speakerIsSpeaking":return'<span class="{{ speakerKey }}">{{ speakerName }}</span> is speaking';case"speakerTranscriptLabel":return'<span class="vbs-clearfix"></span><span class="vbs-trans-info">   <span class="vbs-human-trans-name {{ spClass }}" title="{{ speakerName }}">{{ speakerName }}</span>   <span class="vbs-human-trans-time">{{ speakerTime }}</span></span>';case"deleteTopicPopup":return a='<div class="vbs-comments-popup vbs-popup vbs-topic-delete-popup" data-topic="{{ topicname }}">\n                            <div class="vbs-arrow"></div>\n                            <span>Delete Topic?</span>\n                            <div class="vbs-comment-footer">\n                                <a href="#" class="vbs-cancel-btn">Yes</a>\n                                <a href="#" class="vbs-confirm-btn">No</a>\n                            </div>\n                        </div>';case"vbsCommentsTimeline":return a='<div class="vbs-comments-wrapper {{ rightClass }}" style="left:{{ position }}px;" stime="{{ stime }}">\n                            <div class="vbs-comment-small"></div>\n                            <div class="vbs-comment-preview"><a href="#" stime="{{ stime }}">{{ commentText }}</a></div>\n                        </div>';case"alertPopup":return a='<div class="vbs-alert_popup" data-action="{{ action }}"><div class="modalDialog_transparentDivs" style="left: 0px; top: 0px; display: block; width: 1925px; height: 662px;"></div>\n                <div class="modalDialog_contentDiv" id="DHTMLSuite_modalBox_contentDiv" style="display: block; width: 433px; left: 744px; top: 267px;"><div class="popup"><!--[if lt IE 7]><iframe></iframe><![endif]--><div class="inpopup"><a href="#" class="modal_close" alt="Close" title="Close"></a><h4>Delete Confirmation</h4><p>Do you really want to remove this topic with keywords?</p><div class="voicebase_buttons"><span><a href="#" class="modal_confirm">Confirm Delete</a></span><ins><a href="#" class="modal_cancel">Cancel Delete</a></ins></div><div class="fixer">&nbsp;</div></div></div></div></div>';case"errorPopup":return'<div class="vbs-white-popup-overlay">   <div class="vbs-big-error-popup">       <a href="javascript:void(0)" class="overlay_dismiss">&times;</a>       <h2>Could not load recording data</h2>       <p>Indexing file may not be complete. If reloading does not solve the problem, please contact support for assistance.</p>       <a href="javascript:location.reload();" class="vbs-reload-btn"></a>       <a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a>   </div></div>';case"abstractErrorPopup":return'<div class="vbs-white-popup-overlay"><div class="vbs-big-error-popup"><a href="javascript:void(0)" class="overlay_dismiss">&times;</a><h2>{{ errorTitle }}</h2><p>{{ errorText }}</p><a href="javascript:location.reload();" class="vbs-reload-btn"></a><a href="http://www.voicebase.com/contact-us/" target="_blank" class="vbs-contact-support-btn"></a></div></div>';case"abstractAlertPopup":return'<div class="vbs-white-popup-overlay"><div class="vbs-big-error-popup"><h2>{{ errorTitle }}</h2><p>{{ errorText }}</p></div></div>';case"textErrorMessage":return'<div class="vbs-text-error-message"><p>{{ errorText }}</p></div>';case"infoMessage":return'<div class="vbs-message vbs-message-{{ mode }}"><p>{{ errorText }}</p></div>';case"endSearchMessage":return'<div class="vbs-message vbs-message-info"><p>Your search is taking a long time...</p><p>Please wait or click to <a href="javascript:void(0)" class="vbs-cancel-search">Cancel</a></p></div>';case"utteranceBlock":return'<div class="vbs-utterance-block vbs-clearfix"><div class="vbs-utterance-title"><p>utterance detection</p></div><div class="vbs-utterance-list"><ul class="vbs-clearfix"></ul></div></div>';case"utteranceCheckBox":return'<li><label class="vbs-utter-{{ rownum }}"><input type="checkbox" checked data-row="{{ rownum }}"/>{{ title }}<span class="vbs-utter-num">({{ segmentsCount }})</span></label></li>';case"utteranceMarker":return'<div class="vbs-utter-marker vbs-utter-{{ rownum }} vbs-utter-row{{ rownum }}" data-stime="{{ startTime }}" style="width:{{ width }}px; left:{{ position }}px;"><div class="vbs-utter-tooltip"><p class="vbs-utter-title">{{ title }}</p><p class="vbs-utter-time">{{ time }}</p></div></div>';case"loggerBlock":return'<div class="vbs-logger"><textarea>{{ response }}</textarea></div>';case"languageSelect":return a='<div class="vbs-select-wrapper vbs-select-language-wrapper">\n                            <div class="vbs-select-title vbs-select-language">Select language...</div>\n                            <ul class="vbs-select-dropdown"></ul>\n                        </div>';case"languageItem":return a='<li data-lang-code="{{ lang_code }}">{{ lang_name }}</li>';case"firstSpeakerItem":return a='<li class="vbs-insert-new-speaker">Insert new speaker</li>';case"speakerItem":return a='<li data-speaker-key="{{ speaker_key }}">{{ speaker_name }}</li>';case"insertSpeakerText":return a='<span class="w vbs-wd vbs-edit-speaker" m="{{ speakerKey }}" t="{{ speakerTime }}"><br><br>{{ speakerName }}:</span>';case"savingMessage":return a='<div class="vbs-saving">   <div class="vbs-saving-inner">       <div class="vbs-saving-loader"></div>       <div class="vbs-saving-message">Saving & Re-syncing...</div>   </div></div>';case"successSavingMessage":return a='<div class="vbs-success-saving">   <div class="vbs-saving-inner">       <div class="vbs-saving-loader"></div>       <div class="vbs-saving-message">Transcript Saved</div>   </div></div>';case"playlist":return a='                    <div class="vbs-playlist collapsed">\n                        <div class="vbs-selected-playlist-item">                            <div class="vbs-item-name"></div>\n                            <i></i>\n                        </div>\n                        <div class="vbs-clearfix"></div>\n                        <ul class="vbs-playlist-dropdown">\n                        </ul>\n                    </div>';case"playlist-item":return a='                    <li class="vbs-playlist-item" data-playlist-item-index="{{ index }}">\n                        <span class="vbs-playlist-item-title">{{ title }}</span>                    </li>';case"controlsContainer":return a='                    <div class="vbs-after-controls-wrapper">                        <div class="vbs-player-control"></div>\n                        <div class="vbs-share-control"></div>\n                    </div>';default:return""}}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";return e.validator={validate:function(t){var a=t.find("[data-vbs-validate]"),r=[];return a.each(function(){var t=s(this),a=e.validator.getRules(t),n=a.rules,i=!1;a.ignoreRule&&(i=e.validator.conditions.ignore(t,a.ignoreRule.params[0])),!i&&n&&n.forEach(function(s){var a=e.validator.conditions[s.name](t,s.params);if(!a){var n=e.validator.getMessage(s.name,s.params);r.push({field:t,rule:s.name,message:n})}})}),r.length>0?(e.validator.clearMessages(t),e.validator.showMessages(r),!1):!0},clearMessages:function(e){e.find(".vbs-msg").remove()},showMessages:function(s){s.forEach(function(s){var t=s.field,a=e.validator.createMessage(s.message);t.after(a)
})},createMessage:function(e){var s='<div class="vbs-msg vbs-msg-alert">'+e+"</div>";return s},getRules:function(s){var t=s.attr("data-vbs-validate"),a={};if(t){var r=[],n=t.split(",");return n.forEach(function(s){for(var t=s.trim().split(/\[|,|\]/),n=0;n<t.length;n++)t[n]=t[n].replace(" ",""),""===t[n]&&t.splice(n,1);if(t.length>0){var i={};i.name=t[0],t.splice(0,1),i.params=t,e.validator.conditions[i.name]&&("ignore"===i.name?a.ignoreRule=i:r.push(i))}}),a.rules=r,a.rules.length>0?a:null}return null},getValue:function(e){var s;switch(e.prop("type")){case"radio":case"checkbox":s=e.is(":checked");break;default:s=e.val()}return s},getMessage:function(s,t){for(var a=e.validator.messages[s]?e.validator.messages[s]:"",r=0;r<t.length;r++){var n=new RegExp("{{\\s*param"+(r+1)+"\\s*}}","gi");a=a.replace(n,t[r])}return a&&(a="* "+a),a},conditions:{required:function(s){var t=e.validator.getValue(s);return!(null===t||""===t)},minSize:function(s,t){var a=parseInt(t[0]),r=e.validator.getValue(s),n=r.length||0;return n>=a},maxSize:function(s,t){var a=parseInt(t[0]),r=e.validator.getValue(s),n=r.length||0;return a>=n},visible:function(e){return e.is(":visible")},ignore:function(s,t){if("invisible"===t){var a=e.validator.conditions.visible(s);return!a}}},messages:{required:"This field is required",minSize:"{{ param1 }} characters required",maxSize:"{{ param1 }} characters allowed"}},e}(voiceBase,jQuery),voiceBase=function(e,s){"use strict";function t(e){e.find(".vbs-section-title").addClass("vbs-no-toggle")}function a(){e.settings.toggleBlocks?(e.settings.toggleMediaBlock||t(s("#"+e.settings.mediaBlock)),e.settings.toggleKeywordsBlock||t(s("#"+e.settings.keywordsBlock)),e.settings.toggleTranscriptBlock||t(s("#"+e.settings.transcriptBlock)),e.settings.toggleCommentBlock||t(s("#"+e.settings.commentsBlock)),e.settings.toggleNewsBlock||t(s("#"+e.settings.newsBlock)),e.settings.togglePredictionsBlock||t(s("#"+e.settings.predictionsBlock))):s(".vbs-section-title").addClass("vbs-no-toggle")}function r(){var t=s("#"+e.settings.mediaBlock),a=s("#"+e.settings.keywordsBlock),r=s("#"+e.settings.transcriptBlock),n=s("#"+e.settings.commentsBlock),i=s("#"+e.settings.predictionsBlock);e.settings.hasMediaBlockHeader||t.hide(),e.settings.hasKeywordsBlockHeader||a.find(".vbs-keywords-block").addClass("vbs-no-header"),e.settings.hasTranscriptBlockHeader||r.find(".vbs-transcript-block").addClass("vbs-no-header"),e.settings.hasCommentsBlockHeader||n.find(".vbs-comments-block").addClass("vbs-no-header"),e.settings.hasPredictionsBlockHeader||i.find(".vbs-predictions-block").addClass("vbs-no-header")}return e.view={main:null,pluginDiv:null,init:function(s){this.initMainElem(s),e.settings.hasPlaylist||e.settings.localApp||this.initApi(),e.helper.isMobile()&&e.helper.renderMobile()},initMainElem:function(t){this.main="OBJECT"===t[0].tagName&&"jwplayer"==e.settings.playerType?s(t).parent():t;var a=document.createElement("div");a.className="vbsp-"+e.helper.randId()+" vbs-content",a.innerHTML=e.templates.get("mainDiv"),this.pluginDiv=s(a),s(this.main).after(this.pluginDiv)},initApi:function(){e.api.init(),e.settings.token||e.settings.example||e.settings.localApp?e.settings.example&&!e.settings.localApp?e.api.getExampleToken():e.view.initWithToken():e.api.getToken(e.settings.tokenTimeOut)},initWithToken:function(){e.data.vclass="vbs-"+e.helper.randId(),s(".vbs-white-popup-overlay").remove(),s(".vbs-text-error-message").remove(),e.view.renderMediaBlock(),e.settings.localApp?e.api.setLocalMetaData():e.api.getMetaData(),e.view.renderControlsBlock(),e.settings.showKeywordsBlock?(e.view.renderKeywordsBlock(),e.settings.localApp||e.helper.isApi2_0()||e.api.getKeywords()):e.api.ready.keywords=!0,e.settings.showTranscriptBlock?(e.view.renderTranscriptBlock(),e.settings.localApp||e.helper.isApi2_0()||e.api.getTranscript()):e.api.ready.transcript=!0,e.settings.showCommentsBlock?(e.view.renderCommentsBlock(),e.helper.isApi2_0()||e.comments.getComments()):e.api.ready.comments=!0,e.settings.localApp&&e.view.renderLanguageBlock(),e.settings.showNewsBlock&&e.view.renderNewsBlock(),e.settings.showPredictionsBlock&&e.view.renderPredictionsBlock(),e.settings.tabView&&e.view.renderTabs(),a(),r(),e.data.waiter=setInterval(function(){e.data.waiter&&e.helper.waitReady()},100),e.events.registerEvents()},initLocalData:function(){var t=e.data.localData.selected_language,a=s("#"+e.settings.keywordsBlock),r=s("#"+e.settings.transcriptBlock);e.data.localData.keywords?e.api.setKeywords(e.data.localData.keywords[t]):YSP.api.getKeywords(function(s){e.data.localData.keywords=s.keywords,a.removeClass("vbs-loading"),e.api.setKeywords(e.data.localData.keywords[e.data.localData.selected_language])}),e.data.localData.transcripts?e.api.setTranscript(e.data.localData.transcripts[t]):YSP.api.getTranscript(function(s){e.data.localData.transcripts=s.transcripts,r.removeClass("vbs-loading"),e.api.setTranscript(e.data.localData.transcripts[e.data.localData.selected_language])})},renderControlsBlock:function(){var t=s("#"+e.settings.controlsBlock);t.empty().html(e.templates.get("vbs-controls")).addClass(e.data.vclass+" vbs-controls").css({width:e.settings.controlsWidth}),e.view.setResponsiveClass(t),e.settings.showControlsBlock||t.addClass("vbs-hide-controls")},renderMediaBlock:function(){var t=s("#"+e.settings.mediaBlock);t.empty().html(e.templates.parse("vbs-media")).addClass(e.data.vclass).css({width:e.settings.mediaWidth}),e.view.setResponsiveClass(t)},renderTimeInMediaTitle:function(){var t=s("#"+e.settings.mediaBlock),a=e.helper.parseTime(e.data.duration);e.helper.find(".vbs-ftime").text(a),t.hasClass("less-600px")||!e.settings.hasMediaBlockHeader?s(".vbs-time-in-player").find(".vbs-time").show():t.find(".vbs-section-header").find(".vbs-time").show()},renderKeywordsBlock:function(){var t=s("#"+e.settings.keywordsBlock),a=s("#"+e.settings.controlsBlock);if(e.settings.searchBarOuter){s("#vbs-searchbar-block").remove();var r=s("#"+e.settings.searchBarBlock);r.length>0?r.empty().append(e.templates.parse("vbs-searchbar-outer")):a.after(e.templates.parse("vbs-searchbar-outer"));var n=s("#vbs-searchbar-block");n.addClass(e.data.vclass).css({width:e.settings.searchBarBlockWidth}),t.empty().html(e.templates.parse("vbs-keywords",{styles:"height: "+e.settings.keywordsHeight+"px;"})).addClass(e.data.vclass).css({width:e.settings.keywordsWidth}),t.find(".vbs-search-form").addClass("no_border")}else t.empty().html(e.templates.parse("vbs-keywords",{styles:"height: "+e.settings.keywordsHeight+"px;"})).addClass(e.data.vclass).css({width:e.settings.keywordsWidth}),e.view.setResponsiveClass(t);e.settings.markersInNativeTimeline&&e.view.renderControlsAfterSearchBar(),e.settings.localApp&&(t.addClass("vbs-local-app vbs-loading"),t.find(".vbs-section-title").attr("data-title","Loading keywords"))},renderControlsAfterSearchBar:function(){if(e.settings.searchBarOuter){var t=s("#vbs-searchbar-block");t.addClass("vbs-controls-after-searchbar vbs-searchbar-outer"),s(".vbs-after-controls-wrapper").remove(),t.find(".vbs-search-form").after(e.templates.get("controlsContainer")),s(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar .vbs-player-control"),s(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar .vbs-share-control"),t.find(".vbs-search-form").width(t.width()-s(".vbs-controls-after-searchbar .vbs-after-controls-wrapper").width()-2)}else{var a=s(".vbs-keywords-block "),r=s(".vbs-search-form");0===a.find(".vbs-section-btns").length&&r.after('<div class="vbs-section-btns"><ul></ul></div>');var n=a.find(".vbs-section-btns");n.find(".vbs-controls-after-searchbar").remove(),n.addClass("vbs-controls-after-searchbar-wrapper").find("ul").append('<li class="vbs-controls-after-searchbar vbs-searchbar-inner"></li>'),n.find(".vbs-controls-after-searchbar").append(e.templates.get("controlsContainer")),s(".vbs-prev-btn,.vbs-next-action-btn").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-player-control"),s(".vbs-share-btn-wrapper").appendTo(".vbs-controls-after-searchbar-wrapper .vbs-share-control"),r.removeClass("vbs-one-btn vbs-no-btns"),e.settings.vbsButtons.evernote&&"undefined"!=typeof filepicker?r.addClass("vbs-four-btns"):r.addClass("vbs-three-btns")}},resetControlsPlace:function(){s(".vbs-controls-after-searchbar").find(".vbs-prev-btn").appendTo(".vbs-record-player .vbs-player-control"),s(".vbs-controls-after-searchbar").find(".vbs-next-action-btn").appendTo(".vbs-record-player .vbs-player-control"),s(".vbs-search-form").removeClass("vbs-four-btns vbs-three-btns"),s(".vbs-volume-toolbar").after(s(".vbs-controls-after-searchbar").find(".vbs-share-btn-wrapper")),e.settings.searchBarOuter&&s(".vbs-search-form").width(295)},renderTabs:function(){var t=s("#"+e.settings.keywordsBlock),a=s(".vbs-tabs-view");e.view.setResponsiveClass(a),a.hasClass("less-600px")||a.hasClass("less-480px")||a.addClass("vbs-normal-width");var r=s(".vbs-tabs-links");r.find("a").removeClass("vbs-active"),r.find('[data-href=".vbs-keywords-block"]').addClass("vbs-active"),t.find(".vbs-keywords-block").addClass("vbs-tab-visible")},checkEmptyHeadersForTabs:function(){var e=s(".vbs-tabs-view");e.hasClass("vbs-normal-width")||s(".vbs-tab").each(function(){var e=s(this).find(".vbs-section-header"),t=s(this).hasClass("vbs-keywords-block")&&0===e.find(".vbs-no-speaker").length?!0:!1;t||0!==e.find(".vbs-section-btns").length||s(this).addClass("vbs-tab-empty-header")})},renderTranscriptBlock:function(){var t=s("#"+e.settings.transcriptBlock);t.addClass(e.data.vclass).empty().html(e.templates.get("vbs-transcript")).css({width:e.settings.transcriptWidth}),e.view.setResponsiveClass(t),e.settings.localApp&&(t.addClass("vbs-local-app vbs-loading"),t.find(".vbs-section-title").attr("data-title","Loading transcript"))},renderCommentsBlock:function(){var t=s("#"+e.settings.commentsBlock);t.addClass(e.data.vclass).empty().html(e.templates.get("vbs-comments")).css({width:e.settings.commentsWidth}),e.view.setResponsiveClass(t)},renderNewsBlock:function(){var t=s("#"+e.settings.newsBlock);t.addClass(e.data.vclass).empty().html(e.templates.get("vbs-news")).css({width:e.settings.newsWidth}),e.view.setResponsiveClass(t),e.settings.expandNewsBlock?e.helper.expandNewsBlock():e.helper.collapseNewsBlock()},renderPredictionsBlock:function(){var t=s("#"+e.settings.predictionsBlock);t.addClass(e.data.vclass).empty().html(e.templates.get("vbs-predictions")).css({width:e.settings.predictionsWidth}),e.view.setResponsiveClass(t)},renderLanguageBlock:function(){if(e.data.localData.languages&&e.data.localData.languages.length>0){var t=s("#"+e.settings.mediaBlock),a=t.find(".vbs-section-header .vbs-section-btns");a.after(e.templates.get("languageSelect"));for(var r=t.find(".vbs-select-language-wrapper"),n=[],i="",o=0;o<e.data.localData.languages.length;o++){var l=e.data.localData.languages[o],d=Object.keys(l)[0],p=l[d],c={lang_code:d,lang_name:p};i+=e.templates.parse("languageItem",c),0===d.indexOf("en")&&n.push(c)}r.find(".vbs-select-dropdown").html(i),n.length>0?e.view.selectLanguage(n[0]):e.view.selectLanguage(e.data.localData.languages[0])}},selectLanguage:function(t){var a=s(".vbs-select-language-wrapper").find(".vbs-select-language"),r=t.lang_code;a.removeClass("vbs-s-show").html(t.lang_name).attr(r),e.data.localData.selected_language=r,e.view.initLocalData()},checkResponsive:function(){var t=[s("#"+e.settings.controlsBlock),s("#"+e.settings.mediaBlock),s("#"+e.settings.keywordsBlock),s("#"+e.settings.transcriptBlock),s("#"+e.settings.commentsBlock),s("#"+e.settings.newsBlock),s("#"+e.settings.predictionsBlock)];t.forEach(function(s){e.view.setResponsiveClass(s)})},setResponsiveClass:function(s){s.width()<e.settings.mediumResponsive&&s.width()>=e.settings.minResponsive?s.addClass("less-600px"):s.width()<e.settings.minResponsive&&s.addClass("less-600px").addClass("less-460px")},initAfterSaveTranscript:function(){e.api.ready.keywords=!1,e.helper.find(".vbs-keywords-block .vbs-topics").html(""),e.helper.find(".vbs-keywords-block .vbs-keywords-list-tab").html(""),e.helper.find(".vbs-select-speaker-wrapper .vbs-select-dropdown").html(""),e.helper.find(".vbs-search-form").addClass("vbs-no-speaker"),e.data.speakers={},e.api.ready.transcript=!1,e.helper.find(".vbs-transcript-block").removeClass("vbs-human").removeClass("vbs-with-order-btn"),e.helper.find(".vbs-transcript-block .vbs-transcript-wrapper").html("").removeClass("vbs-turntimes"),e.helper.find(".vbs-speakers").html("").removeClass("vbs-machine"),e.helper.find(".vbs-media-block .vbs-section-title, .vbs-time-name-wrapper-narrow").removeClass("vbs-machine"),e.api.getKeywords(),e.api.getTranscript()},searchWordWidget:function(s){if(s.length>0){var t=e.helper.find(".vbs-search-word-widget"),a=e.helper.find("#vbs-voice_search_txt");a.css("opacity","0"),e.helper.find("#vbs-search-string").show();var r="";for(var n in s){var i="";i=n>7?"#"+("000000"+(16777215*Math.random()<<0).toString(16)).slice(-6):e.settings.colors[n],r+=" "+e.templates.parse("searchWordTemplate",{word:s[n],clean_word:s[n].replace(/"/g,""),color:i},"span")}t.html(r),e.data.searcht&&e.settings.editKeywords&&a.data("data-val")==a.val()&&e.helper.checkKeyword(s,e.data.searcht,e.data.searchHits),a.data("data-val")!=a.val()&&(e.data.searcht=null,e.data.searchHits=null),e.helper.updateQuotesVisibility(),e.helper.startScroll()}},markerWidget:function(s,t,a){var r=(e.data.markersStyles.markersWrapper,e.data.markersStyles.markersContainer,e.data.markersStyles.markersWrapperWidth),n="";("undefined"==typeof a||null===a)&&(a=e.settings.colors[0]),("undefined"==typeof t||null===t)&&(t=null);for(var i in s){var o=s[i]*r/e.data.duration,l="undefined"==typeof t[i]?"":t[i];l=e.common.unEscapeHtml(t[i]),n+=" "+e.templates.parse("markerTemplate",{position:o,time:s[i],stcolor:a,phrase:l})}return n},showCustomMarkers:function(){var t=e.helper.find(".vbs-record-timeline-wrap"),a=s(".vbs-custom-markers");if(0===a.find(".vbs-custom-marker").length){var r=t.width(),n=e.data.customMarkers,i="";for(var o in n){var l=o*r/e.data.duration,d=n[o];d=e.common.unEscapeHtml(d),i+=" "+e.templates.parse("customMarkerTemplate",{position:l,time:o,stcolor:"#aaa",phrase:d})}a.append(i)}a.show()},hideCustomMarkers:function(){var e=s(".vbs-custom-markers");e.hide()},markerWidgetForNativeTimeline:function(){{var t=e.data.duration,a=s(".vbs-markers").find(".vbs-marker");e.PlayerApi.getPlayerIframe()}e.view.clearScrubberOfMarks(),s.each(a,function(a,r){var n=s(r).attr("stime"),i=s(r).css("border-bottom-color"),o=(s(r).css("left"),n/t*100);e.view.createScruberMark("vb_scrubber_mark"+a,i,o,10,"keyword-marks keyword-mark-"+a);var l=s('span[ctime="'+n+'"]');"undefined"!=typeof r?e.view.createPhraseBar("vb_scrubber_mark"+a,l.text()):console.log("Keyword phrase-bar not found for "+n)})},clearScrubberOfMarks:function(){var s=e.PlayerApi.getPlayerIframe();s.find(".keyword-marks").remove(),s.find(".vb-keyphrase").remove()},createScruberMark:function(s,t,a,r,n){var i=e.PlayerApi.getPlayerIframe(),o=i.find(".playHead"),l=i.find("#"+s);if(l.length>0)l.css("left",a+"%");else{r="undefined"!=typeof r?r:10,t="undefined"!=typeof t?t:"#dddddd";var d=i.find(".scrubber"),p=d.height();l=jQuery('<a class="scrubber-marker '+n+'"></a>'),e.view.setMarkerCss(l,p,a,t,s,r),o.after(l)}},createPhraseBar:function(t,a){var r=e.PlayerApi.getPlayerIframe(),n=s('<span class="vb-keyphrase" style="display: none;">'+a+"</span>");n.css({position:"absolute","text-align":"center",width:"100%",height:"17px","padding-top":"3px","margin-top":"-20px","background-color":"#EDF0F8","border-radius":"2px",color:"#333","font-family":"Helvetica, Arial, sans-serif","font-size":"13px","z-index":99}).attr("sourcemarker",t),r.find(".controlBarContainer").prepend(n),r.find("#"+t).mouseenter(function(){r.find("span[sourcemarker="+this.id+"]").show()}),r.find("#"+t).mouseleave(function(){r.find("span[sourcemarker="+this.id+"]").hide()})},setMarkerCss:function(e,s,t,a,r,n){e.css({"border-top-width":s,"border-top-style":"solid","border-top-color":a,left:t+"%",position:"absolute","border-left-width":n/2,"border-left-style":"solid","border-left-color":"transparent","border-right-width":n/2,"border-right-style":"solid","border-right-color":"transparent","z-index":99}).attr("id",r)},keywordHover:function(s){if(""===s)return!1;var t=e.helper.find(".vbs-record-timeline-wrap"),a="";s=s.split(",");for(var r in s){var n=parseFloat(s[r])*t.width()/e.data.duration;a+=" "+e.templates.parse("markerKeyTemplate",{position:n,time:parseFloat(s[r])})}e.helper.find(".vbs-markers-hovers").html(a)},removeKeywordHover:function(){e.helper.find(".vbs-markers-hovers").html("")},favorite:function(s){return s?e.helper.find(".vbs-star-btn").addClass("vbs-active").attr("data-tile","Remove from Favorites"):e.helper.find(".vbs-star-btn").removeClass("vbs-active").attr("data-tile","Add from Favorites"),s},favoriteToggle:function(){return e.helper.find(".vbs-star-btn").toggleClass("vbs-active"),!0},resizeTimelineElements:function(){var t=e.helper.find(".vbs-record-timeline-wrap").width(),a=e.data.duration;e.helper.find(".vbs-markers a").each(function(){var e=s(this),r=e.attr("stime"),n=r*t/a;e.css("left",n)}),e.speakers.resizeSpeakers(),e.comments.resizeCommentsTWidget(),e.helper.startScroll()},tooltips:function(){s(".vbs-tooltip").remove(),s("body").append('<span class="vbs-tooltip"></span>'),s("[data-title]").each(function(){var t=s(this),a=s(".vbs-tooltip");t.hover(function(){a.stop(!0,!0).hide();var s=t.attr("data-title");a.text(s);var r=e.view.getPositionElementForTooltip(t),n=parseInt(a.css("width"))+20,i=34,o={top:r.top>i?r.top-i:r.top+r.height+8,left:r.left+r.width/2-n/2};a.css({top:o.top+"px",left:o.left+"px"}),r.top>i?a.removeClass("vbs-arrow-on-top"):a.addClass("vbs-arrow-on-top"),a.stop(!0,!0).fadeIn(100)},function(){a.stop(!0,!0).fadeOut(100)})})},getPositionElementForTooltip:function(e){var t=e[0].getBoundingClientRect(),a=e.offset(),r={scroll:e.scrollTop()},n=s("body"),i={top:0,left:0};("absolute"===n.css("position")||"relative"===n.css("position")||"fixed"===n.css("position"))&&(i=n.offset());var o=s.extend({},t,r,a);return o.top-=i.top,o.left-=i.left,o},hideTooltips:function(){s(".vbs-tooltip").hide()}},e}(voiceBase,jQuery);